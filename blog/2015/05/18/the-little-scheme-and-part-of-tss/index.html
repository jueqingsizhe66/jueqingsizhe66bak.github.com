
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>The-Little-Scheme-And-Part-Of-TSS - 网络书屋(Web Reading Room)</title>
  <meta name="author" content="Ye Zhaoliang">

  
  <meta name="description" content="这部分内容是我练习TLS和TSS的全部学习资料，里面有详细的记录和一些心路历程，以后慢慢修改。
总行数5800左右。 1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://jueqingsizhe66.github.io/blog/2015/05/18/the-little-scheme-and-part-of-tss">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="网络书屋(Web Reading Room)" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">网络书屋(Web Reading Room)</a></h1>
  
    <h2>A blogging framework for hackers.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss email">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
    <li><a href="zhaoturkey@163.com" rel="subscribe-email" title="subscribe via email">Email</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:jueqingsizhe66.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">The-Little-Scheme-And-Part-Of-TSS</h1>
    
    
      <p class="meta">
        








  


<time datetime="2015-05-18T09:25:11+08:00" pubdate data-updated="true">May 18<span>th</span>, 2015</time>
        

         
          | <a href="#comments">Comments</a>
         
      </p>
    
  </header>


<div class="entry-content"><p>这部分内容是我练习TLS和TSS的全部学习资料，里面有详细的记录和一些心路历程，以后慢慢修改。
总行数5800左右。</p>

<!--more-->


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
<span class='line-number'>180</span>
<span class='line-number'>181</span>
<span class='line-number'>182</span>
<span class='line-number'>183</span>
<span class='line-number'>184</span>
<span class='line-number'>185</span>
<span class='line-number'>186</span>
<span class='line-number'>187</span>
<span class='line-number'>188</span>
<span class='line-number'>189</span>
<span class='line-number'>190</span>
<span class='line-number'>191</span>
<span class='line-number'>192</span>
<span class='line-number'>193</span>
<span class='line-number'>194</span>
<span class='line-number'>195</span>
<span class='line-number'>196</span>
<span class='line-number'>197</span>
<span class='line-number'>198</span>
<span class='line-number'>199</span>
<span class='line-number'>200</span>
<span class='line-number'>201</span>
<span class='line-number'>202</span>
<span class='line-number'>203</span>
<span class='line-number'>204</span>
<span class='line-number'>205</span>
<span class='line-number'>206</span>
<span class='line-number'>207</span>
<span class='line-number'>208</span>
<span class='line-number'>209</span>
<span class='line-number'>210</span>
<span class='line-number'>211</span>
<span class='line-number'>212</span>
<span class='line-number'>213</span>
<span class='line-number'>214</span>
<span class='line-number'>215</span>
<span class='line-number'>216</span>
<span class='line-number'>217</span>
<span class='line-number'>218</span>
<span class='line-number'>219</span>
<span class='line-number'>220</span>
<span class='line-number'>221</span>
<span class='line-number'>222</span>
<span class='line-number'>223</span>
<span class='line-number'>224</span>
<span class='line-number'>225</span>
<span class='line-number'>226</span>
<span class='line-number'>227</span>
<span class='line-number'>228</span>
<span class='line-number'>229</span>
<span class='line-number'>230</span>
<span class='line-number'>231</span>
<span class='line-number'>232</span>
<span class='line-number'>233</span>
<span class='line-number'>234</span>
<span class='line-number'>235</span>
<span class='line-number'>236</span>
<span class='line-number'>237</span>
<span class='line-number'>238</span>
<span class='line-number'>239</span>
<span class='line-number'>240</span>
<span class='line-number'>241</span>
<span class='line-number'>242</span>
<span class='line-number'>243</span>
<span class='line-number'>244</span>
<span class='line-number'>245</span>
<span class='line-number'>246</span>
<span class='line-number'>247</span>
<span class='line-number'>248</span>
<span class='line-number'>249</span>
<span class='line-number'>250</span>
<span class='line-number'>251</span>
<span class='line-number'>252</span>
<span class='line-number'>253</span>
<span class='line-number'>254</span>
<span class='line-number'>255</span>
<span class='line-number'>256</span>
<span class='line-number'>257</span>
<span class='line-number'>258</span>
<span class='line-number'>259</span>
<span class='line-number'>260</span>
<span class='line-number'>261</span>
<span class='line-number'>262</span>
<span class='line-number'>263</span>
<span class='line-number'>264</span>
<span class='line-number'>265</span>
<span class='line-number'>266</span>
<span class='line-number'>267</span>
<span class='line-number'>268</span>
<span class='line-number'>269</span>
<span class='line-number'>270</span>
<span class='line-number'>271</span>
<span class='line-number'>272</span>
<span class='line-number'>273</span>
<span class='line-number'>274</span>
<span class='line-number'>275</span>
<span class='line-number'>276</span>
<span class='line-number'>277</span>
<span class='line-number'>278</span>
<span class='line-number'>279</span>
<span class='line-number'>280</span>
<span class='line-number'>281</span>
<span class='line-number'>282</span>
<span class='line-number'>283</span>
<span class='line-number'>284</span>
<span class='line-number'>285</span>
<span class='line-number'>286</span>
<span class='line-number'>287</span>
<span class='line-number'>288</span>
<span class='line-number'>289</span>
<span class='line-number'>290</span>
<span class='line-number'>291</span>
<span class='line-number'>292</span>
<span class='line-number'>293</span>
<span class='line-number'>294</span>
<span class='line-number'>295</span>
<span class='line-number'>296</span>
<span class='line-number'>297</span>
<span class='line-number'>298</span>
<span class='line-number'>299</span>
<span class='line-number'>300</span>
<span class='line-number'>301</span>
<span class='line-number'>302</span>
<span class='line-number'>303</span>
<span class='line-number'>304</span>
<span class='line-number'>305</span>
<span class='line-number'>306</span>
<span class='line-number'>307</span>
<span class='line-number'>308</span>
<span class='line-number'>309</span>
<span class='line-number'>310</span>
<span class='line-number'>311</span>
<span class='line-number'>312</span>
<span class='line-number'>313</span>
<span class='line-number'>314</span>
<span class='line-number'>315</span>
<span class='line-number'>316</span>
<span class='line-number'>317</span>
<span class='line-number'>318</span>
<span class='line-number'>319</span>
<span class='line-number'>320</span>
<span class='line-number'>321</span>
<span class='line-number'>322</span>
<span class='line-number'>323</span>
<span class='line-number'>324</span>
<span class='line-number'>325</span>
<span class='line-number'>326</span>
<span class='line-number'>327</span>
<span class='line-number'>328</span>
<span class='line-number'>329</span>
<span class='line-number'>330</span>
<span class='line-number'>331</span>
<span class='line-number'>332</span>
<span class='line-number'>333</span>
<span class='line-number'>334</span>
<span class='line-number'>335</span>
<span class='line-number'>336</span>
<span class='line-number'>337</span>
<span class='line-number'>338</span>
<span class='line-number'>339</span>
<span class='line-number'>340</span>
<span class='line-number'>341</span>
<span class='line-number'>342</span>
<span class='line-number'>343</span>
<span class='line-number'>344</span>
<span class='line-number'>345</span>
<span class='line-number'>346</span>
<span class='line-number'>347</span>
<span class='line-number'>348</span>
<span class='line-number'>349</span>
<span class='line-number'>350</span>
<span class='line-number'>351</span>
<span class='line-number'>352</span>
<span class='line-number'>353</span>
<span class='line-number'>354</span>
<span class='line-number'>355</span>
<span class='line-number'>356</span>
<span class='line-number'>357</span>
<span class='line-number'>358</span>
<span class='line-number'>359</span>
<span class='line-number'>360</span>
<span class='line-number'>361</span>
<span class='line-number'>362</span>
<span class='line-number'>363</span>
<span class='line-number'>364</span>
<span class='line-number'>365</span>
<span class='line-number'>366</span>
<span class='line-number'>367</span>
<span class='line-number'>368</span>
<span class='line-number'>369</span>
<span class='line-number'>370</span>
<span class='line-number'>371</span>
<span class='line-number'>372</span>
<span class='line-number'>373</span>
<span class='line-number'>374</span>
<span class='line-number'>375</span>
<span class='line-number'>376</span>
<span class='line-number'>377</span>
<span class='line-number'>378</span>
<span class='line-number'>379</span>
<span class='line-number'>380</span>
<span class='line-number'>381</span>
<span class='line-number'>382</span>
<span class='line-number'>383</span>
<span class='line-number'>384</span>
<span class='line-number'>385</span>
<span class='line-number'>386</span>
<span class='line-number'>387</span>
<span class='line-number'>388</span>
<span class='line-number'>389</span>
<span class='line-number'>390</span>
<span class='line-number'>391</span>
<span class='line-number'>392</span>
<span class='line-number'>393</span>
<span class='line-number'>394</span>
<span class='line-number'>395</span>
<span class='line-number'>396</span>
<span class='line-number'>397</span>
<span class='line-number'>398</span>
<span class='line-number'>399</span>
<span class='line-number'>400</span>
<span class='line-number'>401</span>
<span class='line-number'>402</span>
<span class='line-number'>403</span>
<span class='line-number'>404</span>
<span class='line-number'>405</span>
<span class='line-number'>406</span>
<span class='line-number'>407</span>
<span class='line-number'>408</span>
<span class='line-number'>409</span>
<span class='line-number'>410</span>
<span class='line-number'>411</span>
<span class='line-number'>412</span>
<span class='line-number'>413</span>
<span class='line-number'>414</span>
<span class='line-number'>415</span>
<span class='line-number'>416</span>
<span class='line-number'>417</span>
<span class='line-number'>418</span>
<span class='line-number'>419</span>
<span class='line-number'>420</span>
<span class='line-number'>421</span>
<span class='line-number'>422</span>
<span class='line-number'>423</span>
<span class='line-number'>424</span>
<span class='line-number'>425</span>
<span class='line-number'>426</span>
<span class='line-number'>427</span>
<span class='line-number'>428</span>
<span class='line-number'>429</span>
<span class='line-number'>430</span>
<span class='line-number'>431</span>
<span class='line-number'>432</span>
<span class='line-number'>433</span>
<span class='line-number'>434</span>
<span class='line-number'>435</span>
<span class='line-number'>436</span>
<span class='line-number'>437</span>
<span class='line-number'>438</span>
<span class='line-number'>439</span>
<span class='line-number'>440</span>
<span class='line-number'>441</span>
<span class='line-number'>442</span>
<span class='line-number'>443</span>
<span class='line-number'>444</span>
<span class='line-number'>445</span>
<span class='line-number'>446</span>
<span class='line-number'>447</span>
<span class='line-number'>448</span>
<span class='line-number'>449</span>
<span class='line-number'>450</span>
<span class='line-number'>451</span>
<span class='line-number'>452</span>
<span class='line-number'>453</span>
<span class='line-number'>454</span>
<span class='line-number'>455</span>
<span class='line-number'>456</span>
<span class='line-number'>457</span>
<span class='line-number'>458</span>
<span class='line-number'>459</span>
<span class='line-number'>460</span>
<span class='line-number'>461</span>
<span class='line-number'>462</span>
<span class='line-number'>463</span>
<span class='line-number'>464</span>
<span class='line-number'>465</span>
<span class='line-number'>466</span>
<span class='line-number'>467</span>
<span class='line-number'>468</span>
<span class='line-number'>469</span>
<span class='line-number'>470</span>
<span class='line-number'>471</span>
<span class='line-number'>472</span>
<span class='line-number'>473</span>
<span class='line-number'>474</span>
<span class='line-number'>475</span>
<span class='line-number'>476</span>
<span class='line-number'>477</span>
<span class='line-number'>478</span>
<span class='line-number'>479</span>
<span class='line-number'>480</span>
<span class='line-number'>481</span>
<span class='line-number'>482</span>
<span class='line-number'>483</span>
<span class='line-number'>484</span>
<span class='line-number'>485</span>
<span class='line-number'>486</span>
<span class='line-number'>487</span>
<span class='line-number'>488</span>
<span class='line-number'>489</span>
<span class='line-number'>490</span>
<span class='line-number'>491</span>
<span class='line-number'>492</span>
<span class='line-number'>493</span>
<span class='line-number'>494</span>
<span class='line-number'>495</span>
<span class='line-number'>496</span>
<span class='line-number'>497</span>
<span class='line-number'>498</span>
<span class='line-number'>499</span>
<span class='line-number'>500</span>
<span class='line-number'>501</span>
<span class='line-number'>502</span>
<span class='line-number'>503</span>
<span class='line-number'>504</span>
<span class='line-number'>505</span>
<span class='line-number'>506</span>
<span class='line-number'>507</span>
<span class='line-number'>508</span>
<span class='line-number'>509</span>
<span class='line-number'>510</span>
<span class='line-number'>511</span>
<span class='line-number'>512</span>
<span class='line-number'>513</span>
<span class='line-number'>514</span>
<span class='line-number'>515</span>
<span class='line-number'>516</span>
<span class='line-number'>517</span>
<span class='line-number'>518</span>
<span class='line-number'>519</span>
<span class='line-number'>520</span>
<span class='line-number'>521</span>
<span class='line-number'>522</span>
<span class='line-number'>523</span>
<span class='line-number'>524</span>
<span class='line-number'>525</span>
<span class='line-number'>526</span>
<span class='line-number'>527</span>
<span class='line-number'>528</span>
<span class='line-number'>529</span>
<span class='line-number'>530</span>
<span class='line-number'>531</span>
<span class='line-number'>532</span>
<span class='line-number'>533</span>
<span class='line-number'>534</span>
<span class='line-number'>535</span>
<span class='line-number'>536</span>
<span class='line-number'>537</span>
<span class='line-number'>538</span>
<span class='line-number'>539</span>
<span class='line-number'>540</span>
<span class='line-number'>541</span>
<span class='line-number'>542</span>
<span class='line-number'>543</span>
<span class='line-number'>544</span>
<span class='line-number'>545</span>
<span class='line-number'>546</span>
<span class='line-number'>547</span>
<span class='line-number'>548</span>
<span class='line-number'>549</span>
<span class='line-number'>550</span>
<span class='line-number'>551</span>
<span class='line-number'>552</span>
<span class='line-number'>553</span>
<span class='line-number'>554</span>
<span class='line-number'>555</span>
<span class='line-number'>556</span>
<span class='line-number'>557</span>
<span class='line-number'>558</span>
<span class='line-number'>559</span>
<span class='line-number'>560</span>
<span class='line-number'>561</span>
<span class='line-number'>562</span>
<span class='line-number'>563</span>
<span class='line-number'>564</span>
<span class='line-number'>565</span>
<span class='line-number'>566</span>
<span class='line-number'>567</span>
<span class='line-number'>568</span>
<span class='line-number'>569</span>
<span class='line-number'>570</span>
<span class='line-number'>571</span>
<span class='line-number'>572</span>
<span class='line-number'>573</span>
<span class='line-number'>574</span>
<span class='line-number'>575</span>
<span class='line-number'>576</span>
<span class='line-number'>577</span>
<span class='line-number'>578</span>
<span class='line-number'>579</span>
<span class='line-number'>580</span>
<span class='line-number'>581</span>
<span class='line-number'>582</span>
<span class='line-number'>583</span>
<span class='line-number'>584</span>
<span class='line-number'>585</span>
<span class='line-number'>586</span>
<span class='line-number'>587</span>
<span class='line-number'>588</span>
<span class='line-number'>589</span>
<span class='line-number'>590</span>
<span class='line-number'>591</span>
<span class='line-number'>592</span>
<span class='line-number'>593</span>
<span class='line-number'>594</span>
<span class='line-number'>595</span>
<span class='line-number'>596</span>
<span class='line-number'>597</span>
<span class='line-number'>598</span>
<span class='line-number'>599</span>
<span class='line-number'>600</span>
<span class='line-number'>601</span>
<span class='line-number'>602</span>
<span class='line-number'>603</span>
<span class='line-number'>604</span>
<span class='line-number'>605</span>
<span class='line-number'>606</span>
<span class='line-number'>607</span>
<span class='line-number'>608</span>
<span class='line-number'>609</span>
<span class='line-number'>610</span>
<span class='line-number'>611</span>
<span class='line-number'>612</span>
<span class='line-number'>613</span>
<span class='line-number'>614</span>
<span class='line-number'>615</span>
<span class='line-number'>616</span>
<span class='line-number'>617</span>
<span class='line-number'>618</span>
<span class='line-number'>619</span>
<span class='line-number'>620</span>
<span class='line-number'>621</span>
<span class='line-number'>622</span>
<span class='line-number'>623</span>
<span class='line-number'>624</span>
<span class='line-number'>625</span>
<span class='line-number'>626</span>
<span class='line-number'>627</span>
<span class='line-number'>628</span>
<span class='line-number'>629</span>
<span class='line-number'>630</span>
<span class='line-number'>631</span>
<span class='line-number'>632</span>
<span class='line-number'>633</span>
<span class='line-number'>634</span>
<span class='line-number'>635</span>
<span class='line-number'>636</span>
<span class='line-number'>637</span>
<span class='line-number'>638</span>
<span class='line-number'>639</span>
<span class='line-number'>640</span>
<span class='line-number'>641</span>
<span class='line-number'>642</span>
<span class='line-number'>643</span>
<span class='line-number'>644</span>
<span class='line-number'>645</span>
<span class='line-number'>646</span>
<span class='line-number'>647</span>
<span class='line-number'>648</span>
<span class='line-number'>649</span>
<span class='line-number'>650</span>
<span class='line-number'>651</span>
<span class='line-number'>652</span>
<span class='line-number'>653</span>
<span class='line-number'>654</span>
<span class='line-number'>655</span>
<span class='line-number'>656</span>
<span class='line-number'>657</span>
<span class='line-number'>658</span>
<span class='line-number'>659</span>
<span class='line-number'>660</span>
<span class='line-number'>661</span>
<span class='line-number'>662</span>
<span class='line-number'>663</span>
<span class='line-number'>664</span>
<span class='line-number'>665</span>
<span class='line-number'>666</span>
<span class='line-number'>667</span>
<span class='line-number'>668</span>
<span class='line-number'>669</span>
<span class='line-number'>670</span>
<span class='line-number'>671</span>
<span class='line-number'>672</span>
<span class='line-number'>673</span>
<span class='line-number'>674</span>
<span class='line-number'>675</span>
<span class='line-number'>676</span>
<span class='line-number'>677</span>
<span class='line-number'>678</span>
<span class='line-number'>679</span>
<span class='line-number'>680</span>
<span class='line-number'>681</span>
<span class='line-number'>682</span>
<span class='line-number'>683</span>
<span class='line-number'>684</span>
<span class='line-number'>685</span>
<span class='line-number'>686</span>
<span class='line-number'>687</span>
<span class='line-number'>688</span>
<span class='line-number'>689</span>
<span class='line-number'>690</span>
<span class='line-number'>691</span>
<span class='line-number'>692</span>
<span class='line-number'>693</span>
<span class='line-number'>694</span>
<span class='line-number'>695</span>
<span class='line-number'>696</span>
<span class='line-number'>697</span>
<span class='line-number'>698</span>
<span class='line-number'>699</span>
<span class='line-number'>700</span>
<span class='line-number'>701</span>
<span class='line-number'>702</span>
<span class='line-number'>703</span>
<span class='line-number'>704</span>
<span class='line-number'>705</span>
<span class='line-number'>706</span>
<span class='line-number'>707</span>
<span class='line-number'>708</span>
<span class='line-number'>709</span>
<span class='line-number'>710</span>
<span class='line-number'>711</span>
<span class='line-number'>712</span>
<span class='line-number'>713</span>
<span class='line-number'>714</span>
<span class='line-number'>715</span>
<span class='line-number'>716</span>
<span class='line-number'>717</span>
<span class='line-number'>718</span>
<span class='line-number'>719</span>
<span class='line-number'>720</span>
<span class='line-number'>721</span>
<span class='line-number'>722</span>
<span class='line-number'>723</span>
<span class='line-number'>724</span>
<span class='line-number'>725</span>
<span class='line-number'>726</span>
<span class='line-number'>727</span>
<span class='line-number'>728</span>
<span class='line-number'>729</span>
<span class='line-number'>730</span>
<span class='line-number'>731</span>
<span class='line-number'>732</span>
<span class='line-number'>733</span>
<span class='line-number'>734</span>
<span class='line-number'>735</span>
<span class='line-number'>736</span>
<span class='line-number'>737</span>
<span class='line-number'>738</span>
<span class='line-number'>739</span>
<span class='line-number'>740</span>
<span class='line-number'>741</span>
<span class='line-number'>742</span>
<span class='line-number'>743</span>
<span class='line-number'>744</span>
<span class='line-number'>745</span>
<span class='line-number'>746</span>
<span class='line-number'>747</span>
<span class='line-number'>748</span>
<span class='line-number'>749</span>
<span class='line-number'>750</span>
<span class='line-number'>751</span>
<span class='line-number'>752</span>
<span class='line-number'>753</span>
<span class='line-number'>754</span>
<span class='line-number'>755</span>
<span class='line-number'>756</span>
<span class='line-number'>757</span>
<span class='line-number'>758</span>
<span class='line-number'>759</span>
<span class='line-number'>760</span>
<span class='line-number'>761</span>
<span class='line-number'>762</span>
<span class='line-number'>763</span>
<span class='line-number'>764</span>
<span class='line-number'>765</span>
<span class='line-number'>766</span>
<span class='line-number'>767</span>
<span class='line-number'>768</span>
<span class='line-number'>769</span>
<span class='line-number'>770</span>
<span class='line-number'>771</span>
<span class='line-number'>772</span>
<span class='line-number'>773</span>
<span class='line-number'>774</span>
<span class='line-number'>775</span>
<span class='line-number'>776</span>
<span class='line-number'>777</span>
<span class='line-number'>778</span>
<span class='line-number'>779</span>
<span class='line-number'>780</span>
<span class='line-number'>781</span>
<span class='line-number'>782</span>
<span class='line-number'>783</span>
<span class='line-number'>784</span>
<span class='line-number'>785</span>
<span class='line-number'>786</span>
<span class='line-number'>787</span>
<span class='line-number'>788</span>
<span class='line-number'>789</span>
<span class='line-number'>790</span>
<span class='line-number'>791</span>
<span class='line-number'>792</span>
<span class='line-number'>793</span>
<span class='line-number'>794</span>
<span class='line-number'>795</span>
<span class='line-number'>796</span>
<span class='line-number'>797</span>
<span class='line-number'>798</span>
<span class='line-number'>799</span>
<span class='line-number'>800</span>
<span class='line-number'>801</span>
<span class='line-number'>802</span>
<span class='line-number'>803</span>
<span class='line-number'>804</span>
<span class='line-number'>805</span>
<span class='line-number'>806</span>
<span class='line-number'>807</span>
<span class='line-number'>808</span>
<span class='line-number'>809</span>
<span class='line-number'>810</span>
<span class='line-number'>811</span>
<span class='line-number'>812</span>
<span class='line-number'>813</span>
<span class='line-number'>814</span>
<span class='line-number'>815</span>
<span class='line-number'>816</span>
<span class='line-number'>817</span>
<span class='line-number'>818</span>
<span class='line-number'>819</span>
<span class='line-number'>820</span>
<span class='line-number'>821</span>
<span class='line-number'>822</span>
<span class='line-number'>823</span>
<span class='line-number'>824</span>
<span class='line-number'>825</span>
<span class='line-number'>826</span>
<span class='line-number'>827</span>
<span class='line-number'>828</span>
<span class='line-number'>829</span>
<span class='line-number'>830</span>
<span class='line-number'>831</span>
<span class='line-number'>832</span>
<span class='line-number'>833</span>
<span class='line-number'>834</span>
<span class='line-number'>835</span>
<span class='line-number'>836</span>
<span class='line-number'>837</span>
<span class='line-number'>838</span>
<span class='line-number'>839</span>
<span class='line-number'>840</span>
<span class='line-number'>841</span>
<span class='line-number'>842</span>
<span class='line-number'>843</span>
<span class='line-number'>844</span>
<span class='line-number'>845</span>
<span class='line-number'>846</span>
<span class='line-number'>847</span>
<span class='line-number'>848</span>
<span class='line-number'>849</span>
<span class='line-number'>850</span>
<span class='line-number'>851</span>
<span class='line-number'>852</span>
<span class='line-number'>853</span>
<span class='line-number'>854</span>
<span class='line-number'>855</span>
<span class='line-number'>856</span>
<span class='line-number'>857</span>
<span class='line-number'>858</span>
<span class='line-number'>859</span>
<span class='line-number'>860</span>
<span class='line-number'>861</span>
<span class='line-number'>862</span>
<span class='line-number'>863</span>
<span class='line-number'>864</span>
<span class='line-number'>865</span>
<span class='line-number'>866</span>
<span class='line-number'>867</span>
<span class='line-number'>868</span>
<span class='line-number'>869</span>
<span class='line-number'>870</span>
<span class='line-number'>871</span>
<span class='line-number'>872</span>
<span class='line-number'>873</span>
<span class='line-number'>874</span>
<span class='line-number'>875</span>
<span class='line-number'>876</span>
<span class='line-number'>877</span>
<span class='line-number'>878</span>
<span class='line-number'>879</span>
<span class='line-number'>880</span>
<span class='line-number'>881</span>
<span class='line-number'>882</span>
<span class='line-number'>883</span>
<span class='line-number'>884</span>
<span class='line-number'>885</span>
<span class='line-number'>886</span>
<span class='line-number'>887</span>
<span class='line-number'>888</span>
<span class='line-number'>889</span>
<span class='line-number'>890</span>
<span class='line-number'>891</span>
<span class='line-number'>892</span>
<span class='line-number'>893</span>
<span class='line-number'>894</span>
<span class='line-number'>895</span>
<span class='line-number'>896</span>
<span class='line-number'>897</span>
<span class='line-number'>898</span>
<span class='line-number'>899</span>
<span class='line-number'>900</span>
<span class='line-number'>901</span>
<span class='line-number'>902</span>
<span class='line-number'>903</span>
<span class='line-number'>904</span>
<span class='line-number'>905</span>
<span class='line-number'>906</span>
<span class='line-number'>907</span>
<span class='line-number'>908</span>
<span class='line-number'>909</span>
<span class='line-number'>910</span>
<span class='line-number'>911</span>
<span class='line-number'>912</span>
<span class='line-number'>913</span>
<span class='line-number'>914</span>
<span class='line-number'>915</span>
<span class='line-number'>916</span>
<span class='line-number'>917</span>
<span class='line-number'>918</span>
<span class='line-number'>919</span>
<span class='line-number'>920</span>
<span class='line-number'>921</span>
<span class='line-number'>922</span>
<span class='line-number'>923</span>
<span class='line-number'>924</span>
<span class='line-number'>925</span>
<span class='line-number'>926</span>
<span class='line-number'>927</span>
<span class='line-number'>928</span>
<span class='line-number'>929</span>
<span class='line-number'>930</span>
<span class='line-number'>931</span>
<span class='line-number'>932</span>
<span class='line-number'>933</span>
<span class='line-number'>934</span>
<span class='line-number'>935</span>
<span class='line-number'>936</span>
<span class='line-number'>937</span>
<span class='line-number'>938</span>
<span class='line-number'>939</span>
<span class='line-number'>940</span>
<span class='line-number'>941</span>
<span class='line-number'>942</span>
<span class='line-number'>943</span>
<span class='line-number'>944</span>
<span class='line-number'>945</span>
<span class='line-number'>946</span>
<span class='line-number'>947</span>
<span class='line-number'>948</span>
<span class='line-number'>949</span>
<span class='line-number'>950</span>
<span class='line-number'>951</span>
<span class='line-number'>952</span>
<span class='line-number'>953</span>
<span class='line-number'>954</span>
<span class='line-number'>955</span>
<span class='line-number'>956</span>
<span class='line-number'>957</span>
<span class='line-number'>958</span>
<span class='line-number'>959</span>
<span class='line-number'>960</span>
<span class='line-number'>961</span>
<span class='line-number'>962</span>
<span class='line-number'>963</span>
<span class='line-number'>964</span>
<span class='line-number'>965</span>
<span class='line-number'>966</span>
<span class='line-number'>967</span>
<span class='line-number'>968</span>
<span class='line-number'>969</span>
<span class='line-number'>970</span>
<span class='line-number'>971</span>
<span class='line-number'>972</span>
<span class='line-number'>973</span>
<span class='line-number'>974</span>
<span class='line-number'>975</span>
<span class='line-number'>976</span>
<span class='line-number'>977</span>
<span class='line-number'>978</span>
<span class='line-number'>979</span>
<span class='line-number'>980</span>
<span class='line-number'>981</span>
<span class='line-number'>982</span>
<span class='line-number'>983</span>
<span class='line-number'>984</span>
<span class='line-number'>985</span>
<span class='line-number'>986</span>
<span class='line-number'>987</span>
<span class='line-number'>988</span>
<span class='line-number'>989</span>
<span class='line-number'>990</span>
<span class='line-number'>991</span>
<span class='line-number'>992</span>
<span class='line-number'>993</span>
<span class='line-number'>994</span>
<span class='line-number'>995</span>
<span class='line-number'>996</span>
<span class='line-number'>997</span>
<span class='line-number'>998</span>
<span class='line-number'>999</span>
<span class='line-number'>1000</span>
<span class='line-number'>1001</span>
<span class='line-number'>1002</span>
<span class='line-number'>1003</span>
<span class='line-number'>1004</span>
<span class='line-number'>1005</span>
<span class='line-number'>1006</span>
<span class='line-number'>1007</span>
<span class='line-number'>1008</span>
<span class='line-number'>1009</span>
<span class='line-number'>1010</span>
<span class='line-number'>1011</span>
<span class='line-number'>1012</span>
<span class='line-number'>1013</span>
<span class='line-number'>1014</span>
<span class='line-number'>1015</span>
<span class='line-number'>1016</span>
<span class='line-number'>1017</span>
<span class='line-number'>1018</span>
<span class='line-number'>1019</span>
<span class='line-number'>1020</span>
<span class='line-number'>1021</span>
<span class='line-number'>1022</span>
<span class='line-number'>1023</span>
<span class='line-number'>1024</span>
<span class='line-number'>1025</span>
<span class='line-number'>1026</span>
<span class='line-number'>1027</span>
<span class='line-number'>1028</span>
<span class='line-number'>1029</span>
<span class='line-number'>1030</span>
<span class='line-number'>1031</span>
<span class='line-number'>1032</span>
<span class='line-number'>1033</span>
<span class='line-number'>1034</span>
<span class='line-number'>1035</span>
<span class='line-number'>1036</span>
<span class='line-number'>1037</span>
<span class='line-number'>1038</span>
<span class='line-number'>1039</span>
<span class='line-number'>1040</span>
<span class='line-number'>1041</span>
<span class='line-number'>1042</span>
<span class='line-number'>1043</span>
<span class='line-number'>1044</span>
<span class='line-number'>1045</span>
<span class='line-number'>1046</span>
<span class='line-number'>1047</span>
<span class='line-number'>1048</span>
<span class='line-number'>1049</span>
<span class='line-number'>1050</span>
<span class='line-number'>1051</span>
<span class='line-number'>1052</span>
<span class='line-number'>1053</span>
<span class='line-number'>1054</span>
<span class='line-number'>1055</span>
<span class='line-number'>1056</span>
<span class='line-number'>1057</span>
<span class='line-number'>1058</span>
<span class='line-number'>1059</span>
<span class='line-number'>1060</span>
<span class='line-number'>1061</span>
<span class='line-number'>1062</span>
<span class='line-number'>1063</span>
<span class='line-number'>1064</span>
<span class='line-number'>1065</span>
<span class='line-number'>1066</span>
<span class='line-number'>1067</span>
<span class='line-number'>1068</span>
<span class='line-number'>1069</span>
<span class='line-number'>1070</span>
<span class='line-number'>1071</span>
<span class='line-number'>1072</span>
<span class='line-number'>1073</span>
<span class='line-number'>1074</span>
<span class='line-number'>1075</span>
<span class='line-number'>1076</span>
<span class='line-number'>1077</span>
<span class='line-number'>1078</span>
<span class='line-number'>1079</span>
<span class='line-number'>1080</span>
<span class='line-number'>1081</span>
<span class='line-number'>1082</span>
<span class='line-number'>1083</span>
<span class='line-number'>1084</span>
<span class='line-number'>1085</span>
<span class='line-number'>1086</span>
<span class='line-number'>1087</span>
<span class='line-number'>1088</span>
<span class='line-number'>1089</span>
<span class='line-number'>1090</span>
<span class='line-number'>1091</span>
<span class='line-number'>1092</span>
<span class='line-number'>1093</span>
<span class='line-number'>1094</span>
<span class='line-number'>1095</span>
<span class='line-number'>1096</span>
<span class='line-number'>1097</span>
<span class='line-number'>1098</span>
<span class='line-number'>1099</span>
<span class='line-number'>1100</span>
<span class='line-number'>1101</span>
<span class='line-number'>1102</span>
<span class='line-number'>1103</span>
<span class='line-number'>1104</span>
<span class='line-number'>1105</span>
<span class='line-number'>1106</span>
<span class='line-number'>1107</span>
<span class='line-number'>1108</span>
<span class='line-number'>1109</span>
<span class='line-number'>1110</span>
<span class='line-number'>1111</span>
<span class='line-number'>1112</span>
<span class='line-number'>1113</span>
<span class='line-number'>1114</span>
<span class='line-number'>1115</span>
<span class='line-number'>1116</span>
<span class='line-number'>1117</span>
<span class='line-number'>1118</span>
<span class='line-number'>1119</span>
<span class='line-number'>1120</span>
<span class='line-number'>1121</span>
<span class='line-number'>1122</span>
<span class='line-number'>1123</span>
<span class='line-number'>1124</span>
<span class='line-number'>1125</span>
<span class='line-number'>1126</span>
<span class='line-number'>1127</span>
<span class='line-number'>1128</span>
<span class='line-number'>1129</span>
<span class='line-number'>1130</span>
<span class='line-number'>1131</span>
<span class='line-number'>1132</span>
<span class='line-number'>1133</span>
<span class='line-number'>1134</span>
<span class='line-number'>1135</span>
<span class='line-number'>1136</span>
<span class='line-number'>1137</span>
<span class='line-number'>1138</span>
<span class='line-number'>1139</span>
<span class='line-number'>1140</span>
<span class='line-number'>1141</span>
<span class='line-number'>1142</span>
<span class='line-number'>1143</span>
<span class='line-number'>1144</span>
<span class='line-number'>1145</span>
<span class='line-number'>1146</span>
<span class='line-number'>1147</span>
<span class='line-number'>1148</span>
<span class='line-number'>1149</span>
<span class='line-number'>1150</span>
<span class='line-number'>1151</span>
<span class='line-number'>1152</span>
<span class='line-number'>1153</span>
<span class='line-number'>1154</span>
<span class='line-number'>1155</span>
<span class='line-number'>1156</span>
<span class='line-number'>1157</span>
<span class='line-number'>1158</span>
<span class='line-number'>1159</span>
<span class='line-number'>1160</span>
<span class='line-number'>1161</span>
<span class='line-number'>1162</span>
<span class='line-number'>1163</span>
<span class='line-number'>1164</span>
<span class='line-number'>1165</span>
<span class='line-number'>1166</span>
<span class='line-number'>1167</span>
<span class='line-number'>1168</span>
<span class='line-number'>1169</span>
<span class='line-number'>1170</span>
<span class='line-number'>1171</span>
<span class='line-number'>1172</span>
<span class='line-number'>1173</span>
<span class='line-number'>1174</span>
<span class='line-number'>1175</span>
<span class='line-number'>1176</span>
<span class='line-number'>1177</span>
<span class='line-number'>1178</span>
<span class='line-number'>1179</span>
<span class='line-number'>1180</span>
<span class='line-number'>1181</span>
<span class='line-number'>1182</span>
<span class='line-number'>1183</span>
<span class='line-number'>1184</span>
<span class='line-number'>1185</span>
<span class='line-number'>1186</span>
<span class='line-number'>1187</span>
<span class='line-number'>1188</span>
<span class='line-number'>1189</span>
<span class='line-number'>1190</span>
<span class='line-number'>1191</span>
<span class='line-number'>1192</span>
<span class='line-number'>1193</span>
<span class='line-number'>1194</span>
<span class='line-number'>1195</span>
<span class='line-number'>1196</span>
<span class='line-number'>1197</span>
<span class='line-number'>1198</span>
<span class='line-number'>1199</span>
<span class='line-number'>1200</span>
<span class='line-number'>1201</span>
<span class='line-number'>1202</span>
<span class='line-number'>1203</span>
<span class='line-number'>1204</span>
<span class='line-number'>1205</span>
<span class='line-number'>1206</span>
<span class='line-number'>1207</span>
<span class='line-number'>1208</span>
<span class='line-number'>1209</span>
<span class='line-number'>1210</span>
<span class='line-number'>1211</span>
<span class='line-number'>1212</span>
<span class='line-number'>1213</span>
<span class='line-number'>1214</span>
<span class='line-number'>1215</span>
<span class='line-number'>1216</span>
<span class='line-number'>1217</span>
<span class='line-number'>1218</span>
<span class='line-number'>1219</span>
<span class='line-number'>1220</span>
<span class='line-number'>1221</span>
<span class='line-number'>1222</span>
<span class='line-number'>1223</span>
<span class='line-number'>1224</span>
<span class='line-number'>1225</span>
<span class='line-number'>1226</span>
<span class='line-number'>1227</span>
<span class='line-number'>1228</span>
<span class='line-number'>1229</span>
<span class='line-number'>1230</span>
<span class='line-number'>1231</span>
<span class='line-number'>1232</span>
<span class='line-number'>1233</span>
<span class='line-number'>1234</span>
<span class='line-number'>1235</span>
<span class='line-number'>1236</span>
<span class='line-number'>1237</span>
<span class='line-number'>1238</span>
<span class='line-number'>1239</span>
<span class='line-number'>1240</span>
<span class='line-number'>1241</span>
<span class='line-number'>1242</span>
<span class='line-number'>1243</span>
<span class='line-number'>1244</span>
<span class='line-number'>1245</span>
<span class='line-number'>1246</span>
<span class='line-number'>1247</span>
<span class='line-number'>1248</span>
<span class='line-number'>1249</span>
<span class='line-number'>1250</span>
<span class='line-number'>1251</span>
<span class='line-number'>1252</span>
<span class='line-number'>1253</span>
<span class='line-number'>1254</span>
<span class='line-number'>1255</span>
<span class='line-number'>1256</span>
<span class='line-number'>1257</span>
<span class='line-number'>1258</span>
<span class='line-number'>1259</span>
<span class='line-number'>1260</span>
<span class='line-number'>1261</span>
<span class='line-number'>1262</span>
<span class='line-number'>1263</span>
<span class='line-number'>1264</span>
<span class='line-number'>1265</span>
<span class='line-number'>1266</span>
<span class='line-number'>1267</span>
<span class='line-number'>1268</span>
<span class='line-number'>1269</span>
<span class='line-number'>1270</span>
<span class='line-number'>1271</span>
<span class='line-number'>1272</span>
<span class='line-number'>1273</span>
<span class='line-number'>1274</span>
<span class='line-number'>1275</span>
<span class='line-number'>1276</span>
<span class='line-number'>1277</span>
<span class='line-number'>1278</span>
<span class='line-number'>1279</span>
<span class='line-number'>1280</span>
<span class='line-number'>1281</span>
<span class='line-number'>1282</span>
<span class='line-number'>1283</span>
<span class='line-number'>1284</span>
<span class='line-number'>1285</span>
<span class='line-number'>1286</span>
<span class='line-number'>1287</span>
<span class='line-number'>1288</span>
<span class='line-number'>1289</span>
<span class='line-number'>1290</span>
<span class='line-number'>1291</span>
<span class='line-number'>1292</span>
<span class='line-number'>1293</span>
<span class='line-number'>1294</span>
<span class='line-number'>1295</span>
<span class='line-number'>1296</span>
<span class='line-number'>1297</span>
<span class='line-number'>1298</span>
<span class='line-number'>1299</span>
<span class='line-number'>1300</span>
<span class='line-number'>1301</span>
<span class='line-number'>1302</span>
<span class='line-number'>1303</span>
<span class='line-number'>1304</span>
<span class='line-number'>1305</span>
<span class='line-number'>1306</span>
<span class='line-number'>1307</span>
<span class='line-number'>1308</span>
<span class='line-number'>1309</span>
<span class='line-number'>1310</span>
<span class='line-number'>1311</span>
<span class='line-number'>1312</span>
<span class='line-number'>1313</span>
<span class='line-number'>1314</span>
<span class='line-number'>1315</span>
<span class='line-number'>1316</span>
<span class='line-number'>1317</span>
<span class='line-number'>1318</span>
<span class='line-number'>1319</span>
<span class='line-number'>1320</span>
<span class='line-number'>1321</span>
<span class='line-number'>1322</span>
<span class='line-number'>1323</span>
<span class='line-number'>1324</span>
<span class='line-number'>1325</span>
<span class='line-number'>1326</span>
<span class='line-number'>1327</span>
<span class='line-number'>1328</span>
<span class='line-number'>1329</span>
<span class='line-number'>1330</span>
<span class='line-number'>1331</span>
<span class='line-number'>1332</span>
<span class='line-number'>1333</span>
<span class='line-number'>1334</span>
<span class='line-number'>1335</span>
<span class='line-number'>1336</span>
<span class='line-number'>1337</span>
<span class='line-number'>1338</span>
<span class='line-number'>1339</span>
<span class='line-number'>1340</span>
<span class='line-number'>1341</span>
<span class='line-number'>1342</span>
<span class='line-number'>1343</span>
<span class='line-number'>1344</span>
<span class='line-number'>1345</span>
<span class='line-number'>1346</span>
<span class='line-number'>1347</span>
<span class='line-number'>1348</span>
<span class='line-number'>1349</span>
<span class='line-number'>1350</span>
<span class='line-number'>1351</span>
<span class='line-number'>1352</span>
<span class='line-number'>1353</span>
<span class='line-number'>1354</span>
<span class='line-number'>1355</span>
<span class='line-number'>1356</span>
<span class='line-number'>1357</span>
<span class='line-number'>1358</span>
<span class='line-number'>1359</span>
<span class='line-number'>1360</span>
<span class='line-number'>1361</span>
<span class='line-number'>1362</span>
<span class='line-number'>1363</span>
<span class='line-number'>1364</span>
<span class='line-number'>1365</span>
<span class='line-number'>1366</span>
<span class='line-number'>1367</span>
<span class='line-number'>1368</span>
<span class='line-number'>1369</span>
<span class='line-number'>1370</span>
<span class='line-number'>1371</span>
<span class='line-number'>1372</span>
<span class='line-number'>1373</span>
<span class='line-number'>1374</span>
<span class='line-number'>1375</span>
<span class='line-number'>1376</span>
<span class='line-number'>1377</span>
<span class='line-number'>1378</span>
<span class='line-number'>1379</span>
<span class='line-number'>1380</span>
<span class='line-number'>1381</span>
<span class='line-number'>1382</span>
<span class='line-number'>1383</span>
<span class='line-number'>1384</span>
<span class='line-number'>1385</span>
<span class='line-number'>1386</span>
<span class='line-number'>1387</span>
<span class='line-number'>1388</span>
<span class='line-number'>1389</span>
<span class='line-number'>1390</span>
<span class='line-number'>1391</span>
<span class='line-number'>1392</span>
<span class='line-number'>1393</span>
<span class='line-number'>1394</span>
<span class='line-number'>1395</span>
<span class='line-number'>1396</span>
<span class='line-number'>1397</span>
<span class='line-number'>1398</span>
<span class='line-number'>1399</span>
<span class='line-number'>1400</span>
<span class='line-number'>1401</span>
<span class='line-number'>1402</span>
<span class='line-number'>1403</span>
<span class='line-number'>1404</span>
<span class='line-number'>1405</span>
<span class='line-number'>1406</span>
<span class='line-number'>1407</span>
<span class='line-number'>1408</span>
<span class='line-number'>1409</span>
<span class='line-number'>1410</span>
<span class='line-number'>1411</span>
<span class='line-number'>1412</span>
<span class='line-number'>1413</span>
<span class='line-number'>1414</span>
<span class='line-number'>1415</span>
<span class='line-number'>1416</span>
<span class='line-number'>1417</span>
<span class='line-number'>1418</span>
<span class='line-number'>1419</span>
<span class='line-number'>1420</span>
<span class='line-number'>1421</span>
<span class='line-number'>1422</span>
<span class='line-number'>1423</span>
<span class='line-number'>1424</span>
<span class='line-number'>1425</span>
<span class='line-number'>1426</span>
<span class='line-number'>1427</span>
<span class='line-number'>1428</span>
<span class='line-number'>1429</span>
<span class='line-number'>1430</span>
<span class='line-number'>1431</span>
<span class='line-number'>1432</span>
<span class='line-number'>1433</span>
<span class='line-number'>1434</span>
<span class='line-number'>1435</span>
<span class='line-number'>1436</span>
<span class='line-number'>1437</span>
<span class='line-number'>1438</span>
<span class='line-number'>1439</span>
<span class='line-number'>1440</span>
<span class='line-number'>1441</span>
<span class='line-number'>1442</span>
<span class='line-number'>1443</span>
<span class='line-number'>1444</span>
<span class='line-number'>1445</span>
<span class='line-number'>1446</span>
<span class='line-number'>1447</span>
<span class='line-number'>1448</span>
<span class='line-number'>1449</span>
<span class='line-number'>1450</span>
<span class='line-number'>1451</span>
<span class='line-number'>1452</span>
<span class='line-number'>1453</span>
<span class='line-number'>1454</span>
<span class='line-number'>1455</span>
<span class='line-number'>1456</span>
<span class='line-number'>1457</span>
<span class='line-number'>1458</span>
<span class='line-number'>1459</span>
<span class='line-number'>1460</span>
<span class='line-number'>1461</span>
<span class='line-number'>1462</span>
<span class='line-number'>1463</span>
<span class='line-number'>1464</span>
<span class='line-number'>1465</span>
<span class='line-number'>1466</span>
<span class='line-number'>1467</span>
<span class='line-number'>1468</span>
<span class='line-number'>1469</span>
<span class='line-number'>1470</span>
<span class='line-number'>1471</span>
<span class='line-number'>1472</span>
<span class='line-number'>1473</span>
<span class='line-number'>1474</span>
<span class='line-number'>1475</span>
<span class='line-number'>1476</span>
<span class='line-number'>1477</span>
<span class='line-number'>1478</span>
<span class='line-number'>1479</span>
<span class='line-number'>1480</span>
<span class='line-number'>1481</span>
<span class='line-number'>1482</span>
<span class='line-number'>1483</span>
<span class='line-number'>1484</span>
<span class='line-number'>1485</span>
<span class='line-number'>1486</span>
<span class='line-number'>1487</span>
<span class='line-number'>1488</span>
<span class='line-number'>1489</span>
<span class='line-number'>1490</span>
<span class='line-number'>1491</span>
<span class='line-number'>1492</span>
<span class='line-number'>1493</span>
<span class='line-number'>1494</span>
<span class='line-number'>1495</span>
<span class='line-number'>1496</span>
<span class='line-number'>1497</span>
<span class='line-number'>1498</span>
<span class='line-number'>1499</span>
<span class='line-number'>1500</span>
<span class='line-number'>1501</span>
<span class='line-number'>1502</span>
<span class='line-number'>1503</span>
<span class='line-number'>1504</span>
<span class='line-number'>1505</span>
<span class='line-number'>1506</span>
<span class='line-number'>1507</span>
<span class='line-number'>1508</span>
<span class='line-number'>1509</span>
<span class='line-number'>1510</span>
<span class='line-number'>1511</span>
<span class='line-number'>1512</span>
<span class='line-number'>1513</span>
<span class='line-number'>1514</span>
<span class='line-number'>1515</span>
<span class='line-number'>1516</span>
<span class='line-number'>1517</span>
<span class='line-number'>1518</span>
<span class='line-number'>1519</span>
<span class='line-number'>1520</span>
<span class='line-number'>1521</span>
<span class='line-number'>1522</span>
<span class='line-number'>1523</span>
<span class='line-number'>1524</span>
<span class='line-number'>1525</span>
<span class='line-number'>1526</span>
<span class='line-number'>1527</span>
<span class='line-number'>1528</span>
<span class='line-number'>1529</span>
<span class='line-number'>1530</span>
<span class='line-number'>1531</span>
<span class='line-number'>1532</span>
<span class='line-number'>1533</span>
<span class='line-number'>1534</span>
<span class='line-number'>1535</span>
<span class='line-number'>1536</span>
<span class='line-number'>1537</span>
<span class='line-number'>1538</span>
<span class='line-number'>1539</span>
<span class='line-number'>1540</span>
<span class='line-number'>1541</span>
<span class='line-number'>1542</span>
<span class='line-number'>1543</span>
<span class='line-number'>1544</span>
<span class='line-number'>1545</span>
<span class='line-number'>1546</span>
<span class='line-number'>1547</span>
<span class='line-number'>1548</span>
<span class='line-number'>1549</span>
<span class='line-number'>1550</span>
<span class='line-number'>1551</span>
<span class='line-number'>1552</span>
<span class='line-number'>1553</span>
<span class='line-number'>1554</span>
<span class='line-number'>1555</span>
<span class='line-number'>1556</span>
<span class='line-number'>1557</span>
<span class='line-number'>1558</span>
<span class='line-number'>1559</span>
<span class='line-number'>1560</span>
<span class='line-number'>1561</span>
<span class='line-number'>1562</span>
<span class='line-number'>1563</span>
<span class='line-number'>1564</span>
<span class='line-number'>1565</span>
<span class='line-number'>1566</span>
<span class='line-number'>1567</span>
<span class='line-number'>1568</span>
<span class='line-number'>1569</span>
<span class='line-number'>1570</span>
<span class='line-number'>1571</span>
<span class='line-number'>1572</span>
<span class='line-number'>1573</span>
<span class='line-number'>1574</span>
<span class='line-number'>1575</span>
<span class='line-number'>1576</span>
<span class='line-number'>1577</span>
<span class='line-number'>1578</span>
<span class='line-number'>1579</span>
<span class='line-number'>1580</span>
<span class='line-number'>1581</span>
<span class='line-number'>1582</span>
<span class='line-number'>1583</span>
<span class='line-number'>1584</span>
<span class='line-number'>1585</span>
<span class='line-number'>1586</span>
<span class='line-number'>1587</span>
<span class='line-number'>1588</span>
<span class='line-number'>1589</span>
<span class='line-number'>1590</span>
<span class='line-number'>1591</span>
<span class='line-number'>1592</span>
<span class='line-number'>1593</span>
<span class='line-number'>1594</span>
<span class='line-number'>1595</span>
<span class='line-number'>1596</span>
<span class='line-number'>1597</span>
<span class='line-number'>1598</span>
<span class='line-number'>1599</span>
<span class='line-number'>1600</span>
<span class='line-number'>1601</span>
<span class='line-number'>1602</span>
<span class='line-number'>1603</span>
<span class='line-number'>1604</span>
<span class='line-number'>1605</span>
<span class='line-number'>1606</span>
<span class='line-number'>1607</span>
<span class='line-number'>1608</span>
<span class='line-number'>1609</span>
<span class='line-number'>1610</span>
<span class='line-number'>1611</span>
<span class='line-number'>1612</span>
<span class='line-number'>1613</span>
<span class='line-number'>1614</span>
<span class='line-number'>1615</span>
<span class='line-number'>1616</span>
<span class='line-number'>1617</span>
<span class='line-number'>1618</span>
<span class='line-number'>1619</span>
<span class='line-number'>1620</span>
<span class='line-number'>1621</span>
<span class='line-number'>1622</span>
<span class='line-number'>1623</span>
<span class='line-number'>1624</span>
<span class='line-number'>1625</span>
<span class='line-number'>1626</span>
<span class='line-number'>1627</span>
<span class='line-number'>1628</span>
<span class='line-number'>1629</span>
<span class='line-number'>1630</span>
<span class='line-number'>1631</span>
<span class='line-number'>1632</span>
<span class='line-number'>1633</span>
<span class='line-number'>1634</span>
<span class='line-number'>1635</span>
<span class='line-number'>1636</span>
<span class='line-number'>1637</span>
<span class='line-number'>1638</span>
<span class='line-number'>1639</span>
<span class='line-number'>1640</span>
<span class='line-number'>1641</span>
<span class='line-number'>1642</span>
<span class='line-number'>1643</span>
<span class='line-number'>1644</span>
<span class='line-number'>1645</span>
<span class='line-number'>1646</span>
<span class='line-number'>1647</span>
<span class='line-number'>1648</span>
<span class='line-number'>1649</span>
<span class='line-number'>1650</span>
<span class='line-number'>1651</span>
<span class='line-number'>1652</span>
<span class='line-number'>1653</span>
<span class='line-number'>1654</span>
<span class='line-number'>1655</span>
<span class='line-number'>1656</span>
<span class='line-number'>1657</span>
<span class='line-number'>1658</span>
<span class='line-number'>1659</span>
<span class='line-number'>1660</span>
<span class='line-number'>1661</span>
<span class='line-number'>1662</span>
<span class='line-number'>1663</span>
<span class='line-number'>1664</span>
<span class='line-number'>1665</span>
<span class='line-number'>1666</span>
<span class='line-number'>1667</span>
<span class='line-number'>1668</span>
<span class='line-number'>1669</span>
<span class='line-number'>1670</span>
<span class='line-number'>1671</span>
<span class='line-number'>1672</span>
<span class='line-number'>1673</span>
<span class='line-number'>1674</span>
<span class='line-number'>1675</span>
<span class='line-number'>1676</span>
<span class='line-number'>1677</span>
<span class='line-number'>1678</span>
<span class='line-number'>1679</span>
<span class='line-number'>1680</span>
<span class='line-number'>1681</span>
<span class='line-number'>1682</span>
<span class='line-number'>1683</span>
<span class='line-number'>1684</span>
<span class='line-number'>1685</span>
<span class='line-number'>1686</span>
<span class='line-number'>1687</span>
<span class='line-number'>1688</span>
<span class='line-number'>1689</span>
<span class='line-number'>1690</span>
<span class='line-number'>1691</span>
<span class='line-number'>1692</span>
<span class='line-number'>1693</span>
<span class='line-number'>1694</span>
<span class='line-number'>1695</span>
<span class='line-number'>1696</span>
<span class='line-number'>1697</span>
<span class='line-number'>1698</span>
<span class='line-number'>1699</span>
<span class='line-number'>1700</span>
<span class='line-number'>1701</span>
<span class='line-number'>1702</span>
<span class='line-number'>1703</span>
<span class='line-number'>1704</span>
<span class='line-number'>1705</span>
<span class='line-number'>1706</span>
<span class='line-number'>1707</span>
<span class='line-number'>1708</span>
<span class='line-number'>1709</span>
<span class='line-number'>1710</span>
<span class='line-number'>1711</span>
<span class='line-number'>1712</span>
<span class='line-number'>1713</span>
<span class='line-number'>1714</span>
<span class='line-number'>1715</span>
<span class='line-number'>1716</span>
<span class='line-number'>1717</span>
<span class='line-number'>1718</span>
<span class='line-number'>1719</span>
<span class='line-number'>1720</span>
<span class='line-number'>1721</span>
<span class='line-number'>1722</span>
<span class='line-number'>1723</span>
<span class='line-number'>1724</span>
<span class='line-number'>1725</span>
<span class='line-number'>1726</span>
<span class='line-number'>1727</span>
<span class='line-number'>1728</span>
<span class='line-number'>1729</span>
<span class='line-number'>1730</span>
<span class='line-number'>1731</span>
<span class='line-number'>1732</span>
<span class='line-number'>1733</span>
<span class='line-number'>1734</span>
<span class='line-number'>1735</span>
<span class='line-number'>1736</span>
<span class='line-number'>1737</span>
<span class='line-number'>1738</span>
<span class='line-number'>1739</span>
<span class='line-number'>1740</span>
<span class='line-number'>1741</span>
<span class='line-number'>1742</span>
<span class='line-number'>1743</span>
<span class='line-number'>1744</span>
<span class='line-number'>1745</span>
<span class='line-number'>1746</span>
<span class='line-number'>1747</span>
<span class='line-number'>1748</span>
<span class='line-number'>1749</span>
<span class='line-number'>1750</span>
<span class='line-number'>1751</span>
<span class='line-number'>1752</span>
<span class='line-number'>1753</span>
<span class='line-number'>1754</span>
<span class='line-number'>1755</span>
<span class='line-number'>1756</span>
<span class='line-number'>1757</span>
<span class='line-number'>1758</span>
<span class='line-number'>1759</span>
<span class='line-number'>1760</span>
<span class='line-number'>1761</span>
<span class='line-number'>1762</span>
<span class='line-number'>1763</span>
<span class='line-number'>1764</span>
<span class='line-number'>1765</span>
<span class='line-number'>1766</span>
<span class='line-number'>1767</span>
<span class='line-number'>1768</span>
<span class='line-number'>1769</span>
<span class='line-number'>1770</span>
<span class='line-number'>1771</span>
<span class='line-number'>1772</span>
<span class='line-number'>1773</span>
<span class='line-number'>1774</span>
<span class='line-number'>1775</span>
<span class='line-number'>1776</span>
<span class='line-number'>1777</span>
<span class='line-number'>1778</span>
<span class='line-number'>1779</span>
<span class='line-number'>1780</span>
<span class='line-number'>1781</span>
<span class='line-number'>1782</span>
<span class='line-number'>1783</span>
<span class='line-number'>1784</span>
<span class='line-number'>1785</span>
<span class='line-number'>1786</span>
<span class='line-number'>1787</span>
<span class='line-number'>1788</span>
<span class='line-number'>1789</span>
<span class='line-number'>1790</span>
<span class='line-number'>1791</span>
<span class='line-number'>1792</span>
<span class='line-number'>1793</span>
<span class='line-number'>1794</span>
<span class='line-number'>1795</span>
<span class='line-number'>1796</span>
<span class='line-number'>1797</span>
<span class='line-number'>1798</span>
<span class='line-number'>1799</span>
<span class='line-number'>1800</span>
<span class='line-number'>1801</span>
<span class='line-number'>1802</span>
<span class='line-number'>1803</span>
<span class='line-number'>1804</span>
<span class='line-number'>1805</span>
<span class='line-number'>1806</span>
<span class='line-number'>1807</span>
<span class='line-number'>1808</span>
<span class='line-number'>1809</span>
<span class='line-number'>1810</span>
<span class='line-number'>1811</span>
<span class='line-number'>1812</span>
<span class='line-number'>1813</span>
<span class='line-number'>1814</span>
<span class='line-number'>1815</span>
<span class='line-number'>1816</span>
<span class='line-number'>1817</span>
<span class='line-number'>1818</span>
<span class='line-number'>1819</span>
<span class='line-number'>1820</span>
<span class='line-number'>1821</span>
<span class='line-number'>1822</span>
<span class='line-number'>1823</span>
<span class='line-number'>1824</span>
<span class='line-number'>1825</span>
<span class='line-number'>1826</span>
<span class='line-number'>1827</span>
<span class='line-number'>1828</span>
<span class='line-number'>1829</span>
<span class='line-number'>1830</span>
<span class='line-number'>1831</span>
<span class='line-number'>1832</span>
<span class='line-number'>1833</span>
<span class='line-number'>1834</span>
<span class='line-number'>1835</span>
<span class='line-number'>1836</span>
<span class='line-number'>1837</span>
<span class='line-number'>1838</span>
<span class='line-number'>1839</span>
<span class='line-number'>1840</span>
<span class='line-number'>1841</span>
<span class='line-number'>1842</span>
<span class='line-number'>1843</span>
<span class='line-number'>1844</span>
<span class='line-number'>1845</span>
<span class='line-number'>1846</span>
<span class='line-number'>1847</span>
<span class='line-number'>1848</span>
<span class='line-number'>1849</span>
<span class='line-number'>1850</span>
<span class='line-number'>1851</span>
<span class='line-number'>1852</span>
<span class='line-number'>1853</span>
<span class='line-number'>1854</span>
<span class='line-number'>1855</span>
<span class='line-number'>1856</span>
<span class='line-number'>1857</span>
<span class='line-number'>1858</span>
<span class='line-number'>1859</span>
<span class='line-number'>1860</span>
<span class='line-number'>1861</span>
<span class='line-number'>1862</span>
<span class='line-number'>1863</span>
<span class='line-number'>1864</span>
<span class='line-number'>1865</span>
<span class='line-number'>1866</span>
<span class='line-number'>1867</span>
<span class='line-number'>1868</span>
<span class='line-number'>1869</span>
<span class='line-number'>1870</span>
<span class='line-number'>1871</span>
<span class='line-number'>1872</span>
<span class='line-number'>1873</span>
<span class='line-number'>1874</span>
<span class='line-number'>1875</span>
<span class='line-number'>1876</span>
<span class='line-number'>1877</span>
<span class='line-number'>1878</span>
<span class='line-number'>1879</span>
<span class='line-number'>1880</span>
<span class='line-number'>1881</span>
<span class='line-number'>1882</span>
<span class='line-number'>1883</span>
<span class='line-number'>1884</span>
<span class='line-number'>1885</span>
<span class='line-number'>1886</span>
<span class='line-number'>1887</span>
<span class='line-number'>1888</span>
<span class='line-number'>1889</span>
<span class='line-number'>1890</span>
<span class='line-number'>1891</span>
<span class='line-number'>1892</span>
<span class='line-number'>1893</span>
<span class='line-number'>1894</span>
<span class='line-number'>1895</span>
<span class='line-number'>1896</span>
<span class='line-number'>1897</span>
<span class='line-number'>1898</span>
<span class='line-number'>1899</span>
<span class='line-number'>1900</span>
<span class='line-number'>1901</span>
<span class='line-number'>1902</span>
<span class='line-number'>1903</span>
<span class='line-number'>1904</span>
<span class='line-number'>1905</span>
<span class='line-number'>1906</span>
<span class='line-number'>1907</span>
<span class='line-number'>1908</span>
<span class='line-number'>1909</span>
<span class='line-number'>1910</span>
<span class='line-number'>1911</span>
<span class='line-number'>1912</span>
<span class='line-number'>1913</span>
<span class='line-number'>1914</span>
<span class='line-number'>1915</span>
<span class='line-number'>1916</span>
<span class='line-number'>1917</span>
<span class='line-number'>1918</span>
<span class='line-number'>1919</span>
<span class='line-number'>1920</span>
<span class='line-number'>1921</span>
<span class='line-number'>1922</span>
<span class='line-number'>1923</span>
<span class='line-number'>1924</span>
<span class='line-number'>1925</span>
<span class='line-number'>1926</span>
<span class='line-number'>1927</span>
<span class='line-number'>1928</span>
<span class='line-number'>1929</span>
<span class='line-number'>1930</span>
<span class='line-number'>1931</span>
<span class='line-number'>1932</span>
<span class='line-number'>1933</span>
<span class='line-number'>1934</span>
<span class='line-number'>1935</span>
<span class='line-number'>1936</span>
<span class='line-number'>1937</span>
<span class='line-number'>1938</span>
<span class='line-number'>1939</span>
<span class='line-number'>1940</span>
<span class='line-number'>1941</span>
<span class='line-number'>1942</span>
<span class='line-number'>1943</span>
<span class='line-number'>1944</span>
<span class='line-number'>1945</span>
<span class='line-number'>1946</span>
<span class='line-number'>1947</span>
<span class='line-number'>1948</span>
<span class='line-number'>1949</span>
<span class='line-number'>1950</span>
<span class='line-number'>1951</span>
<span class='line-number'>1952</span>
<span class='line-number'>1953</span>
<span class='line-number'>1954</span>
<span class='line-number'>1955</span>
<span class='line-number'>1956</span>
<span class='line-number'>1957</span>
<span class='line-number'>1958</span>
<span class='line-number'>1959</span>
<span class='line-number'>1960</span>
<span class='line-number'>1961</span>
<span class='line-number'>1962</span>
<span class='line-number'>1963</span>
<span class='line-number'>1964</span>
<span class='line-number'>1965</span>
<span class='line-number'>1966</span>
<span class='line-number'>1967</span>
<span class='line-number'>1968</span>
<span class='line-number'>1969</span>
<span class='line-number'>1970</span>
<span class='line-number'>1971</span>
<span class='line-number'>1972</span>
<span class='line-number'>1973</span>
<span class='line-number'>1974</span>
<span class='line-number'>1975</span>
<span class='line-number'>1976</span>
<span class='line-number'>1977</span>
<span class='line-number'>1978</span>
<span class='line-number'>1979</span>
<span class='line-number'>1980</span>
<span class='line-number'>1981</span>
<span class='line-number'>1982</span>
<span class='line-number'>1983</span>
<span class='line-number'>1984</span>
<span class='line-number'>1985</span>
<span class='line-number'>1986</span>
<span class='line-number'>1987</span>
<span class='line-number'>1988</span>
<span class='line-number'>1989</span>
<span class='line-number'>1990</span>
<span class='line-number'>1991</span>
<span class='line-number'>1992</span>
<span class='line-number'>1993</span>
<span class='line-number'>1994</span>
<span class='line-number'>1995</span>
<span class='line-number'>1996</span>
<span class='line-number'>1997</span>
<span class='line-number'>1998</span>
<span class='line-number'>1999</span>
<span class='line-number'>2000</span>
<span class='line-number'>2001</span>
<span class='line-number'>2002</span>
<span class='line-number'>2003</span>
<span class='line-number'>2004</span>
<span class='line-number'>2005</span>
<span class='line-number'>2006</span>
<span class='line-number'>2007</span>
<span class='line-number'>2008</span>
<span class='line-number'>2009</span>
<span class='line-number'>2010</span>
<span class='line-number'>2011</span>
<span class='line-number'>2012</span>
<span class='line-number'>2013</span>
<span class='line-number'>2014</span>
<span class='line-number'>2015</span>
<span class='line-number'>2016</span>
<span class='line-number'>2017</span>
<span class='line-number'>2018</span>
<span class='line-number'>2019</span>
<span class='line-number'>2020</span>
<span class='line-number'>2021</span>
<span class='line-number'>2022</span>
<span class='line-number'>2023</span>
<span class='line-number'>2024</span>
<span class='line-number'>2025</span>
<span class='line-number'>2026</span>
<span class='line-number'>2027</span>
<span class='line-number'>2028</span>
<span class='line-number'>2029</span>
<span class='line-number'>2030</span>
<span class='line-number'>2031</span>
<span class='line-number'>2032</span>
<span class='line-number'>2033</span>
<span class='line-number'>2034</span>
<span class='line-number'>2035</span>
<span class='line-number'>2036</span>
<span class='line-number'>2037</span>
<span class='line-number'>2038</span>
<span class='line-number'>2039</span>
<span class='line-number'>2040</span>
<span class='line-number'>2041</span>
<span class='line-number'>2042</span>
<span class='line-number'>2043</span>
<span class='line-number'>2044</span>
<span class='line-number'>2045</span>
<span class='line-number'>2046</span>
<span class='line-number'>2047</span>
<span class='line-number'>2048</span>
<span class='line-number'>2049</span>
<span class='line-number'>2050</span>
<span class='line-number'>2051</span>
<span class='line-number'>2052</span>
<span class='line-number'>2053</span>
<span class='line-number'>2054</span>
<span class='line-number'>2055</span>
<span class='line-number'>2056</span>
<span class='line-number'>2057</span>
<span class='line-number'>2058</span>
<span class='line-number'>2059</span>
<span class='line-number'>2060</span>
<span class='line-number'>2061</span>
<span class='line-number'>2062</span>
<span class='line-number'>2063</span>
<span class='line-number'>2064</span>
<span class='line-number'>2065</span>
<span class='line-number'>2066</span>
<span class='line-number'>2067</span>
<span class='line-number'>2068</span>
<span class='line-number'>2069</span>
<span class='line-number'>2070</span>
<span class='line-number'>2071</span>
<span class='line-number'>2072</span>
<span class='line-number'>2073</span>
<span class='line-number'>2074</span>
<span class='line-number'>2075</span>
<span class='line-number'>2076</span>
<span class='line-number'>2077</span>
<span class='line-number'>2078</span>
<span class='line-number'>2079</span>
<span class='line-number'>2080</span>
<span class='line-number'>2081</span>
<span class='line-number'>2082</span>
<span class='line-number'>2083</span>
<span class='line-number'>2084</span>
<span class='line-number'>2085</span>
<span class='line-number'>2086</span>
<span class='line-number'>2087</span>
<span class='line-number'>2088</span>
<span class='line-number'>2089</span>
<span class='line-number'>2090</span>
<span class='line-number'>2091</span>
<span class='line-number'>2092</span>
<span class='line-number'>2093</span>
<span class='line-number'>2094</span>
<span class='line-number'>2095</span>
<span class='line-number'>2096</span>
<span class='line-number'>2097</span>
<span class='line-number'>2098</span>
<span class='line-number'>2099</span>
<span class='line-number'>2100</span>
<span class='line-number'>2101</span>
<span class='line-number'>2102</span>
<span class='line-number'>2103</span>
<span class='line-number'>2104</span>
<span class='line-number'>2105</span>
<span class='line-number'>2106</span>
<span class='line-number'>2107</span>
<span class='line-number'>2108</span>
<span class='line-number'>2109</span>
<span class='line-number'>2110</span>
<span class='line-number'>2111</span>
<span class='line-number'>2112</span>
<span class='line-number'>2113</span>
<span class='line-number'>2114</span>
<span class='line-number'>2115</span>
<span class='line-number'>2116</span>
<span class='line-number'>2117</span>
<span class='line-number'>2118</span>
<span class='line-number'>2119</span>
<span class='line-number'>2120</span>
<span class='line-number'>2121</span>
<span class='line-number'>2122</span>
<span class='line-number'>2123</span>
<span class='line-number'>2124</span>
<span class='line-number'>2125</span>
<span class='line-number'>2126</span>
<span class='line-number'>2127</span>
<span class='line-number'>2128</span>
<span class='line-number'>2129</span>
<span class='line-number'>2130</span>
<span class='line-number'>2131</span>
<span class='line-number'>2132</span>
<span class='line-number'>2133</span>
<span class='line-number'>2134</span>
<span class='line-number'>2135</span>
<span class='line-number'>2136</span>
<span class='line-number'>2137</span>
<span class='line-number'>2138</span>
<span class='line-number'>2139</span>
<span class='line-number'>2140</span>
<span class='line-number'>2141</span>
<span class='line-number'>2142</span>
<span class='line-number'>2143</span>
<span class='line-number'>2144</span>
<span class='line-number'>2145</span>
<span class='line-number'>2146</span>
<span class='line-number'>2147</span>
<span class='line-number'>2148</span>
<span class='line-number'>2149</span>
<span class='line-number'>2150</span>
<span class='line-number'>2151</span>
<span class='line-number'>2152</span>
<span class='line-number'>2153</span>
<span class='line-number'>2154</span>
<span class='line-number'>2155</span>
<span class='line-number'>2156</span>
<span class='line-number'>2157</span>
<span class='line-number'>2158</span>
<span class='line-number'>2159</span>
<span class='line-number'>2160</span>
<span class='line-number'>2161</span>
<span class='line-number'>2162</span>
<span class='line-number'>2163</span>
<span class='line-number'>2164</span>
<span class='line-number'>2165</span>
<span class='line-number'>2166</span>
<span class='line-number'>2167</span>
<span class='line-number'>2168</span>
<span class='line-number'>2169</span>
<span class='line-number'>2170</span>
<span class='line-number'>2171</span>
<span class='line-number'>2172</span>
<span class='line-number'>2173</span>
<span class='line-number'>2174</span>
<span class='line-number'>2175</span>
<span class='line-number'>2176</span>
<span class='line-number'>2177</span>
<span class='line-number'>2178</span>
<span class='line-number'>2179</span>
<span class='line-number'>2180</span>
<span class='line-number'>2181</span>
<span class='line-number'>2182</span>
<span class='line-number'>2183</span>
<span class='line-number'>2184</span>
<span class='line-number'>2185</span>
<span class='line-number'>2186</span>
<span class='line-number'>2187</span>
<span class='line-number'>2188</span>
<span class='line-number'>2189</span>
<span class='line-number'>2190</span>
<span class='line-number'>2191</span>
<span class='line-number'>2192</span>
<span class='line-number'>2193</span>
<span class='line-number'>2194</span>
<span class='line-number'>2195</span>
<span class='line-number'>2196</span>
<span class='line-number'>2197</span>
<span class='line-number'>2198</span>
<span class='line-number'>2199</span>
<span class='line-number'>2200</span>
<span class='line-number'>2201</span>
<span class='line-number'>2202</span>
<span class='line-number'>2203</span>
<span class='line-number'>2204</span>
<span class='line-number'>2205</span>
<span class='line-number'>2206</span>
<span class='line-number'>2207</span>
<span class='line-number'>2208</span>
<span class='line-number'>2209</span>
<span class='line-number'>2210</span>
<span class='line-number'>2211</span>
<span class='line-number'>2212</span>
<span class='line-number'>2213</span>
<span class='line-number'>2214</span>
<span class='line-number'>2215</span>
<span class='line-number'>2216</span>
<span class='line-number'>2217</span>
<span class='line-number'>2218</span>
<span class='line-number'>2219</span>
<span class='line-number'>2220</span>
<span class='line-number'>2221</span>
<span class='line-number'>2222</span>
<span class='line-number'>2223</span>
<span class='line-number'>2224</span>
<span class='line-number'>2225</span>
<span class='line-number'>2226</span>
<span class='line-number'>2227</span>
<span class='line-number'>2228</span>
<span class='line-number'>2229</span>
<span class='line-number'>2230</span>
<span class='line-number'>2231</span>
<span class='line-number'>2232</span>
<span class='line-number'>2233</span>
<span class='line-number'>2234</span>
<span class='line-number'>2235</span>
<span class='line-number'>2236</span>
<span class='line-number'>2237</span>
<span class='line-number'>2238</span>
<span class='line-number'>2239</span>
<span class='line-number'>2240</span>
<span class='line-number'>2241</span>
<span class='line-number'>2242</span>
<span class='line-number'>2243</span>
<span class='line-number'>2244</span>
<span class='line-number'>2245</span>
<span class='line-number'>2246</span>
<span class='line-number'>2247</span>
<span class='line-number'>2248</span>
<span class='line-number'>2249</span>
<span class='line-number'>2250</span>
<span class='line-number'>2251</span>
<span class='line-number'>2252</span>
<span class='line-number'>2253</span>
<span class='line-number'>2254</span>
<span class='line-number'>2255</span>
<span class='line-number'>2256</span>
<span class='line-number'>2257</span>
<span class='line-number'>2258</span>
<span class='line-number'>2259</span>
<span class='line-number'>2260</span>
<span class='line-number'>2261</span>
<span class='line-number'>2262</span>
<span class='line-number'>2263</span>
<span class='line-number'>2264</span>
<span class='line-number'>2265</span>
<span class='line-number'>2266</span>
<span class='line-number'>2267</span>
<span class='line-number'>2268</span>
<span class='line-number'>2269</span>
<span class='line-number'>2270</span>
<span class='line-number'>2271</span>
<span class='line-number'>2272</span>
<span class='line-number'>2273</span>
<span class='line-number'>2274</span>
<span class='line-number'>2275</span>
<span class='line-number'>2276</span>
<span class='line-number'>2277</span>
<span class='line-number'>2278</span>
<span class='line-number'>2279</span>
<span class='line-number'>2280</span>
<span class='line-number'>2281</span>
<span class='line-number'>2282</span>
<span class='line-number'>2283</span>
<span class='line-number'>2284</span>
<span class='line-number'>2285</span>
<span class='line-number'>2286</span>
<span class='line-number'>2287</span>
<span class='line-number'>2288</span>
<span class='line-number'>2289</span>
<span class='line-number'>2290</span>
<span class='line-number'>2291</span>
<span class='line-number'>2292</span>
<span class='line-number'>2293</span>
<span class='line-number'>2294</span>
<span class='line-number'>2295</span>
<span class='line-number'>2296</span>
<span class='line-number'>2297</span>
<span class='line-number'>2298</span>
<span class='line-number'>2299</span>
<span class='line-number'>2300</span>
<span class='line-number'>2301</span>
<span class='line-number'>2302</span>
<span class='line-number'>2303</span>
<span class='line-number'>2304</span>
<span class='line-number'>2305</span>
<span class='line-number'>2306</span>
<span class='line-number'>2307</span>
<span class='line-number'>2308</span>
<span class='line-number'>2309</span>
<span class='line-number'>2310</span>
<span class='line-number'>2311</span>
<span class='line-number'>2312</span>
<span class='line-number'>2313</span>
<span class='line-number'>2314</span>
<span class='line-number'>2315</span>
<span class='line-number'>2316</span>
<span class='line-number'>2317</span>
<span class='line-number'>2318</span>
<span class='line-number'>2319</span>
<span class='line-number'>2320</span>
<span class='line-number'>2321</span>
<span class='line-number'>2322</span>
<span class='line-number'>2323</span>
<span class='line-number'>2324</span>
<span class='line-number'>2325</span>
<span class='line-number'>2326</span>
<span class='line-number'>2327</span>
<span class='line-number'>2328</span>
<span class='line-number'>2329</span>
<span class='line-number'>2330</span>
<span class='line-number'>2331</span>
<span class='line-number'>2332</span>
<span class='line-number'>2333</span>
<span class='line-number'>2334</span>
<span class='line-number'>2335</span>
<span class='line-number'>2336</span>
<span class='line-number'>2337</span>
<span class='line-number'>2338</span>
<span class='line-number'>2339</span>
<span class='line-number'>2340</span>
<span class='line-number'>2341</span>
<span class='line-number'>2342</span>
<span class='line-number'>2343</span>
<span class='line-number'>2344</span>
<span class='line-number'>2345</span>
<span class='line-number'>2346</span>
<span class='line-number'>2347</span>
<span class='line-number'>2348</span>
<span class='line-number'>2349</span>
<span class='line-number'>2350</span>
<span class='line-number'>2351</span>
<span class='line-number'>2352</span>
<span class='line-number'>2353</span>
<span class='line-number'>2354</span>
<span class='line-number'>2355</span>
<span class='line-number'>2356</span>
<span class='line-number'>2357</span>
<span class='line-number'>2358</span>
<span class='line-number'>2359</span>
<span class='line-number'>2360</span>
<span class='line-number'>2361</span>
<span class='line-number'>2362</span>
<span class='line-number'>2363</span>
<span class='line-number'>2364</span>
<span class='line-number'>2365</span>
<span class='line-number'>2366</span>
<span class='line-number'>2367</span>
<span class='line-number'>2368</span>
<span class='line-number'>2369</span>
<span class='line-number'>2370</span>
<span class='line-number'>2371</span>
<span class='line-number'>2372</span>
<span class='line-number'>2373</span>
<span class='line-number'>2374</span>
<span class='line-number'>2375</span>
<span class='line-number'>2376</span>
<span class='line-number'>2377</span>
<span class='line-number'>2378</span>
<span class='line-number'>2379</span>
<span class='line-number'>2380</span>
<span class='line-number'>2381</span>
<span class='line-number'>2382</span>
<span class='line-number'>2383</span>
<span class='line-number'>2384</span>
<span class='line-number'>2385</span>
<span class='line-number'>2386</span>
<span class='line-number'>2387</span>
<span class='line-number'>2388</span>
<span class='line-number'>2389</span>
<span class='line-number'>2390</span>
<span class='line-number'>2391</span>
<span class='line-number'>2392</span>
<span class='line-number'>2393</span>
<span class='line-number'>2394</span>
<span class='line-number'>2395</span>
<span class='line-number'>2396</span>
<span class='line-number'>2397</span>
<span class='line-number'>2398</span>
<span class='line-number'>2399</span>
<span class='line-number'>2400</span>
<span class='line-number'>2401</span>
<span class='line-number'>2402</span>
<span class='line-number'>2403</span>
<span class='line-number'>2404</span>
<span class='line-number'>2405</span>
<span class='line-number'>2406</span>
<span class='line-number'>2407</span>
<span class='line-number'>2408</span>
<span class='line-number'>2409</span>
<span class='line-number'>2410</span>
<span class='line-number'>2411</span>
<span class='line-number'>2412</span>
<span class='line-number'>2413</span>
<span class='line-number'>2414</span>
<span class='line-number'>2415</span>
<span class='line-number'>2416</span>
<span class='line-number'>2417</span>
<span class='line-number'>2418</span>
<span class='line-number'>2419</span>
<span class='line-number'>2420</span>
<span class='line-number'>2421</span>
<span class='line-number'>2422</span>
<span class='line-number'>2423</span>
<span class='line-number'>2424</span>
<span class='line-number'>2425</span>
<span class='line-number'>2426</span>
<span class='line-number'>2427</span>
<span class='line-number'>2428</span>
<span class='line-number'>2429</span>
<span class='line-number'>2430</span>
<span class='line-number'>2431</span>
<span class='line-number'>2432</span>
<span class='line-number'>2433</span>
<span class='line-number'>2434</span>
<span class='line-number'>2435</span>
<span class='line-number'>2436</span>
<span class='line-number'>2437</span>
<span class='line-number'>2438</span>
<span class='line-number'>2439</span>
<span class='line-number'>2440</span>
<span class='line-number'>2441</span>
<span class='line-number'>2442</span>
<span class='line-number'>2443</span>
<span class='line-number'>2444</span>
<span class='line-number'>2445</span>
<span class='line-number'>2446</span>
<span class='line-number'>2447</span>
<span class='line-number'>2448</span>
<span class='line-number'>2449</span>
<span class='line-number'>2450</span>
<span class='line-number'>2451</span>
<span class='line-number'>2452</span>
<span class='line-number'>2453</span>
<span class='line-number'>2454</span>
<span class='line-number'>2455</span>
<span class='line-number'>2456</span>
<span class='line-number'>2457</span>
<span class='line-number'>2458</span>
<span class='line-number'>2459</span>
<span class='line-number'>2460</span>
<span class='line-number'>2461</span>
<span class='line-number'>2462</span>
<span class='line-number'>2463</span>
<span class='line-number'>2464</span>
<span class='line-number'>2465</span>
<span class='line-number'>2466</span>
<span class='line-number'>2467</span>
<span class='line-number'>2468</span>
<span class='line-number'>2469</span>
<span class='line-number'>2470</span>
<span class='line-number'>2471</span>
<span class='line-number'>2472</span>
<span class='line-number'>2473</span>
<span class='line-number'>2474</span>
<span class='line-number'>2475</span>
<span class='line-number'>2476</span>
<span class='line-number'>2477</span>
<span class='line-number'>2478</span>
<span class='line-number'>2479</span>
<span class='line-number'>2480</span>
<span class='line-number'>2481</span>
<span class='line-number'>2482</span>
<span class='line-number'>2483</span>
<span class='line-number'>2484</span>
<span class='line-number'>2485</span>
<span class='line-number'>2486</span>
<span class='line-number'>2487</span>
<span class='line-number'>2488</span>
<span class='line-number'>2489</span>
<span class='line-number'>2490</span>
<span class='line-number'>2491</span>
<span class='line-number'>2492</span>
<span class='line-number'>2493</span>
<span class='line-number'>2494</span>
<span class='line-number'>2495</span>
<span class='line-number'>2496</span>
<span class='line-number'>2497</span>
<span class='line-number'>2498</span>
<span class='line-number'>2499</span>
<span class='line-number'>2500</span>
<span class='line-number'>2501</span>
<span class='line-number'>2502</span>
<span class='line-number'>2503</span>
<span class='line-number'>2504</span>
<span class='line-number'>2505</span>
<span class='line-number'>2506</span>
<span class='line-number'>2507</span>
<span class='line-number'>2508</span>
<span class='line-number'>2509</span>
<span class='line-number'>2510</span>
<span class='line-number'>2511</span>
<span class='line-number'>2512</span>
<span class='line-number'>2513</span>
<span class='line-number'>2514</span>
<span class='line-number'>2515</span>
<span class='line-number'>2516</span>
<span class='line-number'>2517</span>
<span class='line-number'>2518</span>
<span class='line-number'>2519</span>
<span class='line-number'>2520</span>
<span class='line-number'>2521</span>
<span class='line-number'>2522</span>
<span class='line-number'>2523</span>
<span class='line-number'>2524</span>
<span class='line-number'>2525</span>
<span class='line-number'>2526</span>
<span class='line-number'>2527</span>
<span class='line-number'>2528</span>
<span class='line-number'>2529</span>
<span class='line-number'>2530</span>
<span class='line-number'>2531</span>
<span class='line-number'>2532</span>
<span class='line-number'>2533</span>
<span class='line-number'>2534</span>
<span class='line-number'>2535</span>
<span class='line-number'>2536</span>
<span class='line-number'>2537</span>
<span class='line-number'>2538</span>
<span class='line-number'>2539</span>
<span class='line-number'>2540</span>
<span class='line-number'>2541</span>
<span class='line-number'>2542</span>
<span class='line-number'>2543</span>
<span class='line-number'>2544</span>
<span class='line-number'>2545</span>
<span class='line-number'>2546</span>
<span class='line-number'>2547</span>
<span class='line-number'>2548</span>
<span class='line-number'>2549</span>
<span class='line-number'>2550</span>
<span class='line-number'>2551</span>
<span class='line-number'>2552</span>
<span class='line-number'>2553</span>
<span class='line-number'>2554</span>
<span class='line-number'>2555</span>
<span class='line-number'>2556</span>
<span class='line-number'>2557</span>
<span class='line-number'>2558</span>
<span class='line-number'>2559</span>
<span class='line-number'>2560</span>
<span class='line-number'>2561</span>
<span class='line-number'>2562</span>
<span class='line-number'>2563</span>
<span class='line-number'>2564</span>
<span class='line-number'>2565</span>
<span class='line-number'>2566</span>
<span class='line-number'>2567</span>
<span class='line-number'>2568</span>
<span class='line-number'>2569</span>
<span class='line-number'>2570</span>
<span class='line-number'>2571</span>
<span class='line-number'>2572</span>
<span class='line-number'>2573</span>
<span class='line-number'>2574</span>
<span class='line-number'>2575</span>
<span class='line-number'>2576</span>
<span class='line-number'>2577</span>
<span class='line-number'>2578</span>
<span class='line-number'>2579</span>
<span class='line-number'>2580</span>
<span class='line-number'>2581</span>
<span class='line-number'>2582</span>
<span class='line-number'>2583</span>
<span class='line-number'>2584</span>
<span class='line-number'>2585</span>
<span class='line-number'>2586</span>
<span class='line-number'>2587</span>
<span class='line-number'>2588</span>
<span class='line-number'>2589</span>
<span class='line-number'>2590</span>
<span class='line-number'>2591</span>
<span class='line-number'>2592</span>
<span class='line-number'>2593</span>
<span class='line-number'>2594</span>
<span class='line-number'>2595</span>
<span class='line-number'>2596</span>
<span class='line-number'>2597</span>
<span class='line-number'>2598</span>
<span class='line-number'>2599</span>
<span class='line-number'>2600</span>
<span class='line-number'>2601</span>
<span class='line-number'>2602</span>
<span class='line-number'>2603</span>
<span class='line-number'>2604</span>
<span class='line-number'>2605</span>
<span class='line-number'>2606</span>
<span class='line-number'>2607</span>
<span class='line-number'>2608</span>
<span class='line-number'>2609</span>
<span class='line-number'>2610</span>
<span class='line-number'>2611</span>
<span class='line-number'>2612</span>
<span class='line-number'>2613</span>
<span class='line-number'>2614</span>
<span class='line-number'>2615</span>
<span class='line-number'>2616</span>
<span class='line-number'>2617</span>
<span class='line-number'>2618</span>
<span class='line-number'>2619</span>
<span class='line-number'>2620</span>
<span class='line-number'>2621</span>
<span class='line-number'>2622</span>
<span class='line-number'>2623</span>
<span class='line-number'>2624</span>
<span class='line-number'>2625</span>
<span class='line-number'>2626</span>
<span class='line-number'>2627</span>
<span class='line-number'>2628</span>
<span class='line-number'>2629</span>
<span class='line-number'>2630</span>
<span class='line-number'>2631</span>
<span class='line-number'>2632</span>
<span class='line-number'>2633</span>
<span class='line-number'>2634</span>
<span class='line-number'>2635</span>
<span class='line-number'>2636</span>
<span class='line-number'>2637</span>
<span class='line-number'>2638</span>
<span class='line-number'>2639</span>
<span class='line-number'>2640</span>
<span class='line-number'>2641</span>
<span class='line-number'>2642</span>
<span class='line-number'>2643</span>
<span class='line-number'>2644</span>
<span class='line-number'>2645</span>
<span class='line-number'>2646</span>
<span class='line-number'>2647</span>
<span class='line-number'>2648</span>
<span class='line-number'>2649</span>
<span class='line-number'>2650</span>
<span class='line-number'>2651</span>
<span class='line-number'>2652</span>
<span class='line-number'>2653</span>
<span class='line-number'>2654</span>
<span class='line-number'>2655</span>
<span class='line-number'>2656</span>
<span class='line-number'>2657</span>
<span class='line-number'>2658</span>
<span class='line-number'>2659</span>
<span class='line-number'>2660</span>
<span class='line-number'>2661</span>
<span class='line-number'>2662</span>
<span class='line-number'>2663</span>
<span class='line-number'>2664</span>
<span class='line-number'>2665</span>
<span class='line-number'>2666</span>
<span class='line-number'>2667</span>
<span class='line-number'>2668</span>
<span class='line-number'>2669</span>
<span class='line-number'>2670</span>
<span class='line-number'>2671</span>
<span class='line-number'>2672</span>
<span class='line-number'>2673</span>
<span class='line-number'>2674</span>
<span class='line-number'>2675</span>
<span class='line-number'>2676</span>
<span class='line-number'>2677</span>
<span class='line-number'>2678</span>
<span class='line-number'>2679</span>
<span class='line-number'>2680</span>
<span class='line-number'>2681</span>
<span class='line-number'>2682</span>
<span class='line-number'>2683</span>
<span class='line-number'>2684</span>
<span class='line-number'>2685</span>
<span class='line-number'>2686</span>
<span class='line-number'>2687</span>
<span class='line-number'>2688</span>
<span class='line-number'>2689</span>
<span class='line-number'>2690</span>
<span class='line-number'>2691</span>
<span class='line-number'>2692</span>
<span class='line-number'>2693</span>
<span class='line-number'>2694</span>
<span class='line-number'>2695</span>
<span class='line-number'>2696</span>
<span class='line-number'>2697</span>
<span class='line-number'>2698</span>
<span class='line-number'>2699</span>
<span class='line-number'>2700</span>
<span class='line-number'>2701</span>
<span class='line-number'>2702</span>
<span class='line-number'>2703</span>
<span class='line-number'>2704</span>
<span class='line-number'>2705</span>
<span class='line-number'>2706</span>
<span class='line-number'>2707</span>
<span class='line-number'>2708</span>
<span class='line-number'>2709</span>
<span class='line-number'>2710</span>
<span class='line-number'>2711</span>
<span class='line-number'>2712</span>
<span class='line-number'>2713</span>
<span class='line-number'>2714</span>
<span class='line-number'>2715</span>
<span class='line-number'>2716</span>
<span class='line-number'>2717</span>
<span class='line-number'>2718</span>
<span class='line-number'>2719</span>
<span class='line-number'>2720</span>
<span class='line-number'>2721</span>
<span class='line-number'>2722</span>
<span class='line-number'>2723</span>
<span class='line-number'>2724</span>
<span class='line-number'>2725</span>
<span class='line-number'>2726</span>
<span class='line-number'>2727</span>
<span class='line-number'>2728</span>
<span class='line-number'>2729</span>
<span class='line-number'>2730</span>
<span class='line-number'>2731</span>
<span class='line-number'>2732</span>
<span class='line-number'>2733</span>
<span class='line-number'>2734</span>
<span class='line-number'>2735</span>
<span class='line-number'>2736</span>
<span class='line-number'>2737</span>
<span class='line-number'>2738</span>
<span class='line-number'>2739</span>
<span class='line-number'>2740</span>
<span class='line-number'>2741</span>
<span class='line-number'>2742</span>
<span class='line-number'>2743</span>
<span class='line-number'>2744</span>
<span class='line-number'>2745</span>
<span class='line-number'>2746</span>
<span class='line-number'>2747</span>
<span class='line-number'>2748</span>
<span class='line-number'>2749</span>
<span class='line-number'>2750</span>
<span class='line-number'>2751</span>
<span class='line-number'>2752</span>
<span class='line-number'>2753</span>
<span class='line-number'>2754</span>
<span class='line-number'>2755</span>
<span class='line-number'>2756</span>
<span class='line-number'>2757</span>
<span class='line-number'>2758</span>
<span class='line-number'>2759</span>
<span class='line-number'>2760</span>
<span class='line-number'>2761</span>
<span class='line-number'>2762</span>
<span class='line-number'>2763</span>
<span class='line-number'>2764</span>
<span class='line-number'>2765</span>
<span class='line-number'>2766</span>
<span class='line-number'>2767</span>
<span class='line-number'>2768</span>
<span class='line-number'>2769</span>
<span class='line-number'>2770</span>
<span class='line-number'>2771</span>
<span class='line-number'>2772</span>
<span class='line-number'>2773</span>
<span class='line-number'>2774</span>
<span class='line-number'>2775</span>
<span class='line-number'>2776</span>
<span class='line-number'>2777</span>
<span class='line-number'>2778</span>
<span class='line-number'>2779</span>
<span class='line-number'>2780</span>
<span class='line-number'>2781</span>
<span class='line-number'>2782</span>
<span class='line-number'>2783</span>
<span class='line-number'>2784</span>
<span class='line-number'>2785</span>
<span class='line-number'>2786</span>
<span class='line-number'>2787</span>
<span class='line-number'>2788</span>
<span class='line-number'>2789</span>
<span class='line-number'>2790</span>
<span class='line-number'>2791</span>
<span class='line-number'>2792</span>
<span class='line-number'>2793</span>
<span class='line-number'>2794</span>
<span class='line-number'>2795</span>
<span class='line-number'>2796</span>
<span class='line-number'>2797</span>
<span class='line-number'>2798</span>
<span class='line-number'>2799</span>
<span class='line-number'>2800</span>
<span class='line-number'>2801</span>
<span class='line-number'>2802</span>
<span class='line-number'>2803</span>
<span class='line-number'>2804</span>
<span class='line-number'>2805</span>
<span class='line-number'>2806</span>
<span class='line-number'>2807</span>
<span class='line-number'>2808</span>
<span class='line-number'>2809</span>
<span class='line-number'>2810</span>
<span class='line-number'>2811</span>
<span class='line-number'>2812</span>
<span class='line-number'>2813</span>
<span class='line-number'>2814</span>
<span class='line-number'>2815</span>
<span class='line-number'>2816</span>
<span class='line-number'>2817</span>
<span class='line-number'>2818</span>
<span class='line-number'>2819</span>
<span class='line-number'>2820</span>
<span class='line-number'>2821</span>
<span class='line-number'>2822</span>
<span class='line-number'>2823</span>
<span class='line-number'>2824</span>
<span class='line-number'>2825</span>
<span class='line-number'>2826</span>
<span class='line-number'>2827</span>
<span class='line-number'>2828</span>
<span class='line-number'>2829</span>
<span class='line-number'>2830</span>
<span class='line-number'>2831</span>
<span class='line-number'>2832</span>
<span class='line-number'>2833</span>
<span class='line-number'>2834</span>
<span class='line-number'>2835</span>
<span class='line-number'>2836</span>
<span class='line-number'>2837</span>
<span class='line-number'>2838</span>
<span class='line-number'>2839</span>
<span class='line-number'>2840</span>
<span class='line-number'>2841</span>
<span class='line-number'>2842</span>
<span class='line-number'>2843</span>
<span class='line-number'>2844</span>
<span class='line-number'>2845</span>
<span class='line-number'>2846</span>
<span class='line-number'>2847</span>
<span class='line-number'>2848</span>
<span class='line-number'>2849</span>
<span class='line-number'>2850</span>
<span class='line-number'>2851</span>
<span class='line-number'>2852</span>
<span class='line-number'>2853</span>
<span class='line-number'>2854</span>
<span class='line-number'>2855</span>
<span class='line-number'>2856</span>
<span class='line-number'>2857</span>
<span class='line-number'>2858</span>
<span class='line-number'>2859</span>
<span class='line-number'>2860</span>
<span class='line-number'>2861</span>
<span class='line-number'>2862</span>
<span class='line-number'>2863</span>
<span class='line-number'>2864</span>
<span class='line-number'>2865</span>
<span class='line-number'>2866</span>
<span class='line-number'>2867</span>
<span class='line-number'>2868</span>
<span class='line-number'>2869</span>
<span class='line-number'>2870</span>
<span class='line-number'>2871</span>
<span class='line-number'>2872</span>
<span class='line-number'>2873</span>
<span class='line-number'>2874</span>
<span class='line-number'>2875</span>
<span class='line-number'>2876</span>
<span class='line-number'>2877</span>
<span class='line-number'>2878</span>
<span class='line-number'>2879</span>
<span class='line-number'>2880</span>
<span class='line-number'>2881</span>
<span class='line-number'>2882</span>
<span class='line-number'>2883</span>
<span class='line-number'>2884</span>
<span class='line-number'>2885</span>
<span class='line-number'>2886</span>
<span class='line-number'>2887</span>
<span class='line-number'>2888</span>
<span class='line-number'>2889</span>
<span class='line-number'>2890</span>
<span class='line-number'>2891</span>
<span class='line-number'>2892</span>
<span class='line-number'>2893</span>
<span class='line-number'>2894</span>
<span class='line-number'>2895</span>
<span class='line-number'>2896</span>
<span class='line-number'>2897</span>
<span class='line-number'>2898</span>
<span class='line-number'>2899</span>
<span class='line-number'>2900</span>
<span class='line-number'>2901</span>
<span class='line-number'>2902</span>
<span class='line-number'>2903</span>
<span class='line-number'>2904</span>
<span class='line-number'>2905</span>
<span class='line-number'>2906</span>
<span class='line-number'>2907</span>
<span class='line-number'>2908</span>
<span class='line-number'>2909</span>
<span class='line-number'>2910</span>
<span class='line-number'>2911</span>
<span class='line-number'>2912</span>
<span class='line-number'>2913</span>
<span class='line-number'>2914</span>
<span class='line-number'>2915</span>
<span class='line-number'>2916</span>
<span class='line-number'>2917</span>
<span class='line-number'>2918</span>
<span class='line-number'>2919</span>
<span class='line-number'>2920</span>
<span class='line-number'>2921</span>
<span class='line-number'>2922</span>
<span class='line-number'>2923</span>
<span class='line-number'>2924</span>
<span class='line-number'>2925</span>
<span class='line-number'>2926</span>
<span class='line-number'>2927</span>
<span class='line-number'>2928</span>
<span class='line-number'>2929</span>
<span class='line-number'>2930</span>
<span class='line-number'>2931</span>
<span class='line-number'>2932</span>
<span class='line-number'>2933</span>
<span class='line-number'>2934</span>
<span class='line-number'>2935</span>
<span class='line-number'>2936</span>
<span class='line-number'>2937</span>
<span class='line-number'>2938</span>
<span class='line-number'>2939</span>
<span class='line-number'>2940</span>
<span class='line-number'>2941</span>
<span class='line-number'>2942</span>
<span class='line-number'>2943</span>
<span class='line-number'>2944</span>
<span class='line-number'>2945</span>
<span class='line-number'>2946</span>
<span class='line-number'>2947</span>
<span class='line-number'>2948</span>
<span class='line-number'>2949</span>
<span class='line-number'>2950</span>
<span class='line-number'>2951</span>
<span class='line-number'>2952</span>
<span class='line-number'>2953</span>
<span class='line-number'>2954</span>
<span class='line-number'>2955</span>
<span class='line-number'>2956</span>
<span class='line-number'>2957</span>
<span class='line-number'>2958</span>
<span class='line-number'>2959</span>
<span class='line-number'>2960</span>
<span class='line-number'>2961</span>
<span class='line-number'>2962</span>
<span class='line-number'>2963</span>
<span class='line-number'>2964</span>
<span class='line-number'>2965</span>
<span class='line-number'>2966</span>
<span class='line-number'>2967</span>
<span class='line-number'>2968</span>
<span class='line-number'>2969</span>
<span class='line-number'>2970</span>
<span class='line-number'>2971</span>
<span class='line-number'>2972</span>
<span class='line-number'>2973</span>
<span class='line-number'>2974</span>
<span class='line-number'>2975</span>
<span class='line-number'>2976</span>
<span class='line-number'>2977</span>
<span class='line-number'>2978</span>
<span class='line-number'>2979</span>
<span class='line-number'>2980</span>
<span class='line-number'>2981</span>
<span class='line-number'>2982</span>
<span class='line-number'>2983</span>
<span class='line-number'>2984</span>
<span class='line-number'>2985</span>
<span class='line-number'>2986</span>
<span class='line-number'>2987</span>
<span class='line-number'>2988</span>
<span class='line-number'>2989</span>
<span class='line-number'>2990</span>
<span class='line-number'>2991</span>
<span class='line-number'>2992</span>
<span class='line-number'>2993</span>
<span class='line-number'>2994</span>
<span class='line-number'>2995</span>
<span class='line-number'>2996</span>
<span class='line-number'>2997</span>
<span class='line-number'>2998</span>
<span class='line-number'>2999</span>
<span class='line-number'>3000</span>
<span class='line-number'>3001</span>
<span class='line-number'>3002</span>
<span class='line-number'>3003</span>
<span class='line-number'>3004</span>
<span class='line-number'>3005</span>
<span class='line-number'>3006</span>
<span class='line-number'>3007</span>
<span class='line-number'>3008</span>
<span class='line-number'>3009</span>
<span class='line-number'>3010</span>
<span class='line-number'>3011</span>
<span class='line-number'>3012</span>
<span class='line-number'>3013</span>
<span class='line-number'>3014</span>
<span class='line-number'>3015</span>
<span class='line-number'>3016</span>
<span class='line-number'>3017</span>
<span class='line-number'>3018</span>
<span class='line-number'>3019</span>
<span class='line-number'>3020</span>
<span class='line-number'>3021</span>
<span class='line-number'>3022</span>
<span class='line-number'>3023</span>
<span class='line-number'>3024</span>
<span class='line-number'>3025</span>
<span class='line-number'>3026</span>
<span class='line-number'>3027</span>
<span class='line-number'>3028</span>
<span class='line-number'>3029</span>
<span class='line-number'>3030</span>
<span class='line-number'>3031</span>
<span class='line-number'>3032</span>
<span class='line-number'>3033</span>
<span class='line-number'>3034</span>
<span class='line-number'>3035</span>
<span class='line-number'>3036</span>
<span class='line-number'>3037</span>
<span class='line-number'>3038</span>
<span class='line-number'>3039</span>
<span class='line-number'>3040</span>
<span class='line-number'>3041</span>
<span class='line-number'>3042</span>
<span class='line-number'>3043</span>
<span class='line-number'>3044</span>
<span class='line-number'>3045</span>
<span class='line-number'>3046</span>
<span class='line-number'>3047</span>
<span class='line-number'>3048</span>
<span class='line-number'>3049</span>
<span class='line-number'>3050</span>
<span class='line-number'>3051</span>
<span class='line-number'>3052</span>
<span class='line-number'>3053</span>
<span class='line-number'>3054</span>
<span class='line-number'>3055</span>
<span class='line-number'>3056</span>
<span class='line-number'>3057</span>
<span class='line-number'>3058</span>
<span class='line-number'>3059</span>
<span class='line-number'>3060</span>
<span class='line-number'>3061</span>
<span class='line-number'>3062</span>
<span class='line-number'>3063</span>
<span class='line-number'>3064</span>
<span class='line-number'>3065</span>
<span class='line-number'>3066</span>
<span class='line-number'>3067</span>
<span class='line-number'>3068</span>
<span class='line-number'>3069</span>
<span class='line-number'>3070</span>
<span class='line-number'>3071</span>
<span class='line-number'>3072</span>
<span class='line-number'>3073</span>
<span class='line-number'>3074</span>
<span class='line-number'>3075</span>
<span class='line-number'>3076</span>
<span class='line-number'>3077</span>
<span class='line-number'>3078</span>
<span class='line-number'>3079</span>
<span class='line-number'>3080</span>
<span class='line-number'>3081</span>
<span class='line-number'>3082</span>
<span class='line-number'>3083</span>
<span class='line-number'>3084</span>
<span class='line-number'>3085</span>
<span class='line-number'>3086</span>
<span class='line-number'>3087</span>
<span class='line-number'>3088</span>
<span class='line-number'>3089</span>
<span class='line-number'>3090</span>
<span class='line-number'>3091</span>
<span class='line-number'>3092</span>
<span class='line-number'>3093</span>
<span class='line-number'>3094</span>
<span class='line-number'>3095</span>
<span class='line-number'>3096</span>
<span class='line-number'>3097</span>
<span class='line-number'>3098</span>
<span class='line-number'>3099</span>
<span class='line-number'>3100</span>
<span class='line-number'>3101</span>
<span class='line-number'>3102</span>
<span class='line-number'>3103</span>
<span class='line-number'>3104</span>
<span class='line-number'>3105</span>
<span class='line-number'>3106</span>
<span class='line-number'>3107</span>
<span class='line-number'>3108</span>
<span class='line-number'>3109</span>
<span class='line-number'>3110</span>
<span class='line-number'>3111</span>
<span class='line-number'>3112</span>
<span class='line-number'>3113</span>
<span class='line-number'>3114</span>
<span class='line-number'>3115</span>
<span class='line-number'>3116</span>
<span class='line-number'>3117</span>
<span class='line-number'>3118</span>
<span class='line-number'>3119</span>
<span class='line-number'>3120</span>
<span class='line-number'>3121</span>
<span class='line-number'>3122</span>
<span class='line-number'>3123</span>
<span class='line-number'>3124</span>
<span class='line-number'>3125</span>
<span class='line-number'>3126</span>
<span class='line-number'>3127</span>
<span class='line-number'>3128</span>
<span class='line-number'>3129</span>
<span class='line-number'>3130</span>
<span class='line-number'>3131</span>
<span class='line-number'>3132</span>
<span class='line-number'>3133</span>
<span class='line-number'>3134</span>
<span class='line-number'>3135</span>
<span class='line-number'>3136</span>
<span class='line-number'>3137</span>
<span class='line-number'>3138</span>
<span class='line-number'>3139</span>
<span class='line-number'>3140</span>
<span class='line-number'>3141</span>
<span class='line-number'>3142</span>
<span class='line-number'>3143</span>
<span class='line-number'>3144</span>
<span class='line-number'>3145</span>
<span class='line-number'>3146</span>
<span class='line-number'>3147</span>
<span class='line-number'>3148</span>
<span class='line-number'>3149</span>
<span class='line-number'>3150</span>
<span class='line-number'>3151</span>
<span class='line-number'>3152</span>
<span class='line-number'>3153</span>
<span class='line-number'>3154</span>
<span class='line-number'>3155</span>
<span class='line-number'>3156</span>
<span class='line-number'>3157</span>
<span class='line-number'>3158</span>
<span class='line-number'>3159</span>
<span class='line-number'>3160</span>
<span class='line-number'>3161</span>
<span class='line-number'>3162</span>
<span class='line-number'>3163</span>
<span class='line-number'>3164</span>
<span class='line-number'>3165</span>
<span class='line-number'>3166</span>
<span class='line-number'>3167</span>
<span class='line-number'>3168</span>
<span class='line-number'>3169</span>
<span class='line-number'>3170</span>
<span class='line-number'>3171</span>
<span class='line-number'>3172</span>
<span class='line-number'>3173</span>
<span class='line-number'>3174</span>
<span class='line-number'>3175</span>
<span class='line-number'>3176</span>
<span class='line-number'>3177</span>
<span class='line-number'>3178</span>
<span class='line-number'>3179</span>
<span class='line-number'>3180</span>
<span class='line-number'>3181</span>
<span class='line-number'>3182</span>
<span class='line-number'>3183</span>
<span class='line-number'>3184</span>
<span class='line-number'>3185</span>
<span class='line-number'>3186</span>
<span class='line-number'>3187</span>
<span class='line-number'>3188</span>
<span class='line-number'>3189</span>
<span class='line-number'>3190</span>
<span class='line-number'>3191</span>
<span class='line-number'>3192</span>
<span class='line-number'>3193</span>
<span class='line-number'>3194</span>
<span class='line-number'>3195</span>
<span class='line-number'>3196</span>
<span class='line-number'>3197</span>
<span class='line-number'>3198</span>
<span class='line-number'>3199</span>
<span class='line-number'>3200</span>
<span class='line-number'>3201</span>
<span class='line-number'>3202</span>
<span class='line-number'>3203</span>
<span class='line-number'>3204</span>
<span class='line-number'>3205</span>
<span class='line-number'>3206</span>
<span class='line-number'>3207</span>
<span class='line-number'>3208</span>
<span class='line-number'>3209</span>
<span class='line-number'>3210</span>
<span class='line-number'>3211</span>
<span class='line-number'>3212</span>
<span class='line-number'>3213</span>
<span class='line-number'>3214</span>
<span class='line-number'>3215</span>
<span class='line-number'>3216</span>
<span class='line-number'>3217</span>
<span class='line-number'>3218</span>
<span class='line-number'>3219</span>
<span class='line-number'>3220</span>
<span class='line-number'>3221</span>
<span class='line-number'>3222</span>
<span class='line-number'>3223</span>
<span class='line-number'>3224</span>
<span class='line-number'>3225</span>
<span class='line-number'>3226</span>
<span class='line-number'>3227</span>
<span class='line-number'>3228</span>
<span class='line-number'>3229</span>
<span class='line-number'>3230</span>
<span class='line-number'>3231</span>
<span class='line-number'>3232</span>
<span class='line-number'>3233</span>
<span class='line-number'>3234</span>
<span class='line-number'>3235</span>
<span class='line-number'>3236</span>
<span class='line-number'>3237</span>
<span class='line-number'>3238</span>
<span class='line-number'>3239</span>
<span class='line-number'>3240</span>
<span class='line-number'>3241</span>
<span class='line-number'>3242</span>
<span class='line-number'>3243</span>
<span class='line-number'>3244</span>
<span class='line-number'>3245</span>
<span class='line-number'>3246</span>
<span class='line-number'>3247</span>
<span class='line-number'>3248</span>
<span class='line-number'>3249</span>
<span class='line-number'>3250</span>
<span class='line-number'>3251</span>
<span class='line-number'>3252</span>
<span class='line-number'>3253</span>
<span class='line-number'>3254</span>
<span class='line-number'>3255</span>
<span class='line-number'>3256</span>
<span class='line-number'>3257</span>
<span class='line-number'>3258</span>
<span class='line-number'>3259</span>
<span class='line-number'>3260</span>
<span class='line-number'>3261</span>
<span class='line-number'>3262</span>
<span class='line-number'>3263</span>
<span class='line-number'>3264</span>
<span class='line-number'>3265</span>
<span class='line-number'>3266</span>
<span class='line-number'>3267</span>
<span class='line-number'>3268</span>
<span class='line-number'>3269</span>
<span class='line-number'>3270</span>
<span class='line-number'>3271</span>
<span class='line-number'>3272</span>
<span class='line-number'>3273</span>
<span class='line-number'>3274</span>
<span class='line-number'>3275</span>
<span class='line-number'>3276</span>
<span class='line-number'>3277</span>
<span class='line-number'>3278</span>
<span class='line-number'>3279</span>
<span class='line-number'>3280</span>
<span class='line-number'>3281</span>
<span class='line-number'>3282</span>
<span class='line-number'>3283</span>
<span class='line-number'>3284</span>
<span class='line-number'>3285</span>
<span class='line-number'>3286</span>
<span class='line-number'>3287</span>
<span class='line-number'>3288</span>
<span class='line-number'>3289</span>
<span class='line-number'>3290</span>
<span class='line-number'>3291</span>
<span class='line-number'>3292</span>
<span class='line-number'>3293</span>
<span class='line-number'>3294</span>
<span class='line-number'>3295</span>
<span class='line-number'>3296</span>
<span class='line-number'>3297</span>
<span class='line-number'>3298</span>
<span class='line-number'>3299</span>
<span class='line-number'>3300</span>
<span class='line-number'>3301</span>
<span class='line-number'>3302</span>
<span class='line-number'>3303</span>
<span class='line-number'>3304</span>
<span class='line-number'>3305</span>
<span class='line-number'>3306</span>
<span class='line-number'>3307</span>
<span class='line-number'>3308</span>
<span class='line-number'>3309</span>
<span class='line-number'>3310</span>
<span class='line-number'>3311</span>
<span class='line-number'>3312</span>
<span class='line-number'>3313</span>
<span class='line-number'>3314</span>
<span class='line-number'>3315</span>
<span class='line-number'>3316</span>
<span class='line-number'>3317</span>
<span class='line-number'>3318</span>
<span class='line-number'>3319</span>
<span class='line-number'>3320</span>
<span class='line-number'>3321</span>
<span class='line-number'>3322</span>
<span class='line-number'>3323</span>
<span class='line-number'>3324</span>
<span class='line-number'>3325</span>
<span class='line-number'>3326</span>
<span class='line-number'>3327</span>
<span class='line-number'>3328</span>
<span class='line-number'>3329</span>
<span class='line-number'>3330</span>
<span class='line-number'>3331</span>
<span class='line-number'>3332</span>
<span class='line-number'>3333</span>
<span class='line-number'>3334</span>
<span class='line-number'>3335</span>
<span class='line-number'>3336</span>
<span class='line-number'>3337</span>
<span class='line-number'>3338</span>
<span class='line-number'>3339</span>
<span class='line-number'>3340</span>
<span class='line-number'>3341</span>
<span class='line-number'>3342</span>
<span class='line-number'>3343</span>
<span class='line-number'>3344</span>
<span class='line-number'>3345</span>
<span class='line-number'>3346</span>
<span class='line-number'>3347</span>
<span class='line-number'>3348</span>
<span class='line-number'>3349</span>
<span class='line-number'>3350</span>
<span class='line-number'>3351</span>
<span class='line-number'>3352</span>
<span class='line-number'>3353</span>
<span class='line-number'>3354</span>
<span class='line-number'>3355</span>
<span class='line-number'>3356</span>
<span class='line-number'>3357</span>
<span class='line-number'>3358</span>
<span class='line-number'>3359</span>
<span class='line-number'>3360</span>
<span class='line-number'>3361</span>
<span class='line-number'>3362</span>
<span class='line-number'>3363</span>
<span class='line-number'>3364</span>
<span class='line-number'>3365</span>
<span class='line-number'>3366</span>
<span class='line-number'>3367</span>
<span class='line-number'>3368</span>
<span class='line-number'>3369</span>
<span class='line-number'>3370</span>
<span class='line-number'>3371</span>
<span class='line-number'>3372</span>
<span class='line-number'>3373</span>
<span class='line-number'>3374</span>
<span class='line-number'>3375</span>
<span class='line-number'>3376</span>
<span class='line-number'>3377</span>
<span class='line-number'>3378</span>
<span class='line-number'>3379</span>
<span class='line-number'>3380</span>
<span class='line-number'>3381</span>
<span class='line-number'>3382</span>
<span class='line-number'>3383</span>
<span class='line-number'>3384</span>
<span class='line-number'>3385</span>
<span class='line-number'>3386</span>
<span class='line-number'>3387</span>
<span class='line-number'>3388</span>
<span class='line-number'>3389</span>
<span class='line-number'>3390</span>
<span class='line-number'>3391</span>
<span class='line-number'>3392</span>
<span class='line-number'>3393</span>
<span class='line-number'>3394</span>
<span class='line-number'>3395</span>
<span class='line-number'>3396</span>
<span class='line-number'>3397</span>
<span class='line-number'>3398</span>
<span class='line-number'>3399</span>
<span class='line-number'>3400</span>
<span class='line-number'>3401</span>
<span class='line-number'>3402</span>
<span class='line-number'>3403</span>
<span class='line-number'>3404</span>
<span class='line-number'>3405</span>
<span class='line-number'>3406</span>
<span class='line-number'>3407</span>
<span class='line-number'>3408</span>
<span class='line-number'>3409</span>
<span class='line-number'>3410</span>
<span class='line-number'>3411</span>
<span class='line-number'>3412</span>
<span class='line-number'>3413</span>
<span class='line-number'>3414</span>
<span class='line-number'>3415</span>
<span class='line-number'>3416</span>
<span class='line-number'>3417</span>
<span class='line-number'>3418</span>
<span class='line-number'>3419</span>
<span class='line-number'>3420</span>
<span class='line-number'>3421</span>
<span class='line-number'>3422</span>
<span class='line-number'>3423</span>
<span class='line-number'>3424</span>
<span class='line-number'>3425</span>
<span class='line-number'>3426</span>
<span class='line-number'>3427</span>
<span class='line-number'>3428</span>
<span class='line-number'>3429</span>
<span class='line-number'>3430</span>
<span class='line-number'>3431</span>
<span class='line-number'>3432</span>
<span class='line-number'>3433</span>
<span class='line-number'>3434</span>
<span class='line-number'>3435</span>
<span class='line-number'>3436</span>
<span class='line-number'>3437</span>
<span class='line-number'>3438</span>
<span class='line-number'>3439</span>
<span class='line-number'>3440</span>
<span class='line-number'>3441</span>
<span class='line-number'>3442</span>
<span class='line-number'>3443</span>
<span class='line-number'>3444</span>
<span class='line-number'>3445</span>
<span class='line-number'>3446</span>
<span class='line-number'>3447</span>
<span class='line-number'>3448</span>
<span class='line-number'>3449</span>
<span class='line-number'>3450</span>
<span class='line-number'>3451</span>
<span class='line-number'>3452</span>
<span class='line-number'>3453</span>
<span class='line-number'>3454</span>
<span class='line-number'>3455</span>
<span class='line-number'>3456</span>
<span class='line-number'>3457</span>
<span class='line-number'>3458</span>
<span class='line-number'>3459</span>
<span class='line-number'>3460</span>
<span class='line-number'>3461</span>
<span class='line-number'>3462</span>
<span class='line-number'>3463</span>
<span class='line-number'>3464</span>
<span class='line-number'>3465</span>
<span class='line-number'>3466</span>
<span class='line-number'>3467</span>
<span class='line-number'>3468</span>
<span class='line-number'>3469</span>
<span class='line-number'>3470</span>
<span class='line-number'>3471</span>
<span class='line-number'>3472</span>
<span class='line-number'>3473</span>
<span class='line-number'>3474</span>
<span class='line-number'>3475</span>
<span class='line-number'>3476</span>
<span class='line-number'>3477</span>
<span class='line-number'>3478</span>
<span class='line-number'>3479</span>
<span class='line-number'>3480</span>
<span class='line-number'>3481</span>
<span class='line-number'>3482</span>
<span class='line-number'>3483</span>
<span class='line-number'>3484</span>
<span class='line-number'>3485</span>
<span class='line-number'>3486</span>
<span class='line-number'>3487</span>
<span class='line-number'>3488</span>
<span class='line-number'>3489</span>
<span class='line-number'>3490</span>
<span class='line-number'>3491</span>
<span class='line-number'>3492</span>
<span class='line-number'>3493</span>
<span class='line-number'>3494</span>
<span class='line-number'>3495</span>
<span class='line-number'>3496</span>
<span class='line-number'>3497</span>
<span class='line-number'>3498</span>
<span class='line-number'>3499</span>
<span class='line-number'>3500</span>
<span class='line-number'>3501</span>
<span class='line-number'>3502</span>
<span class='line-number'>3503</span>
<span class='line-number'>3504</span>
<span class='line-number'>3505</span>
<span class='line-number'>3506</span>
<span class='line-number'>3507</span>
<span class='line-number'>3508</span>
<span class='line-number'>3509</span>
<span class='line-number'>3510</span>
<span class='line-number'>3511</span>
<span class='line-number'>3512</span>
<span class='line-number'>3513</span>
<span class='line-number'>3514</span>
<span class='line-number'>3515</span>
<span class='line-number'>3516</span>
<span class='line-number'>3517</span>
<span class='line-number'>3518</span>
<span class='line-number'>3519</span>
<span class='line-number'>3520</span>
<span class='line-number'>3521</span>
<span class='line-number'>3522</span>
<span class='line-number'>3523</span>
<span class='line-number'>3524</span>
<span class='line-number'>3525</span>
<span class='line-number'>3526</span>
<span class='line-number'>3527</span>
<span class='line-number'>3528</span>
<span class='line-number'>3529</span>
<span class='line-number'>3530</span>
<span class='line-number'>3531</span>
<span class='line-number'>3532</span>
<span class='line-number'>3533</span>
<span class='line-number'>3534</span>
<span class='line-number'>3535</span>
<span class='line-number'>3536</span>
<span class='line-number'>3537</span>
<span class='line-number'>3538</span>
<span class='line-number'>3539</span>
<span class='line-number'>3540</span>
<span class='line-number'>3541</span>
<span class='line-number'>3542</span>
<span class='line-number'>3543</span>
<span class='line-number'>3544</span>
<span class='line-number'>3545</span>
<span class='line-number'>3546</span>
<span class='line-number'>3547</span>
<span class='line-number'>3548</span>
<span class='line-number'>3549</span>
<span class='line-number'>3550</span>
<span class='line-number'>3551</span>
<span class='line-number'>3552</span>
<span class='line-number'>3553</span>
<span class='line-number'>3554</span>
<span class='line-number'>3555</span>
<span class='line-number'>3556</span>
<span class='line-number'>3557</span>
<span class='line-number'>3558</span>
<span class='line-number'>3559</span>
<span class='line-number'>3560</span>
<span class='line-number'>3561</span>
<span class='line-number'>3562</span>
<span class='line-number'>3563</span>
<span class='line-number'>3564</span>
<span class='line-number'>3565</span>
<span class='line-number'>3566</span>
<span class='line-number'>3567</span>
<span class='line-number'>3568</span>
<span class='line-number'>3569</span>
<span class='line-number'>3570</span>
<span class='line-number'>3571</span>
<span class='line-number'>3572</span>
<span class='line-number'>3573</span>
<span class='line-number'>3574</span>
<span class='line-number'>3575</span>
<span class='line-number'>3576</span>
<span class='line-number'>3577</span>
<span class='line-number'>3578</span>
<span class='line-number'>3579</span>
<span class='line-number'>3580</span>
<span class='line-number'>3581</span>
<span class='line-number'>3582</span>
<span class='line-number'>3583</span>
<span class='line-number'>3584</span>
<span class='line-number'>3585</span>
<span class='line-number'>3586</span>
<span class='line-number'>3587</span>
<span class='line-number'>3588</span>
<span class='line-number'>3589</span>
<span class='line-number'>3590</span>
<span class='line-number'>3591</span>
<span class='line-number'>3592</span>
<span class='line-number'>3593</span>
<span class='line-number'>3594</span>
<span class='line-number'>3595</span>
<span class='line-number'>3596</span>
<span class='line-number'>3597</span>
<span class='line-number'>3598</span>
<span class='line-number'>3599</span>
<span class='line-number'>3600</span>
<span class='line-number'>3601</span>
<span class='line-number'>3602</span>
<span class='line-number'>3603</span>
<span class='line-number'>3604</span>
<span class='line-number'>3605</span>
<span class='line-number'>3606</span>
<span class='line-number'>3607</span>
<span class='line-number'>3608</span>
<span class='line-number'>3609</span>
<span class='line-number'>3610</span>
<span class='line-number'>3611</span>
<span class='line-number'>3612</span>
<span class='line-number'>3613</span>
<span class='line-number'>3614</span>
<span class='line-number'>3615</span>
<span class='line-number'>3616</span>
<span class='line-number'>3617</span>
<span class='line-number'>3618</span>
<span class='line-number'>3619</span>
<span class='line-number'>3620</span>
<span class='line-number'>3621</span>
<span class='line-number'>3622</span>
<span class='line-number'>3623</span>
<span class='line-number'>3624</span>
<span class='line-number'>3625</span>
<span class='line-number'>3626</span>
<span class='line-number'>3627</span>
<span class='line-number'>3628</span>
<span class='line-number'>3629</span>
<span class='line-number'>3630</span>
<span class='line-number'>3631</span>
<span class='line-number'>3632</span>
<span class='line-number'>3633</span>
<span class='line-number'>3634</span>
<span class='line-number'>3635</span>
<span class='line-number'>3636</span>
<span class='line-number'>3637</span>
<span class='line-number'>3638</span>
<span class='line-number'>3639</span>
<span class='line-number'>3640</span>
<span class='line-number'>3641</span>
<span class='line-number'>3642</span>
<span class='line-number'>3643</span>
<span class='line-number'>3644</span>
<span class='line-number'>3645</span>
<span class='line-number'>3646</span>
<span class='line-number'>3647</span>
<span class='line-number'>3648</span>
<span class='line-number'>3649</span>
<span class='line-number'>3650</span>
<span class='line-number'>3651</span>
<span class='line-number'>3652</span>
<span class='line-number'>3653</span>
<span class='line-number'>3654</span>
<span class='line-number'>3655</span>
<span class='line-number'>3656</span>
<span class='line-number'>3657</span>
<span class='line-number'>3658</span>
<span class='line-number'>3659</span>
<span class='line-number'>3660</span>
<span class='line-number'>3661</span>
<span class='line-number'>3662</span>
<span class='line-number'>3663</span>
<span class='line-number'>3664</span>
<span class='line-number'>3665</span>
<span class='line-number'>3666</span>
<span class='line-number'>3667</span>
<span class='line-number'>3668</span>
<span class='line-number'>3669</span>
<span class='line-number'>3670</span>
<span class='line-number'>3671</span>
<span class='line-number'>3672</span>
<span class='line-number'>3673</span>
<span class='line-number'>3674</span>
<span class='line-number'>3675</span>
<span class='line-number'>3676</span>
<span class='line-number'>3677</span>
<span class='line-number'>3678</span>
<span class='line-number'>3679</span>
<span class='line-number'>3680</span>
<span class='line-number'>3681</span>
<span class='line-number'>3682</span>
<span class='line-number'>3683</span>
<span class='line-number'>3684</span>
<span class='line-number'>3685</span>
<span class='line-number'>3686</span>
<span class='line-number'>3687</span>
<span class='line-number'>3688</span>
<span class='line-number'>3689</span>
<span class='line-number'>3690</span>
<span class='line-number'>3691</span>
<span class='line-number'>3692</span>
<span class='line-number'>3693</span>
<span class='line-number'>3694</span>
<span class='line-number'>3695</span>
<span class='line-number'>3696</span>
<span class='line-number'>3697</span>
<span class='line-number'>3698</span>
<span class='line-number'>3699</span>
<span class='line-number'>3700</span>
<span class='line-number'>3701</span>
<span class='line-number'>3702</span>
<span class='line-number'>3703</span>
<span class='line-number'>3704</span>
<span class='line-number'>3705</span>
<span class='line-number'>3706</span>
<span class='line-number'>3707</span>
<span class='line-number'>3708</span>
<span class='line-number'>3709</span>
<span class='line-number'>3710</span>
<span class='line-number'>3711</span>
<span class='line-number'>3712</span>
<span class='line-number'>3713</span>
<span class='line-number'>3714</span>
<span class='line-number'>3715</span>
<span class='line-number'>3716</span>
<span class='line-number'>3717</span>
<span class='line-number'>3718</span>
<span class='line-number'>3719</span>
<span class='line-number'>3720</span>
<span class='line-number'>3721</span>
<span class='line-number'>3722</span>
<span class='line-number'>3723</span>
<span class='line-number'>3724</span>
<span class='line-number'>3725</span>
<span class='line-number'>3726</span>
<span class='line-number'>3727</span>
<span class='line-number'>3728</span>
<span class='line-number'>3729</span>
<span class='line-number'>3730</span>
<span class='line-number'>3731</span>
<span class='line-number'>3732</span>
<span class='line-number'>3733</span>
<span class='line-number'>3734</span>
<span class='line-number'>3735</span>
<span class='line-number'>3736</span>
<span class='line-number'>3737</span>
<span class='line-number'>3738</span>
<span class='line-number'>3739</span>
<span class='line-number'>3740</span>
<span class='line-number'>3741</span>
<span class='line-number'>3742</span>
<span class='line-number'>3743</span>
<span class='line-number'>3744</span>
<span class='line-number'>3745</span>
<span class='line-number'>3746</span>
<span class='line-number'>3747</span>
<span class='line-number'>3748</span>
<span class='line-number'>3749</span>
<span class='line-number'>3750</span>
<span class='line-number'>3751</span>
<span class='line-number'>3752</span>
<span class='line-number'>3753</span>
<span class='line-number'>3754</span>
<span class='line-number'>3755</span>
<span class='line-number'>3756</span>
<span class='line-number'>3757</span>
<span class='line-number'>3758</span>
<span class='line-number'>3759</span>
<span class='line-number'>3760</span>
<span class='line-number'>3761</span>
<span class='line-number'>3762</span>
<span class='line-number'>3763</span>
<span class='line-number'>3764</span>
<span class='line-number'>3765</span>
<span class='line-number'>3766</span>
<span class='line-number'>3767</span>
<span class='line-number'>3768</span>
<span class='line-number'>3769</span>
<span class='line-number'>3770</span>
<span class='line-number'>3771</span>
<span class='line-number'>3772</span>
<span class='line-number'>3773</span>
<span class='line-number'>3774</span>
<span class='line-number'>3775</span>
<span class='line-number'>3776</span>
<span class='line-number'>3777</span>
<span class='line-number'>3778</span>
<span class='line-number'>3779</span>
<span class='line-number'>3780</span>
<span class='line-number'>3781</span>
<span class='line-number'>3782</span>
<span class='line-number'>3783</span>
<span class='line-number'>3784</span>
<span class='line-number'>3785</span>
<span class='line-number'>3786</span>
<span class='line-number'>3787</span>
<span class='line-number'>3788</span>
<span class='line-number'>3789</span>
<span class='line-number'>3790</span>
<span class='line-number'>3791</span>
<span class='line-number'>3792</span>
<span class='line-number'>3793</span>
<span class='line-number'>3794</span>
<span class='line-number'>3795</span>
<span class='line-number'>3796</span>
<span class='line-number'>3797</span>
<span class='line-number'>3798</span>
<span class='line-number'>3799</span>
<span class='line-number'>3800</span>
<span class='line-number'>3801</span>
<span class='line-number'>3802</span>
<span class='line-number'>3803</span>
<span class='line-number'>3804</span>
<span class='line-number'>3805</span>
<span class='line-number'>3806</span>
<span class='line-number'>3807</span>
<span class='line-number'>3808</span>
<span class='line-number'>3809</span>
<span class='line-number'>3810</span>
<span class='line-number'>3811</span>
<span class='line-number'>3812</span>
<span class='line-number'>3813</span>
<span class='line-number'>3814</span>
<span class='line-number'>3815</span>
<span class='line-number'>3816</span>
<span class='line-number'>3817</span>
<span class='line-number'>3818</span>
<span class='line-number'>3819</span>
<span class='line-number'>3820</span>
<span class='line-number'>3821</span>
<span class='line-number'>3822</span>
<span class='line-number'>3823</span>
<span class='line-number'>3824</span>
<span class='line-number'>3825</span>
<span class='line-number'>3826</span>
<span class='line-number'>3827</span>
<span class='line-number'>3828</span>
<span class='line-number'>3829</span>
<span class='line-number'>3830</span>
<span class='line-number'>3831</span>
<span class='line-number'>3832</span>
<span class='line-number'>3833</span>
<span class='line-number'>3834</span>
<span class='line-number'>3835</span>
<span class='line-number'>3836</span>
<span class='line-number'>3837</span>
<span class='line-number'>3838</span>
<span class='line-number'>3839</span>
<span class='line-number'>3840</span>
<span class='line-number'>3841</span>
<span class='line-number'>3842</span>
<span class='line-number'>3843</span>
<span class='line-number'>3844</span>
<span class='line-number'>3845</span>
<span class='line-number'>3846</span>
<span class='line-number'>3847</span>
<span class='line-number'>3848</span>
<span class='line-number'>3849</span>
<span class='line-number'>3850</span>
<span class='line-number'>3851</span>
<span class='line-number'>3852</span>
<span class='line-number'>3853</span>
<span class='line-number'>3854</span>
<span class='line-number'>3855</span>
<span class='line-number'>3856</span>
<span class='line-number'>3857</span>
<span class='line-number'>3858</span>
<span class='line-number'>3859</span>
<span class='line-number'>3860</span>
<span class='line-number'>3861</span>
<span class='line-number'>3862</span>
<span class='line-number'>3863</span>
<span class='line-number'>3864</span>
<span class='line-number'>3865</span>
<span class='line-number'>3866</span>
<span class='line-number'>3867</span>
<span class='line-number'>3868</span>
<span class='line-number'>3869</span>
<span class='line-number'>3870</span>
<span class='line-number'>3871</span>
<span class='line-number'>3872</span>
<span class='line-number'>3873</span>
<span class='line-number'>3874</span>
<span class='line-number'>3875</span>
<span class='line-number'>3876</span>
<span class='line-number'>3877</span>
<span class='line-number'>3878</span>
<span class='line-number'>3879</span>
<span class='line-number'>3880</span>
<span class='line-number'>3881</span>
<span class='line-number'>3882</span>
<span class='line-number'>3883</span>
<span class='line-number'>3884</span>
<span class='line-number'>3885</span>
<span class='line-number'>3886</span>
<span class='line-number'>3887</span>
<span class='line-number'>3888</span>
<span class='line-number'>3889</span>
<span class='line-number'>3890</span>
<span class='line-number'>3891</span>
<span class='line-number'>3892</span>
<span class='line-number'>3893</span>
<span class='line-number'>3894</span>
<span class='line-number'>3895</span>
<span class='line-number'>3896</span>
<span class='line-number'>3897</span>
<span class='line-number'>3898</span>
<span class='line-number'>3899</span>
<span class='line-number'>3900</span>
<span class='line-number'>3901</span>
<span class='line-number'>3902</span>
<span class='line-number'>3903</span>
<span class='line-number'>3904</span>
<span class='line-number'>3905</span>
<span class='line-number'>3906</span>
<span class='line-number'>3907</span>
<span class='line-number'>3908</span>
<span class='line-number'>3909</span>
<span class='line-number'>3910</span>
<span class='line-number'>3911</span>
<span class='line-number'>3912</span>
<span class='line-number'>3913</span>
<span class='line-number'>3914</span>
<span class='line-number'>3915</span>
<span class='line-number'>3916</span>
<span class='line-number'>3917</span>
<span class='line-number'>3918</span>
<span class='line-number'>3919</span>
<span class='line-number'>3920</span>
<span class='line-number'>3921</span>
<span class='line-number'>3922</span>
<span class='line-number'>3923</span>
<span class='line-number'>3924</span>
<span class='line-number'>3925</span>
<span class='line-number'>3926</span>
<span class='line-number'>3927</span>
<span class='line-number'>3928</span>
<span class='line-number'>3929</span>
<span class='line-number'>3930</span>
<span class='line-number'>3931</span>
<span class='line-number'>3932</span>
<span class='line-number'>3933</span>
<span class='line-number'>3934</span>
<span class='line-number'>3935</span>
<span class='line-number'>3936</span>
<span class='line-number'>3937</span>
<span class='line-number'>3938</span>
<span class='line-number'>3939</span>
<span class='line-number'>3940</span>
<span class='line-number'>3941</span>
<span class='line-number'>3942</span>
<span class='line-number'>3943</span>
<span class='line-number'>3944</span>
<span class='line-number'>3945</span>
<span class='line-number'>3946</span>
<span class='line-number'>3947</span>
<span class='line-number'>3948</span>
<span class='line-number'>3949</span>
<span class='line-number'>3950</span>
<span class='line-number'>3951</span>
<span class='line-number'>3952</span>
<span class='line-number'>3953</span>
<span class='line-number'>3954</span>
<span class='line-number'>3955</span>
<span class='line-number'>3956</span>
<span class='line-number'>3957</span>
<span class='line-number'>3958</span>
<span class='line-number'>3959</span>
<span class='line-number'>3960</span>
<span class='line-number'>3961</span>
<span class='line-number'>3962</span>
<span class='line-number'>3963</span>
<span class='line-number'>3964</span>
<span class='line-number'>3965</span>
<span class='line-number'>3966</span>
<span class='line-number'>3967</span>
<span class='line-number'>3968</span>
<span class='line-number'>3969</span>
<span class='line-number'>3970</span>
<span class='line-number'>3971</span>
<span class='line-number'>3972</span>
<span class='line-number'>3973</span>
<span class='line-number'>3974</span>
<span class='line-number'>3975</span>
<span class='line-number'>3976</span>
<span class='line-number'>3977</span>
<span class='line-number'>3978</span>
<span class='line-number'>3979</span>
<span class='line-number'>3980</span>
<span class='line-number'>3981</span>
<span class='line-number'>3982</span>
<span class='line-number'>3983</span>
<span class='line-number'>3984</span>
<span class='line-number'>3985</span>
<span class='line-number'>3986</span>
<span class='line-number'>3987</span>
<span class='line-number'>3988</span>
<span class='line-number'>3989</span>
<span class='line-number'>3990</span>
<span class='line-number'>3991</span>
<span class='line-number'>3992</span>
<span class='line-number'>3993</span>
<span class='line-number'>3994</span>
<span class='line-number'>3995</span>
<span class='line-number'>3996</span>
<span class='line-number'>3997</span>
<span class='line-number'>3998</span>
<span class='line-number'>3999</span>
<span class='line-number'>4000</span>
<span class='line-number'>4001</span>
<span class='line-number'>4002</span>
<span class='line-number'>4003</span>
<span class='line-number'>4004</span>
<span class='line-number'>4005</span>
<span class='line-number'>4006</span>
<span class='line-number'>4007</span>
<span class='line-number'>4008</span>
<span class='line-number'>4009</span>
<span class='line-number'>4010</span>
<span class='line-number'>4011</span>
<span class='line-number'>4012</span>
<span class='line-number'>4013</span>
<span class='line-number'>4014</span>
<span class='line-number'>4015</span>
<span class='line-number'>4016</span>
<span class='line-number'>4017</span>
<span class='line-number'>4018</span>
<span class='line-number'>4019</span>
<span class='line-number'>4020</span>
<span class='line-number'>4021</span>
<span class='line-number'>4022</span>
<span class='line-number'>4023</span>
<span class='line-number'>4024</span>
<span class='line-number'>4025</span>
<span class='line-number'>4026</span>
<span class='line-number'>4027</span>
<span class='line-number'>4028</span>
<span class='line-number'>4029</span>
<span class='line-number'>4030</span>
<span class='line-number'>4031</span>
<span class='line-number'>4032</span>
<span class='line-number'>4033</span>
<span class='line-number'>4034</span>
<span class='line-number'>4035</span>
<span class='line-number'>4036</span>
<span class='line-number'>4037</span>
<span class='line-number'>4038</span>
<span class='line-number'>4039</span>
<span class='line-number'>4040</span>
<span class='line-number'>4041</span>
<span class='line-number'>4042</span>
<span class='line-number'>4043</span>
<span class='line-number'>4044</span>
<span class='line-number'>4045</span>
<span class='line-number'>4046</span>
<span class='line-number'>4047</span>
<span class='line-number'>4048</span>
<span class='line-number'>4049</span>
<span class='line-number'>4050</span>
<span class='line-number'>4051</span>
<span class='line-number'>4052</span>
<span class='line-number'>4053</span>
<span class='line-number'>4054</span>
<span class='line-number'>4055</span>
<span class='line-number'>4056</span>
<span class='line-number'>4057</span>
<span class='line-number'>4058</span>
<span class='line-number'>4059</span>
<span class='line-number'>4060</span>
<span class='line-number'>4061</span>
<span class='line-number'>4062</span>
<span class='line-number'>4063</span>
<span class='line-number'>4064</span>
<span class='line-number'>4065</span>
<span class='line-number'>4066</span>
<span class='line-number'>4067</span>
<span class='line-number'>4068</span>
<span class='line-number'>4069</span>
<span class='line-number'>4070</span>
<span class='line-number'>4071</span>
<span class='line-number'>4072</span>
<span class='line-number'>4073</span>
<span class='line-number'>4074</span>
<span class='line-number'>4075</span>
<span class='line-number'>4076</span>
<span class='line-number'>4077</span>
<span class='line-number'>4078</span>
<span class='line-number'>4079</span>
<span class='line-number'>4080</span>
<span class='line-number'>4081</span>
<span class='line-number'>4082</span>
<span class='line-number'>4083</span>
<span class='line-number'>4084</span>
<span class='line-number'>4085</span>
<span class='line-number'>4086</span>
<span class='line-number'>4087</span>
<span class='line-number'>4088</span>
<span class='line-number'>4089</span>
<span class='line-number'>4090</span>
<span class='line-number'>4091</span>
<span class='line-number'>4092</span>
<span class='line-number'>4093</span>
<span class='line-number'>4094</span>
<span class='line-number'>4095</span>
<span class='line-number'>4096</span>
<span class='line-number'>4097</span>
<span class='line-number'>4098</span>
<span class='line-number'>4099</span>
<span class='line-number'>4100</span>
<span class='line-number'>4101</span>
<span class='line-number'>4102</span>
<span class='line-number'>4103</span>
<span class='line-number'>4104</span>
<span class='line-number'>4105</span>
<span class='line-number'>4106</span>
<span class='line-number'>4107</span>
<span class='line-number'>4108</span>
<span class='line-number'>4109</span>
<span class='line-number'>4110</span>
<span class='line-number'>4111</span>
<span class='line-number'>4112</span>
<span class='line-number'>4113</span>
<span class='line-number'>4114</span>
<span class='line-number'>4115</span>
<span class='line-number'>4116</span>
<span class='line-number'>4117</span>
<span class='line-number'>4118</span>
<span class='line-number'>4119</span>
<span class='line-number'>4120</span>
<span class='line-number'>4121</span>
<span class='line-number'>4122</span>
<span class='line-number'>4123</span>
<span class='line-number'>4124</span>
<span class='line-number'>4125</span>
<span class='line-number'>4126</span>
<span class='line-number'>4127</span>
<span class='line-number'>4128</span>
<span class='line-number'>4129</span>
<span class='line-number'>4130</span>
<span class='line-number'>4131</span>
<span class='line-number'>4132</span>
<span class='line-number'>4133</span>
<span class='line-number'>4134</span>
<span class='line-number'>4135</span>
<span class='line-number'>4136</span>
<span class='line-number'>4137</span>
<span class='line-number'>4138</span>
<span class='line-number'>4139</span>
<span class='line-number'>4140</span>
<span class='line-number'>4141</span>
<span class='line-number'>4142</span>
<span class='line-number'>4143</span>
<span class='line-number'>4144</span>
<span class='line-number'>4145</span>
<span class='line-number'>4146</span>
<span class='line-number'>4147</span>
<span class='line-number'>4148</span>
<span class='line-number'>4149</span>
<span class='line-number'>4150</span>
<span class='line-number'>4151</span>
<span class='line-number'>4152</span>
<span class='line-number'>4153</span>
<span class='line-number'>4154</span>
<span class='line-number'>4155</span>
<span class='line-number'>4156</span>
<span class='line-number'>4157</span>
<span class='line-number'>4158</span>
<span class='line-number'>4159</span>
<span class='line-number'>4160</span>
<span class='line-number'>4161</span>
<span class='line-number'>4162</span>
<span class='line-number'>4163</span>
<span class='line-number'>4164</span>
<span class='line-number'>4165</span>
<span class='line-number'>4166</span>
<span class='line-number'>4167</span>
<span class='line-number'>4168</span>
<span class='line-number'>4169</span>
<span class='line-number'>4170</span>
<span class='line-number'>4171</span>
<span class='line-number'>4172</span>
<span class='line-number'>4173</span>
<span class='line-number'>4174</span>
<span class='line-number'>4175</span>
<span class='line-number'>4176</span>
<span class='line-number'>4177</span>
<span class='line-number'>4178</span>
<span class='line-number'>4179</span>
<span class='line-number'>4180</span>
<span class='line-number'>4181</span>
<span class='line-number'>4182</span>
<span class='line-number'>4183</span>
<span class='line-number'>4184</span>
<span class='line-number'>4185</span>
<span class='line-number'>4186</span>
<span class='line-number'>4187</span>
<span class='line-number'>4188</span>
<span class='line-number'>4189</span>
<span class='line-number'>4190</span>
<span class='line-number'>4191</span>
<span class='line-number'>4192</span>
<span class='line-number'>4193</span>
<span class='line-number'>4194</span>
<span class='line-number'>4195</span>
<span class='line-number'>4196</span>
<span class='line-number'>4197</span>
<span class='line-number'>4198</span>
<span class='line-number'>4199</span>
<span class='line-number'>4200</span>
<span class='line-number'>4201</span>
<span class='line-number'>4202</span>
<span class='line-number'>4203</span>
<span class='line-number'>4204</span>
<span class='line-number'>4205</span>
<span class='line-number'>4206</span>
<span class='line-number'>4207</span>
<span class='line-number'>4208</span>
<span class='line-number'>4209</span>
<span class='line-number'>4210</span>
<span class='line-number'>4211</span>
<span class='line-number'>4212</span>
<span class='line-number'>4213</span>
<span class='line-number'>4214</span>
<span class='line-number'>4215</span>
<span class='line-number'>4216</span>
<span class='line-number'>4217</span>
<span class='line-number'>4218</span>
<span class='line-number'>4219</span>
<span class='line-number'>4220</span>
<span class='line-number'>4221</span>
<span class='line-number'>4222</span>
<span class='line-number'>4223</span>
<span class='line-number'>4224</span>
<span class='line-number'>4225</span>
<span class='line-number'>4226</span>
<span class='line-number'>4227</span>
<span class='line-number'>4228</span>
<span class='line-number'>4229</span>
<span class='line-number'>4230</span>
<span class='line-number'>4231</span>
<span class='line-number'>4232</span>
<span class='line-number'>4233</span>
<span class='line-number'>4234</span>
<span class='line-number'>4235</span>
<span class='line-number'>4236</span>
<span class='line-number'>4237</span>
<span class='line-number'>4238</span>
<span class='line-number'>4239</span>
<span class='line-number'>4240</span>
<span class='line-number'>4241</span>
<span class='line-number'>4242</span>
<span class='line-number'>4243</span>
<span class='line-number'>4244</span>
<span class='line-number'>4245</span>
<span class='line-number'>4246</span>
<span class='line-number'>4247</span>
<span class='line-number'>4248</span>
<span class='line-number'>4249</span>
<span class='line-number'>4250</span>
<span class='line-number'>4251</span>
<span class='line-number'>4252</span>
<span class='line-number'>4253</span>
<span class='line-number'>4254</span>
<span class='line-number'>4255</span>
<span class='line-number'>4256</span>
<span class='line-number'>4257</span>
<span class='line-number'>4258</span>
<span class='line-number'>4259</span>
<span class='line-number'>4260</span>
<span class='line-number'>4261</span>
<span class='line-number'>4262</span>
<span class='line-number'>4263</span>
<span class='line-number'>4264</span>
<span class='line-number'>4265</span>
<span class='line-number'>4266</span>
<span class='line-number'>4267</span>
<span class='line-number'>4268</span>
<span class='line-number'>4269</span>
<span class='line-number'>4270</span>
<span class='line-number'>4271</span>
<span class='line-number'>4272</span>
<span class='line-number'>4273</span>
<span class='line-number'>4274</span>
<span class='line-number'>4275</span>
<span class='line-number'>4276</span>
<span class='line-number'>4277</span>
<span class='line-number'>4278</span>
<span class='line-number'>4279</span>
<span class='line-number'>4280</span>
<span class='line-number'>4281</span>
<span class='line-number'>4282</span>
<span class='line-number'>4283</span>
<span class='line-number'>4284</span>
<span class='line-number'>4285</span>
<span class='line-number'>4286</span>
<span class='line-number'>4287</span>
<span class='line-number'>4288</span>
<span class='line-number'>4289</span>
<span class='line-number'>4290</span>
<span class='line-number'>4291</span>
<span class='line-number'>4292</span>
<span class='line-number'>4293</span>
<span class='line-number'>4294</span>
<span class='line-number'>4295</span>
<span class='line-number'>4296</span>
<span class='line-number'>4297</span>
<span class='line-number'>4298</span>
<span class='line-number'>4299</span>
<span class='line-number'>4300</span>
<span class='line-number'>4301</span>
<span class='line-number'>4302</span>
<span class='line-number'>4303</span>
<span class='line-number'>4304</span>
<span class='line-number'>4305</span>
<span class='line-number'>4306</span>
<span class='line-number'>4307</span>
<span class='line-number'>4308</span>
<span class='line-number'>4309</span>
<span class='line-number'>4310</span>
<span class='line-number'>4311</span>
<span class='line-number'>4312</span>
<span class='line-number'>4313</span>
<span class='line-number'>4314</span>
<span class='line-number'>4315</span>
<span class='line-number'>4316</span>
<span class='line-number'>4317</span>
<span class='line-number'>4318</span>
<span class='line-number'>4319</span>
<span class='line-number'>4320</span>
<span class='line-number'>4321</span>
<span class='line-number'>4322</span>
<span class='line-number'>4323</span>
<span class='line-number'>4324</span>
<span class='line-number'>4325</span>
<span class='line-number'>4326</span>
<span class='line-number'>4327</span>
<span class='line-number'>4328</span>
<span class='line-number'>4329</span>
<span class='line-number'>4330</span>
<span class='line-number'>4331</span>
<span class='line-number'>4332</span>
<span class='line-number'>4333</span>
<span class='line-number'>4334</span>
<span class='line-number'>4335</span>
<span class='line-number'>4336</span>
<span class='line-number'>4337</span>
<span class='line-number'>4338</span>
<span class='line-number'>4339</span>
<span class='line-number'>4340</span>
<span class='line-number'>4341</span>
<span class='line-number'>4342</span>
<span class='line-number'>4343</span>
<span class='line-number'>4344</span>
<span class='line-number'>4345</span>
<span class='line-number'>4346</span>
<span class='line-number'>4347</span>
<span class='line-number'>4348</span>
<span class='line-number'>4349</span>
<span class='line-number'>4350</span>
<span class='line-number'>4351</span>
<span class='line-number'>4352</span>
<span class='line-number'>4353</span>
<span class='line-number'>4354</span>
<span class='line-number'>4355</span>
<span class='line-number'>4356</span>
<span class='line-number'>4357</span>
<span class='line-number'>4358</span>
<span class='line-number'>4359</span>
<span class='line-number'>4360</span>
<span class='line-number'>4361</span>
<span class='line-number'>4362</span>
<span class='line-number'>4363</span>
<span class='line-number'>4364</span>
<span class='line-number'>4365</span>
<span class='line-number'>4366</span>
<span class='line-number'>4367</span>
<span class='line-number'>4368</span>
<span class='line-number'>4369</span>
<span class='line-number'>4370</span>
<span class='line-number'>4371</span>
<span class='line-number'>4372</span>
<span class='line-number'>4373</span>
<span class='line-number'>4374</span>
<span class='line-number'>4375</span>
<span class='line-number'>4376</span>
<span class='line-number'>4377</span>
<span class='line-number'>4378</span>
<span class='line-number'>4379</span>
<span class='line-number'>4380</span>
<span class='line-number'>4381</span>
<span class='line-number'>4382</span>
<span class='line-number'>4383</span>
<span class='line-number'>4384</span>
<span class='line-number'>4385</span>
<span class='line-number'>4386</span>
<span class='line-number'>4387</span>
<span class='line-number'>4388</span>
<span class='line-number'>4389</span>
<span class='line-number'>4390</span>
<span class='line-number'>4391</span>
<span class='line-number'>4392</span>
<span class='line-number'>4393</span>
<span class='line-number'>4394</span>
<span class='line-number'>4395</span>
<span class='line-number'>4396</span>
<span class='line-number'>4397</span>
<span class='line-number'>4398</span>
<span class='line-number'>4399</span>
<span class='line-number'>4400</span>
<span class='line-number'>4401</span>
<span class='line-number'>4402</span>
<span class='line-number'>4403</span>
<span class='line-number'>4404</span>
<span class='line-number'>4405</span>
<span class='line-number'>4406</span>
<span class='line-number'>4407</span>
<span class='line-number'>4408</span>
<span class='line-number'>4409</span>
<span class='line-number'>4410</span>
<span class='line-number'>4411</span>
<span class='line-number'>4412</span>
<span class='line-number'>4413</span>
<span class='line-number'>4414</span>
<span class='line-number'>4415</span>
<span class='line-number'>4416</span>
<span class='line-number'>4417</span>
<span class='line-number'>4418</span>
<span class='line-number'>4419</span>
<span class='line-number'>4420</span>
<span class='line-number'>4421</span>
<span class='line-number'>4422</span>
<span class='line-number'>4423</span>
<span class='line-number'>4424</span>
<span class='line-number'>4425</span>
<span class='line-number'>4426</span>
<span class='line-number'>4427</span>
<span class='line-number'>4428</span>
<span class='line-number'>4429</span>
<span class='line-number'>4430</span>
<span class='line-number'>4431</span>
<span class='line-number'>4432</span>
<span class='line-number'>4433</span>
<span class='line-number'>4434</span>
<span class='line-number'>4435</span>
<span class='line-number'>4436</span>
<span class='line-number'>4437</span>
<span class='line-number'>4438</span>
<span class='line-number'>4439</span>
<span class='line-number'>4440</span>
<span class='line-number'>4441</span>
<span class='line-number'>4442</span>
<span class='line-number'>4443</span>
<span class='line-number'>4444</span>
<span class='line-number'>4445</span>
<span class='line-number'>4446</span>
<span class='line-number'>4447</span>
<span class='line-number'>4448</span>
<span class='line-number'>4449</span>
<span class='line-number'>4450</span>
<span class='line-number'>4451</span>
<span class='line-number'>4452</span>
<span class='line-number'>4453</span>
<span class='line-number'>4454</span>
<span class='line-number'>4455</span>
<span class='line-number'>4456</span>
<span class='line-number'>4457</span>
<span class='line-number'>4458</span>
<span class='line-number'>4459</span>
<span class='line-number'>4460</span>
<span class='line-number'>4461</span>
<span class='line-number'>4462</span>
<span class='line-number'>4463</span>
<span class='line-number'>4464</span>
<span class='line-number'>4465</span>
<span class='line-number'>4466</span>
<span class='line-number'>4467</span>
<span class='line-number'>4468</span>
<span class='line-number'>4469</span>
<span class='line-number'>4470</span>
<span class='line-number'>4471</span>
<span class='line-number'>4472</span>
<span class='line-number'>4473</span>
<span class='line-number'>4474</span>
<span class='line-number'>4475</span>
<span class='line-number'>4476</span>
<span class='line-number'>4477</span>
<span class='line-number'>4478</span>
<span class='line-number'>4479</span>
<span class='line-number'>4480</span>
<span class='line-number'>4481</span>
<span class='line-number'>4482</span>
<span class='line-number'>4483</span>
<span class='line-number'>4484</span>
<span class='line-number'>4485</span>
<span class='line-number'>4486</span>
<span class='line-number'>4487</span>
<span class='line-number'>4488</span>
<span class='line-number'>4489</span>
<span class='line-number'>4490</span>
<span class='line-number'>4491</span>
<span class='line-number'>4492</span>
<span class='line-number'>4493</span>
<span class='line-number'>4494</span>
<span class='line-number'>4495</span>
<span class='line-number'>4496</span>
<span class='line-number'>4497</span>
<span class='line-number'>4498</span>
<span class='line-number'>4499</span>
<span class='line-number'>4500</span>
<span class='line-number'>4501</span>
<span class='line-number'>4502</span>
<span class='line-number'>4503</span>
<span class='line-number'>4504</span>
<span class='line-number'>4505</span>
<span class='line-number'>4506</span>
<span class='line-number'>4507</span>
<span class='line-number'>4508</span>
<span class='line-number'>4509</span>
<span class='line-number'>4510</span>
<span class='line-number'>4511</span>
<span class='line-number'>4512</span>
<span class='line-number'>4513</span>
<span class='line-number'>4514</span>
<span class='line-number'>4515</span>
<span class='line-number'>4516</span>
<span class='line-number'>4517</span>
<span class='line-number'>4518</span>
<span class='line-number'>4519</span>
<span class='line-number'>4520</span>
<span class='line-number'>4521</span>
<span class='line-number'>4522</span>
<span class='line-number'>4523</span>
<span class='line-number'>4524</span>
<span class='line-number'>4525</span>
<span class='line-number'>4526</span>
<span class='line-number'>4527</span>
<span class='line-number'>4528</span>
<span class='line-number'>4529</span>
<span class='line-number'>4530</span>
<span class='line-number'>4531</span>
<span class='line-number'>4532</span>
<span class='line-number'>4533</span>
<span class='line-number'>4534</span>
<span class='line-number'>4535</span>
<span class='line-number'>4536</span>
<span class='line-number'>4537</span>
<span class='line-number'>4538</span>
<span class='line-number'>4539</span>
<span class='line-number'>4540</span>
<span class='line-number'>4541</span>
<span class='line-number'>4542</span>
<span class='line-number'>4543</span>
<span class='line-number'>4544</span>
<span class='line-number'>4545</span>
<span class='line-number'>4546</span>
<span class='line-number'>4547</span>
<span class='line-number'>4548</span>
<span class='line-number'>4549</span>
<span class='line-number'>4550</span>
<span class='line-number'>4551</span>
<span class='line-number'>4552</span>
<span class='line-number'>4553</span>
<span class='line-number'>4554</span>
<span class='line-number'>4555</span>
<span class='line-number'>4556</span>
<span class='line-number'>4557</span>
<span class='line-number'>4558</span>
<span class='line-number'>4559</span>
<span class='line-number'>4560</span>
<span class='line-number'>4561</span>
<span class='line-number'>4562</span>
<span class='line-number'>4563</span>
<span class='line-number'>4564</span>
<span class='line-number'>4565</span>
<span class='line-number'>4566</span>
<span class='line-number'>4567</span>
<span class='line-number'>4568</span>
<span class='line-number'>4569</span>
<span class='line-number'>4570</span>
<span class='line-number'>4571</span>
<span class='line-number'>4572</span>
<span class='line-number'>4573</span>
<span class='line-number'>4574</span>
<span class='line-number'>4575</span>
<span class='line-number'>4576</span>
<span class='line-number'>4577</span>
<span class='line-number'>4578</span>
<span class='line-number'>4579</span>
<span class='line-number'>4580</span>
<span class='line-number'>4581</span>
<span class='line-number'>4582</span>
<span class='line-number'>4583</span>
<span class='line-number'>4584</span>
<span class='line-number'>4585</span>
<span class='line-number'>4586</span>
<span class='line-number'>4587</span>
<span class='line-number'>4588</span>
<span class='line-number'>4589</span>
<span class='line-number'>4590</span>
<span class='line-number'>4591</span>
<span class='line-number'>4592</span>
<span class='line-number'>4593</span>
<span class='line-number'>4594</span>
<span class='line-number'>4595</span>
<span class='line-number'>4596</span>
<span class='line-number'>4597</span>
<span class='line-number'>4598</span>
<span class='line-number'>4599</span>
<span class='line-number'>4600</span>
<span class='line-number'>4601</span>
<span class='line-number'>4602</span>
<span class='line-number'>4603</span>
<span class='line-number'>4604</span>
<span class='line-number'>4605</span>
<span class='line-number'>4606</span>
<span class='line-number'>4607</span>
<span class='line-number'>4608</span>
<span class='line-number'>4609</span>
<span class='line-number'>4610</span>
<span class='line-number'>4611</span>
<span class='line-number'>4612</span>
<span class='line-number'>4613</span>
<span class='line-number'>4614</span>
<span class='line-number'>4615</span>
<span class='line-number'>4616</span>
<span class='line-number'>4617</span>
<span class='line-number'>4618</span>
<span class='line-number'>4619</span>
<span class='line-number'>4620</span>
<span class='line-number'>4621</span>
<span class='line-number'>4622</span>
<span class='line-number'>4623</span>
<span class='line-number'>4624</span>
<span class='line-number'>4625</span>
<span class='line-number'>4626</span>
<span class='line-number'>4627</span>
<span class='line-number'>4628</span>
<span class='line-number'>4629</span>
<span class='line-number'>4630</span>
<span class='line-number'>4631</span>
<span class='line-number'>4632</span>
<span class='line-number'>4633</span>
<span class='line-number'>4634</span>
<span class='line-number'>4635</span>
<span class='line-number'>4636</span>
<span class='line-number'>4637</span>
<span class='line-number'>4638</span>
<span class='line-number'>4639</span>
<span class='line-number'>4640</span>
<span class='line-number'>4641</span>
<span class='line-number'>4642</span>
<span class='line-number'>4643</span>
<span class='line-number'>4644</span>
<span class='line-number'>4645</span>
<span class='line-number'>4646</span>
<span class='line-number'>4647</span>
<span class='line-number'>4648</span>
<span class='line-number'>4649</span>
<span class='line-number'>4650</span>
<span class='line-number'>4651</span>
<span class='line-number'>4652</span>
<span class='line-number'>4653</span>
<span class='line-number'>4654</span>
<span class='line-number'>4655</span>
<span class='line-number'>4656</span>
<span class='line-number'>4657</span>
<span class='line-number'>4658</span>
<span class='line-number'>4659</span>
<span class='line-number'>4660</span>
<span class='line-number'>4661</span>
<span class='line-number'>4662</span>
<span class='line-number'>4663</span>
<span class='line-number'>4664</span>
<span class='line-number'>4665</span>
<span class='line-number'>4666</span>
<span class='line-number'>4667</span>
<span class='line-number'>4668</span>
<span class='line-number'>4669</span>
<span class='line-number'>4670</span>
<span class='line-number'>4671</span>
<span class='line-number'>4672</span>
<span class='line-number'>4673</span>
<span class='line-number'>4674</span>
<span class='line-number'>4675</span>
<span class='line-number'>4676</span>
<span class='line-number'>4677</span>
<span class='line-number'>4678</span>
<span class='line-number'>4679</span>
<span class='line-number'>4680</span>
<span class='line-number'>4681</span>
<span class='line-number'>4682</span>
<span class='line-number'>4683</span>
<span class='line-number'>4684</span>
<span class='line-number'>4685</span>
<span class='line-number'>4686</span>
<span class='line-number'>4687</span>
<span class='line-number'>4688</span>
<span class='line-number'>4689</span>
<span class='line-number'>4690</span>
<span class='line-number'>4691</span>
<span class='line-number'>4692</span>
<span class='line-number'>4693</span>
<span class='line-number'>4694</span>
<span class='line-number'>4695</span>
<span class='line-number'>4696</span>
<span class='line-number'>4697</span>
<span class='line-number'>4698</span>
<span class='line-number'>4699</span>
<span class='line-number'>4700</span>
<span class='line-number'>4701</span>
<span class='line-number'>4702</span>
<span class='line-number'>4703</span>
<span class='line-number'>4704</span>
<span class='line-number'>4705</span>
<span class='line-number'>4706</span>
<span class='line-number'>4707</span>
<span class='line-number'>4708</span>
<span class='line-number'>4709</span>
<span class='line-number'>4710</span>
<span class='line-number'>4711</span>
<span class='line-number'>4712</span>
<span class='line-number'>4713</span>
<span class='line-number'>4714</span>
<span class='line-number'>4715</span>
<span class='line-number'>4716</span>
<span class='line-number'>4717</span>
<span class='line-number'>4718</span>
<span class='line-number'>4719</span>
<span class='line-number'>4720</span>
<span class='line-number'>4721</span>
<span class='line-number'>4722</span>
<span class='line-number'>4723</span>
<span class='line-number'>4724</span>
<span class='line-number'>4725</span>
<span class='line-number'>4726</span>
<span class='line-number'>4727</span>
<span class='line-number'>4728</span>
<span class='line-number'>4729</span>
<span class='line-number'>4730</span>
<span class='line-number'>4731</span>
<span class='line-number'>4732</span>
<span class='line-number'>4733</span>
<span class='line-number'>4734</span>
<span class='line-number'>4735</span>
<span class='line-number'>4736</span>
<span class='line-number'>4737</span>
<span class='line-number'>4738</span>
<span class='line-number'>4739</span>
<span class='line-number'>4740</span>
<span class='line-number'>4741</span>
<span class='line-number'>4742</span>
<span class='line-number'>4743</span>
<span class='line-number'>4744</span>
<span class='line-number'>4745</span>
<span class='line-number'>4746</span>
<span class='line-number'>4747</span>
<span class='line-number'>4748</span>
<span class='line-number'>4749</span>
<span class='line-number'>4750</span>
<span class='line-number'>4751</span>
<span class='line-number'>4752</span>
<span class='line-number'>4753</span>
<span class='line-number'>4754</span>
<span class='line-number'>4755</span>
<span class='line-number'>4756</span>
<span class='line-number'>4757</span>
<span class='line-number'>4758</span>
<span class='line-number'>4759</span>
<span class='line-number'>4760</span>
<span class='line-number'>4761</span>
<span class='line-number'>4762</span>
<span class='line-number'>4763</span>
<span class='line-number'>4764</span>
<span class='line-number'>4765</span>
<span class='line-number'>4766</span>
<span class='line-number'>4767</span>
<span class='line-number'>4768</span>
<span class='line-number'>4769</span>
<span class='line-number'>4770</span>
<span class='line-number'>4771</span>
<span class='line-number'>4772</span>
<span class='line-number'>4773</span>
<span class='line-number'>4774</span>
<span class='line-number'>4775</span>
<span class='line-number'>4776</span>
<span class='line-number'>4777</span>
<span class='line-number'>4778</span>
<span class='line-number'>4779</span>
<span class='line-number'>4780</span>
<span class='line-number'>4781</span>
<span class='line-number'>4782</span>
<span class='line-number'>4783</span>
<span class='line-number'>4784</span>
<span class='line-number'>4785</span>
<span class='line-number'>4786</span>
<span class='line-number'>4787</span>
<span class='line-number'>4788</span>
<span class='line-number'>4789</span>
<span class='line-number'>4790</span>
<span class='line-number'>4791</span>
<span class='line-number'>4792</span>
<span class='line-number'>4793</span>
<span class='line-number'>4794</span>
<span class='line-number'>4795</span>
<span class='line-number'>4796</span>
<span class='line-number'>4797</span>
<span class='line-number'>4798</span>
<span class='line-number'>4799</span>
<span class='line-number'>4800</span>
<span class='line-number'>4801</span>
<span class='line-number'>4802</span>
<span class='line-number'>4803</span>
<span class='line-number'>4804</span>
<span class='line-number'>4805</span>
<span class='line-number'>4806</span>
<span class='line-number'>4807</span>
<span class='line-number'>4808</span>
<span class='line-number'>4809</span>
<span class='line-number'>4810</span>
<span class='line-number'>4811</span>
<span class='line-number'>4812</span>
<span class='line-number'>4813</span>
<span class='line-number'>4814</span>
<span class='line-number'>4815</span>
<span class='line-number'>4816</span>
<span class='line-number'>4817</span>
<span class='line-number'>4818</span>
<span class='line-number'>4819</span>
<span class='line-number'>4820</span>
<span class='line-number'>4821</span>
<span class='line-number'>4822</span>
<span class='line-number'>4823</span>
<span class='line-number'>4824</span>
<span class='line-number'>4825</span>
<span class='line-number'>4826</span>
<span class='line-number'>4827</span>
<span class='line-number'>4828</span>
<span class='line-number'>4829</span>
<span class='line-number'>4830</span>
<span class='line-number'>4831</span>
<span class='line-number'>4832</span>
<span class='line-number'>4833</span>
<span class='line-number'>4834</span>
<span class='line-number'>4835</span>
<span class='line-number'>4836</span>
<span class='line-number'>4837</span>
<span class='line-number'>4838</span>
<span class='line-number'>4839</span>
<span class='line-number'>4840</span>
<span class='line-number'>4841</span>
<span class='line-number'>4842</span>
<span class='line-number'>4843</span>
<span class='line-number'>4844</span>
<span class='line-number'>4845</span>
<span class='line-number'>4846</span>
<span class='line-number'>4847</span>
<span class='line-number'>4848</span>
<span class='line-number'>4849</span>
<span class='line-number'>4850</span>
<span class='line-number'>4851</span>
<span class='line-number'>4852</span>
<span class='line-number'>4853</span>
<span class='line-number'>4854</span>
<span class='line-number'>4855</span>
<span class='line-number'>4856</span>
<span class='line-number'>4857</span>
<span class='line-number'>4858</span>
<span class='line-number'>4859</span>
<span class='line-number'>4860</span>
<span class='line-number'>4861</span>
<span class='line-number'>4862</span>
<span class='line-number'>4863</span>
<span class='line-number'>4864</span>
<span class='line-number'>4865</span>
<span class='line-number'>4866</span>
<span class='line-number'>4867</span>
<span class='line-number'>4868</span>
<span class='line-number'>4869</span>
<span class='line-number'>4870</span>
<span class='line-number'>4871</span>
<span class='line-number'>4872</span>
<span class='line-number'>4873</span>
<span class='line-number'>4874</span>
<span class='line-number'>4875</span>
<span class='line-number'>4876</span>
<span class='line-number'>4877</span>
<span class='line-number'>4878</span>
<span class='line-number'>4879</span>
<span class='line-number'>4880</span>
<span class='line-number'>4881</span>
<span class='line-number'>4882</span>
<span class='line-number'>4883</span>
<span class='line-number'>4884</span>
<span class='line-number'>4885</span>
<span class='line-number'>4886</span>
<span class='line-number'>4887</span>
<span class='line-number'>4888</span>
<span class='line-number'>4889</span>
<span class='line-number'>4890</span>
<span class='line-number'>4891</span>
<span class='line-number'>4892</span>
<span class='line-number'>4893</span>
<span class='line-number'>4894</span>
<span class='line-number'>4895</span>
<span class='line-number'>4896</span>
<span class='line-number'>4897</span>
<span class='line-number'>4898</span>
<span class='line-number'>4899</span>
<span class='line-number'>4900</span>
<span class='line-number'>4901</span>
<span class='line-number'>4902</span>
<span class='line-number'>4903</span>
<span class='line-number'>4904</span>
<span class='line-number'>4905</span>
<span class='line-number'>4906</span>
<span class='line-number'>4907</span>
<span class='line-number'>4908</span>
<span class='line-number'>4909</span>
<span class='line-number'>4910</span>
<span class='line-number'>4911</span>
<span class='line-number'>4912</span>
<span class='line-number'>4913</span>
<span class='line-number'>4914</span>
<span class='line-number'>4915</span>
<span class='line-number'>4916</span>
<span class='line-number'>4917</span>
<span class='line-number'>4918</span>
<span class='line-number'>4919</span>
<span class='line-number'>4920</span>
<span class='line-number'>4921</span>
<span class='line-number'>4922</span>
<span class='line-number'>4923</span>
<span class='line-number'>4924</span>
<span class='line-number'>4925</span>
<span class='line-number'>4926</span>
<span class='line-number'>4927</span>
<span class='line-number'>4928</span>
<span class='line-number'>4929</span>
<span class='line-number'>4930</span>
<span class='line-number'>4931</span>
<span class='line-number'>4932</span>
<span class='line-number'>4933</span>
<span class='line-number'>4934</span>
<span class='line-number'>4935</span>
<span class='line-number'>4936</span>
<span class='line-number'>4937</span>
<span class='line-number'>4938</span>
<span class='line-number'>4939</span>
<span class='line-number'>4940</span>
<span class='line-number'>4941</span>
<span class='line-number'>4942</span>
<span class='line-number'>4943</span>
<span class='line-number'>4944</span>
<span class='line-number'>4945</span>
<span class='line-number'>4946</span>
<span class='line-number'>4947</span>
<span class='line-number'>4948</span>
<span class='line-number'>4949</span>
<span class='line-number'>4950</span>
<span class='line-number'>4951</span>
<span class='line-number'>4952</span>
<span class='line-number'>4953</span>
<span class='line-number'>4954</span>
<span class='line-number'>4955</span>
<span class='line-number'>4956</span>
<span class='line-number'>4957</span>
<span class='line-number'>4958</span>
<span class='line-number'>4959</span>
<span class='line-number'>4960</span>
<span class='line-number'>4961</span>
<span class='line-number'>4962</span>
<span class='line-number'>4963</span>
<span class='line-number'>4964</span>
<span class='line-number'>4965</span>
<span class='line-number'>4966</span>
<span class='line-number'>4967</span>
<span class='line-number'>4968</span>
<span class='line-number'>4969</span>
<span class='line-number'>4970</span>
<span class='line-number'>4971</span>
<span class='line-number'>4972</span>
<span class='line-number'>4973</span>
<span class='line-number'>4974</span>
<span class='line-number'>4975</span>
<span class='line-number'>4976</span>
<span class='line-number'>4977</span>
<span class='line-number'>4978</span>
<span class='line-number'>4979</span>
<span class='line-number'>4980</span>
<span class='line-number'>4981</span>
<span class='line-number'>4982</span>
<span class='line-number'>4983</span>
<span class='line-number'>4984</span>
<span class='line-number'>4985</span>
<span class='line-number'>4986</span>
<span class='line-number'>4987</span>
<span class='line-number'>4988</span>
<span class='line-number'>4989</span>
<span class='line-number'>4990</span>
<span class='line-number'>4991</span>
<span class='line-number'>4992</span>
<span class='line-number'>4993</span>
<span class='line-number'>4994</span>
<span class='line-number'>4995</span>
<span class='line-number'>4996</span>
<span class='line-number'>4997</span>
<span class='line-number'>4998</span>
<span class='line-number'>4999</span>
<span class='line-number'>5000</span>
<span class='line-number'>5001</span>
<span class='line-number'>5002</span>
<span class='line-number'>5003</span>
<span class='line-number'>5004</span>
<span class='line-number'>5005</span>
<span class='line-number'>5006</span>
<span class='line-number'>5007</span>
<span class='line-number'>5008</span>
<span class='line-number'>5009</span>
<span class='line-number'>5010</span>
<span class='line-number'>5011</span>
<span class='line-number'>5012</span>
<span class='line-number'>5013</span>
<span class='line-number'>5014</span>
<span class='line-number'>5015</span>
<span class='line-number'>5016</span>
<span class='line-number'>5017</span>
<span class='line-number'>5018</span>
<span class='line-number'>5019</span>
<span class='line-number'>5020</span>
<span class='line-number'>5021</span>
<span class='line-number'>5022</span>
<span class='line-number'>5023</span>
<span class='line-number'>5024</span>
<span class='line-number'>5025</span>
<span class='line-number'>5026</span>
<span class='line-number'>5027</span>
<span class='line-number'>5028</span>
<span class='line-number'>5029</span>
<span class='line-number'>5030</span>
<span class='line-number'>5031</span>
<span class='line-number'>5032</span>
<span class='line-number'>5033</span>
<span class='line-number'>5034</span>
<span class='line-number'>5035</span>
<span class='line-number'>5036</span>
<span class='line-number'>5037</span>
<span class='line-number'>5038</span>
<span class='line-number'>5039</span>
<span class='line-number'>5040</span>
<span class='line-number'>5041</span>
<span class='line-number'>5042</span>
<span class='line-number'>5043</span>
<span class='line-number'>5044</span>
<span class='line-number'>5045</span>
<span class='line-number'>5046</span>
<span class='line-number'>5047</span>
<span class='line-number'>5048</span>
<span class='line-number'>5049</span>
<span class='line-number'>5050</span>
<span class='line-number'>5051</span>
<span class='line-number'>5052</span>
<span class='line-number'>5053</span>
<span class='line-number'>5054</span>
<span class='line-number'>5055</span>
<span class='line-number'>5056</span>
<span class='line-number'>5057</span>
<span class='line-number'>5058</span>
<span class='line-number'>5059</span>
<span class='line-number'>5060</span>
<span class='line-number'>5061</span>
<span class='line-number'>5062</span>
<span class='line-number'>5063</span>
<span class='line-number'>5064</span>
<span class='line-number'>5065</span>
<span class='line-number'>5066</span>
<span class='line-number'>5067</span>
<span class='line-number'>5068</span>
<span class='line-number'>5069</span>
<span class='line-number'>5070</span>
<span class='line-number'>5071</span>
<span class='line-number'>5072</span>
<span class='line-number'>5073</span>
<span class='line-number'>5074</span>
<span class='line-number'>5075</span>
<span class='line-number'>5076</span>
<span class='line-number'>5077</span>
<span class='line-number'>5078</span>
<span class='line-number'>5079</span>
<span class='line-number'>5080</span>
<span class='line-number'>5081</span>
<span class='line-number'>5082</span>
<span class='line-number'>5083</span>
<span class='line-number'>5084</span>
<span class='line-number'>5085</span>
<span class='line-number'>5086</span>
<span class='line-number'>5087</span>
<span class='line-number'>5088</span>
<span class='line-number'>5089</span>
<span class='line-number'>5090</span>
<span class='line-number'>5091</span>
<span class='line-number'>5092</span>
<span class='line-number'>5093</span>
<span class='line-number'>5094</span>
<span class='line-number'>5095</span>
<span class='line-number'>5096</span>
<span class='line-number'>5097</span>
<span class='line-number'>5098</span>
<span class='line-number'>5099</span>
<span class='line-number'>5100</span>
<span class='line-number'>5101</span>
<span class='line-number'>5102</span>
<span class='line-number'>5103</span>
<span class='line-number'>5104</span>
<span class='line-number'>5105</span>
<span class='line-number'>5106</span>
<span class='line-number'>5107</span>
<span class='line-number'>5108</span>
<span class='line-number'>5109</span>
<span class='line-number'>5110</span>
<span class='line-number'>5111</span>
<span class='line-number'>5112</span>
<span class='line-number'>5113</span>
<span class='line-number'>5114</span>
<span class='line-number'>5115</span>
<span class='line-number'>5116</span>
<span class='line-number'>5117</span>
<span class='line-number'>5118</span>
<span class='line-number'>5119</span>
<span class='line-number'>5120</span>
<span class='line-number'>5121</span>
<span class='line-number'>5122</span>
<span class='line-number'>5123</span>
<span class='line-number'>5124</span>
<span class='line-number'>5125</span>
<span class='line-number'>5126</span>
<span class='line-number'>5127</span>
<span class='line-number'>5128</span>
<span class='line-number'>5129</span>
<span class='line-number'>5130</span>
<span class='line-number'>5131</span>
<span class='line-number'>5132</span>
<span class='line-number'>5133</span>
<span class='line-number'>5134</span>
<span class='line-number'>5135</span>
<span class='line-number'>5136</span>
<span class='line-number'>5137</span>
<span class='line-number'>5138</span>
<span class='line-number'>5139</span>
<span class='line-number'>5140</span>
<span class='line-number'>5141</span>
<span class='line-number'>5142</span>
<span class='line-number'>5143</span>
<span class='line-number'>5144</span>
<span class='line-number'>5145</span>
<span class='line-number'>5146</span>
<span class='line-number'>5147</span>
<span class='line-number'>5148</span>
<span class='line-number'>5149</span>
<span class='line-number'>5150</span>
<span class='line-number'>5151</span>
<span class='line-number'>5152</span>
<span class='line-number'>5153</span>
<span class='line-number'>5154</span>
<span class='line-number'>5155</span>
<span class='line-number'>5156</span>
<span class='line-number'>5157</span>
<span class='line-number'>5158</span>
<span class='line-number'>5159</span>
<span class='line-number'>5160</span>
<span class='line-number'>5161</span>
<span class='line-number'>5162</span>
<span class='line-number'>5163</span>
<span class='line-number'>5164</span>
<span class='line-number'>5165</span>
<span class='line-number'>5166</span>
<span class='line-number'>5167</span>
<span class='line-number'>5168</span>
<span class='line-number'>5169</span>
<span class='line-number'>5170</span>
<span class='line-number'>5171</span>
<span class='line-number'>5172</span>
<span class='line-number'>5173</span>
<span class='line-number'>5174</span>
<span class='line-number'>5175</span>
<span class='line-number'>5176</span>
<span class='line-number'>5177</span>
<span class='line-number'>5178</span>
<span class='line-number'>5179</span>
<span class='line-number'>5180</span>
<span class='line-number'>5181</span>
<span class='line-number'>5182</span>
<span class='line-number'>5183</span>
<span class='line-number'>5184</span>
<span class='line-number'>5185</span>
<span class='line-number'>5186</span>
<span class='line-number'>5187</span>
<span class='line-number'>5188</span>
<span class='line-number'>5189</span>
<span class='line-number'>5190</span>
<span class='line-number'>5191</span>
<span class='line-number'>5192</span>
<span class='line-number'>5193</span>
<span class='line-number'>5194</span>
<span class='line-number'>5195</span>
<span class='line-number'>5196</span>
<span class='line-number'>5197</span>
<span class='line-number'>5198</span>
<span class='line-number'>5199</span>
<span class='line-number'>5200</span>
<span class='line-number'>5201</span>
<span class='line-number'>5202</span>
<span class='line-number'>5203</span>
<span class='line-number'>5204</span>
<span class='line-number'>5205</span>
<span class='line-number'>5206</span>
<span class='line-number'>5207</span>
<span class='line-number'>5208</span>
<span class='line-number'>5209</span>
<span class='line-number'>5210</span>
<span class='line-number'>5211</span>
<span class='line-number'>5212</span>
<span class='line-number'>5213</span>
<span class='line-number'>5214</span>
<span class='line-number'>5215</span>
<span class='line-number'>5216</span>
<span class='line-number'>5217</span>
<span class='line-number'>5218</span>
<span class='line-number'>5219</span>
<span class='line-number'>5220</span>
<span class='line-number'>5221</span>
<span class='line-number'>5222</span>
<span class='line-number'>5223</span>
<span class='line-number'>5224</span>
<span class='line-number'>5225</span>
<span class='line-number'>5226</span>
<span class='line-number'>5227</span>
<span class='line-number'>5228</span>
<span class='line-number'>5229</span>
<span class='line-number'>5230</span>
<span class='line-number'>5231</span>
<span class='line-number'>5232</span>
<span class='line-number'>5233</span>
<span class='line-number'>5234</span>
<span class='line-number'>5235</span>
<span class='line-number'>5236</span>
<span class='line-number'>5237</span>
<span class='line-number'>5238</span>
<span class='line-number'>5239</span>
<span class='line-number'>5240</span>
<span class='line-number'>5241</span>
<span class='line-number'>5242</span>
<span class='line-number'>5243</span>
<span class='line-number'>5244</span>
<span class='line-number'>5245</span>
<span class='line-number'>5246</span>
<span class='line-number'>5247</span>
<span class='line-number'>5248</span>
<span class='line-number'>5249</span>
<span class='line-number'>5250</span>
<span class='line-number'>5251</span>
<span class='line-number'>5252</span>
<span class='line-number'>5253</span>
<span class='line-number'>5254</span>
<span class='line-number'>5255</span>
<span class='line-number'>5256</span>
<span class='line-number'>5257</span>
<span class='line-number'>5258</span>
<span class='line-number'>5259</span>
<span class='line-number'>5260</span>
<span class='line-number'>5261</span>
<span class='line-number'>5262</span>
<span class='line-number'>5263</span>
<span class='line-number'>5264</span>
<span class='line-number'>5265</span>
<span class='line-number'>5266</span>
<span class='line-number'>5267</span>
<span class='line-number'>5268</span>
<span class='line-number'>5269</span>
<span class='line-number'>5270</span>
<span class='line-number'>5271</span>
<span class='line-number'>5272</span>
<span class='line-number'>5273</span>
<span class='line-number'>5274</span>
<span class='line-number'>5275</span>
<span class='line-number'>5276</span>
<span class='line-number'>5277</span>
<span class='line-number'>5278</span>
<span class='line-number'>5279</span>
<span class='line-number'>5280</span>
<span class='line-number'>5281</span>
<span class='line-number'>5282</span>
<span class='line-number'>5283</span>
<span class='line-number'>5284</span>
<span class='line-number'>5285</span>
<span class='line-number'>5286</span>
<span class='line-number'>5287</span>
<span class='line-number'>5288</span>
<span class='line-number'>5289</span>
<span class='line-number'>5290</span>
<span class='line-number'>5291</span>
<span class='line-number'>5292</span>
<span class='line-number'>5293</span>
<span class='line-number'>5294</span>
<span class='line-number'>5295</span>
<span class='line-number'>5296</span>
<span class='line-number'>5297</span>
<span class='line-number'>5298</span>
<span class='line-number'>5299</span>
<span class='line-number'>5300</span>
<span class='line-number'>5301</span>
<span class='line-number'>5302</span>
<span class='line-number'>5303</span>
<span class='line-number'>5304</span>
<span class='line-number'>5305</span>
<span class='line-number'>5306</span>
<span class='line-number'>5307</span>
<span class='line-number'>5308</span>
<span class='line-number'>5309</span>
<span class='line-number'>5310</span>
<span class='line-number'>5311</span>
<span class='line-number'>5312</span>
<span class='line-number'>5313</span>
<span class='line-number'>5314</span>
<span class='line-number'>5315</span>
<span class='line-number'>5316</span>
<span class='line-number'>5317</span>
<span class='line-number'>5318</span>
<span class='line-number'>5319</span>
<span class='line-number'>5320</span>
<span class='line-number'>5321</span>
<span class='line-number'>5322</span>
<span class='line-number'>5323</span>
<span class='line-number'>5324</span>
<span class='line-number'>5325</span>
<span class='line-number'>5326</span>
<span class='line-number'>5327</span>
<span class='line-number'>5328</span>
<span class='line-number'>5329</span>
<span class='line-number'>5330</span>
<span class='line-number'>5331</span>
<span class='line-number'>5332</span>
<span class='line-number'>5333</span>
<span class='line-number'>5334</span>
<span class='line-number'>5335</span>
<span class='line-number'>5336</span>
<span class='line-number'>5337</span>
<span class='line-number'>5338</span>
<span class='line-number'>5339</span>
<span class='line-number'>5340</span>
<span class='line-number'>5341</span>
<span class='line-number'>5342</span>
<span class='line-number'>5343</span>
<span class='line-number'>5344</span>
<span class='line-number'>5345</span>
<span class='line-number'>5346</span>
<span class='line-number'>5347</span>
<span class='line-number'>5348</span>
<span class='line-number'>5349</span>
<span class='line-number'>5350</span>
<span class='line-number'>5351</span>
<span class='line-number'>5352</span>
<span class='line-number'>5353</span>
<span class='line-number'>5354</span>
<span class='line-number'>5355</span>
<span class='line-number'>5356</span>
<span class='line-number'>5357</span>
<span class='line-number'>5358</span>
<span class='line-number'>5359</span>
<span class='line-number'>5360</span>
<span class='line-number'>5361</span>
<span class='line-number'>5362</span>
<span class='line-number'>5363</span>
<span class='line-number'>5364</span>
<span class='line-number'>5365</span>
<span class='line-number'>5366</span>
<span class='line-number'>5367</span>
<span class='line-number'>5368</span>
<span class='line-number'>5369</span>
<span class='line-number'>5370</span>
<span class='line-number'>5371</span>
<span class='line-number'>5372</span>
<span class='line-number'>5373</span>
<span class='line-number'>5374</span>
<span class='line-number'>5375</span>
<span class='line-number'>5376</span>
<span class='line-number'>5377</span>
<span class='line-number'>5378</span>
<span class='line-number'>5379</span>
<span class='line-number'>5380</span>
<span class='line-number'>5381</span>
<span class='line-number'>5382</span>
<span class='line-number'>5383</span>
<span class='line-number'>5384</span>
<span class='line-number'>5385</span>
<span class='line-number'>5386</span>
<span class='line-number'>5387</span>
<span class='line-number'>5388</span>
<span class='line-number'>5389</span>
<span class='line-number'>5390</span>
<span class='line-number'>5391</span>
<span class='line-number'>5392</span>
<span class='line-number'>5393</span>
<span class='line-number'>5394</span>
<span class='line-number'>5395</span>
<span class='line-number'>5396</span>
<span class='line-number'>5397</span>
<span class='line-number'>5398</span>
<span class='line-number'>5399</span>
<span class='line-number'>5400</span>
<span class='line-number'>5401</span>
<span class='line-number'>5402</span>
<span class='line-number'>5403</span>
<span class='line-number'>5404</span>
<span class='line-number'>5405</span>
<span class='line-number'>5406</span>
<span class='line-number'>5407</span>
<span class='line-number'>5408</span>
<span class='line-number'>5409</span>
<span class='line-number'>5410</span>
<span class='line-number'>5411</span>
<span class='line-number'>5412</span>
<span class='line-number'>5413</span>
<span class='line-number'>5414</span>
<span class='line-number'>5415</span>
<span class='line-number'>5416</span>
<span class='line-number'>5417</span>
<span class='line-number'>5418</span>
<span class='line-number'>5419</span>
<span class='line-number'>5420</span>
<span class='line-number'>5421</span>
<span class='line-number'>5422</span>
<span class='line-number'>5423</span>
<span class='line-number'>5424</span>
<span class='line-number'>5425</span>
<span class='line-number'>5426</span>
<span class='line-number'>5427</span>
<span class='line-number'>5428</span>
<span class='line-number'>5429</span>
<span class='line-number'>5430</span>
<span class='line-number'>5431</span>
<span class='line-number'>5432</span>
<span class='line-number'>5433</span>
<span class='line-number'>5434</span>
<span class='line-number'>5435</span>
<span class='line-number'>5436</span>
<span class='line-number'>5437</span>
<span class='line-number'>5438</span>
<span class='line-number'>5439</span>
<span class='line-number'>5440</span>
<span class='line-number'>5441</span>
<span class='line-number'>5442</span>
<span class='line-number'>5443</span>
<span class='line-number'>5444</span>
<span class='line-number'>5445</span>
<span class='line-number'>5446</span>
<span class='line-number'>5447</span>
<span class='line-number'>5448</span>
<span class='line-number'>5449</span>
<span class='line-number'>5450</span>
<span class='line-number'>5451</span>
<span class='line-number'>5452</span>
<span class='line-number'>5453</span>
<span class='line-number'>5454</span>
<span class='line-number'>5455</span>
<span class='line-number'>5456</span>
<span class='line-number'>5457</span>
<span class='line-number'>5458</span>
<span class='line-number'>5459</span>
<span class='line-number'>5460</span>
<span class='line-number'>5461</span>
<span class='line-number'>5462</span>
<span class='line-number'>5463</span>
<span class='line-number'>5464</span>
<span class='line-number'>5465</span>
<span class='line-number'>5466</span>
<span class='line-number'>5467</span>
<span class='line-number'>5468</span>
<span class='line-number'>5469</span>
<span class='line-number'>5470</span>
<span class='line-number'>5471</span>
<span class='line-number'>5472</span>
<span class='line-number'>5473</span>
<span class='line-number'>5474</span>
<span class='line-number'>5475</span>
<span class='line-number'>5476</span>
<span class='line-number'>5477</span>
<span class='line-number'>5478</span>
<span class='line-number'>5479</span>
<span class='line-number'>5480</span>
<span class='line-number'>5481</span>
<span class='line-number'>5482</span>
<span class='line-number'>5483</span>
<span class='line-number'>5484</span>
<span class='line-number'>5485</span>
<span class='line-number'>5486</span>
<span class='line-number'>5487</span>
<span class='line-number'>5488</span>
<span class='line-number'>5489</span>
<span class='line-number'>5490</span>
<span class='line-number'>5491</span>
<span class='line-number'>5492</span>
<span class='line-number'>5493</span>
<span class='line-number'>5494</span>
<span class='line-number'>5495</span>
<span class='line-number'>5496</span>
<span class='line-number'>5497</span>
<span class='line-number'>5498</span>
<span class='line-number'>5499</span>
<span class='line-number'>5500</span>
<span class='line-number'>5501</span>
<span class='line-number'>5502</span>
<span class='line-number'>5503</span>
<span class='line-number'>5504</span>
<span class='line-number'>5505</span>
<span class='line-number'>5506</span>
<span class='line-number'>5507</span>
<span class='line-number'>5508</span>
<span class='line-number'>5509</span>
<span class='line-number'>5510</span>
<span class='line-number'>5511</span>
<span class='line-number'>5512</span>
<span class='line-number'>5513</span>
<span class='line-number'>5514</span>
<span class='line-number'>5515</span>
<span class='line-number'>5516</span>
<span class='line-number'>5517</span>
<span class='line-number'>5518</span>
<span class='line-number'>5519</span>
<span class='line-number'>5520</span>
<span class='line-number'>5521</span>
<span class='line-number'>5522</span>
<span class='line-number'>5523</span>
<span class='line-number'>5524</span>
<span class='line-number'>5525</span>
<span class='line-number'>5526</span>
<span class='line-number'>5527</span>
<span class='line-number'>5528</span>
<span class='line-number'>5529</span>
<span class='line-number'>5530</span>
<span class='line-number'>5531</span>
<span class='line-number'>5532</span>
<span class='line-number'>5533</span>
<span class='line-number'>5534</span>
<span class='line-number'>5535</span>
<span class='line-number'>5536</span>
<span class='line-number'>5537</span>
<span class='line-number'>5538</span>
<span class='line-number'>5539</span>
<span class='line-number'>5540</span>
<span class='line-number'>5541</span>
<span class='line-number'>5542</span>
<span class='line-number'>5543</span>
<span class='line-number'>5544</span>
<span class='line-number'>5545</span>
<span class='line-number'>5546</span>
<span class='line-number'>5547</span>
<span class='line-number'>5548</span>
<span class='line-number'>5549</span>
<span class='line-number'>5550</span>
<span class='line-number'>5551</span>
<span class='line-number'>5552</span>
<span class='line-number'>5553</span>
<span class='line-number'>5554</span>
<span class='line-number'>5555</span>
<span class='line-number'>5556</span>
<span class='line-number'>5557</span>
<span class='line-number'>5558</span>
<span class='line-number'>5559</span>
<span class='line-number'>5560</span>
<span class='line-number'>5561</span>
<span class='line-number'>5562</span>
<span class='line-number'>5563</span>
<span class='line-number'>5564</span>
<span class='line-number'>5565</span>
<span class='line-number'>5566</span>
<span class='line-number'>5567</span>
<span class='line-number'>5568</span>
<span class='line-number'>5569</span>
<span class='line-number'>5570</span>
<span class='line-number'>5571</span>
<span class='line-number'>5572</span>
<span class='line-number'>5573</span>
<span class='line-number'>5574</span>
<span class='line-number'>5575</span>
<span class='line-number'>5576</span>
<span class='line-number'>5577</span>
<span class='line-number'>5578</span>
<span class='line-number'>5579</span>
<span class='line-number'>5580</span>
<span class='line-number'>5581</span>
<span class='line-number'>5582</span>
<span class='line-number'>5583</span>
<span class='line-number'>5584</span>
<span class='line-number'>5585</span>
<span class='line-number'>5586</span>
<span class='line-number'>5587</span>
<span class='line-number'>5588</span>
<span class='line-number'>5589</span>
<span class='line-number'>5590</span>
<span class='line-number'>5591</span>
<span class='line-number'>5592</span>
<span class='line-number'>5593</span>
<span class='line-number'>5594</span>
<span class='line-number'>5595</span>
<span class='line-number'>5596</span>
<span class='line-number'>5597</span>
<span class='line-number'>5598</span>
<span class='line-number'>5599</span>
<span class='line-number'>5600</span>
<span class='line-number'>5601</span>
<span class='line-number'>5602</span>
<span class='line-number'>5603</span>
<span class='line-number'>5604</span>
<span class='line-number'>5605</span>
<span class='line-number'>5606</span>
<span class='line-number'>5607</span>
<span class='line-number'>5608</span>
<span class='line-number'>5609</span>
<span class='line-number'>5610</span>
<span class='line-number'>5611</span>
<span class='line-number'>5612</span>
<span class='line-number'>5613</span>
<span class='line-number'>5614</span>
<span class='line-number'>5615</span>
<span class='line-number'>5616</span>
<span class='line-number'>5617</span>
<span class='line-number'>5618</span>
<span class='line-number'>5619</span>
<span class='line-number'>5620</span>
<span class='line-number'>5621</span>
<span class='line-number'>5622</span>
<span class='line-number'>5623</span>
<span class='line-number'>5624</span>
<span class='line-number'>5625</span>
<span class='line-number'>5626</span>
<span class='line-number'>5627</span>
<span class='line-number'>5628</span>
<span class='line-number'>5629</span>
<span class='line-number'>5630</span>
<span class='line-number'>5631</span>
<span class='line-number'>5632</span>
<span class='line-number'>5633</span>
<span class='line-number'>5634</span>
<span class='line-number'>5635</span>
<span class='line-number'>5636</span>
<span class='line-number'>5637</span>
<span class='line-number'>5638</span>
<span class='line-number'>5639</span>
<span class='line-number'>5640</span>
<span class='line-number'>5641</span>
<span class='line-number'>5642</span>
<span class='line-number'>5643</span>
<span class='line-number'>5644</span>
<span class='line-number'>5645</span>
<span class='line-number'>5646</span>
<span class='line-number'>5647</span>
<span class='line-number'>5648</span>
<span class='line-number'>5649</span>
<span class='line-number'>5650</span>
<span class='line-number'>5651</span>
<span class='line-number'>5652</span>
<span class='line-number'>5653</span>
<span class='line-number'>5654</span>
<span class='line-number'>5655</span>
<span class='line-number'>5656</span>
<span class='line-number'>5657</span>
<span class='line-number'>5658</span>
<span class='line-number'>5659</span>
<span class='line-number'>5660</span>
<span class='line-number'>5661</span>
<span class='line-number'>5662</span>
<span class='line-number'>5663</span>
<span class='line-number'>5664</span>
<span class='line-number'>5665</span>
<span class='line-number'>5666</span>
<span class='line-number'>5667</span>
<span class='line-number'>5668</span>
<span class='line-number'>5669</span>
<span class='line-number'>5670</span>
<span class='line-number'>5671</span>
<span class='line-number'>5672</span>
<span class='line-number'>5673</span>
<span class='line-number'>5674</span>
<span class='line-number'>5675</span>
<span class='line-number'>5676</span>
<span class='line-number'>5677</span>
<span class='line-number'>5678</span>
<span class='line-number'>5679</span>
<span class='line-number'>5680</span>
<span class='line-number'>5681</span>
<span class='line-number'>5682</span>
<span class='line-number'>5683</span>
<span class='line-number'>5684</span>
<span class='line-number'>5685</span>
<span class='line-number'>5686</span>
<span class='line-number'>5687</span>
<span class='line-number'>5688</span>
<span class='line-number'>5689</span>
<span class='line-number'>5690</span>
<span class='line-number'>5691</span>
<span class='line-number'>5692</span>
<span class='line-number'>5693</span>
<span class='line-number'>5694</span>
<span class='line-number'>5695</span>
<span class='line-number'>5696</span>
<span class='line-number'>5697</span>
<span class='line-number'>5698</span>
<span class='line-number'>5699</span>
<span class='line-number'>5700</span>
<span class='line-number'>5701</span>
<span class='line-number'>5702</span>
<span class='line-number'>5703</span>
<span class='line-number'>5704</span>
<span class='line-number'>5705</span>
<span class='line-number'>5706</span>
<span class='line-number'>5707</span>
<span class='line-number'>5708</span>
<span class='line-number'>5709</span>
<span class='line-number'>5710</span>
<span class='line-number'>5711</span>
<span class='line-number'>5712</span>
<span class='line-number'>5713</span>
<span class='line-number'>5714</span>
<span class='line-number'>5715</span>
<span class='line-number'>5716</span>
<span class='line-number'>5717</span>
<span class='line-number'>5718</span>
<span class='line-number'>5719</span>
<span class='line-number'>5720</span>
<span class='line-number'>5721</span>
<span class='line-number'>5722</span>
<span class='line-number'>5723</span>
<span class='line-number'>5724</span>
<span class='line-number'>5725</span>
<span class='line-number'>5726</span>
<span class='line-number'>5727</span>
<span class='line-number'>5728</span>
<span class='line-number'>5729</span>
<span class='line-number'>5730</span>
<span class='line-number'>5731</span>
<span class='line-number'>5732</span>
<span class='line-number'>5733</span>
<span class='line-number'>5734</span>
<span class='line-number'>5735</span>
<span class='line-number'>5736</span>
<span class='line-number'>5737</span>
<span class='line-number'>5738</span>
<span class='line-number'>5739</span>
<span class='line-number'>5740</span>
<span class='line-number'>5741</span>
<span class='line-number'>5742</span>
<span class='line-number'>5743</span>
<span class='line-number'>5744</span>
<span class='line-number'>5745</span>
<span class='line-number'>5746</span>
<span class='line-number'>5747</span>
<span class='line-number'>5748</span>
<span class='line-number'>5749</span>
<span class='line-number'>5750</span>
<span class='line-number'>5751</span>
<span class='line-number'>5752</span>
<span class='line-number'>5753</span>
<span class='line-number'>5754</span>
<span class='line-number'>5755</span>
<span class='line-number'>5756</span>
<span class='line-number'>5757</span>
<span class='line-number'>5758</span>
<span class='line-number'>5759</span>
<span class='line-number'>5760</span>
<span class='line-number'>5761</span>
<span class='line-number'>5762</span>
<span class='line-number'>5763</span>
<span class='line-number'>5764</span>
<span class='line-number'>5765</span>
<span class='line-number'>5766</span>
<span class='line-number'>5767</span>
<span class='line-number'>5768</span>
<span class='line-number'>5769</span>
<span class='line-number'>5770</span>
<span class='line-number'>5771</span>
<span class='line-number'>5772</span>
<span class='line-number'>5773</span>
<span class='line-number'>5774</span>
<span class='line-number'>5775</span>
<span class='line-number'>5776</span>
<span class='line-number'>5777</span>
<span class='line-number'>5778</span>
<span class='line-number'>5779</span>
<span class='line-number'>5780</span>
<span class='line-number'>5781</span>
<span class='line-number'>5782</span>
<span class='line-number'>5783</span>
<span class='line-number'>5784</span>
<span class='line-number'>5785</span>
<span class='line-number'>5786</span>
<span class='line-number'>5787</span>
<span class='line-number'>5788</span>
<span class='line-number'>5789</span>
<span class='line-number'>5790</span>
<span class='line-number'>5791</span>
<span class='line-number'>5792</span>
<span class='line-number'>5793</span>
<span class='line-number'>5794</span>
<span class='line-number'>5795</span>
<span class='line-number'>5796</span>
<span class='line-number'>5797</span>
<span class='line-number'>5798</span>
<span class='line-number'>5799</span>
<span class='line-number'>5800</span>
<span class='line-number'>5801</span>
<span class='line-number'>5802</span>
<span class='line-number'>5803</span>
<span class='line-number'>5804</span>
<span class='line-number'>5805</span>
<span class='line-number'>5806</span>
<span class='line-number'>5807</span>
<span class='line-number'>5808</span>
<span class='line-number'>5809</span>
<span class='line-number'>5810</span>
<span class='line-number'>5811</span>
<span class='line-number'>5812</span>
<span class='line-number'>5813</span>
<span class='line-number'>5814</span>
<span class='line-number'>5815</span>
<span class='line-number'>5816</span>
<span class='line-number'>5817</span>
<span class='line-number'>5818</span>
<span class='line-number'>5819</span>
<span class='line-number'>5820</span>
<span class='line-number'>5821</span>
<span class='line-number'>5822</span>
<span class='line-number'>5823</span>
<span class='line-number'>5824</span>
<span class='line-number'>5825</span>
<span class='line-number'>5826</span>
<span class='line-number'>5827</span>
<span class='line-number'>5828</span>
<span class='line-number'>5829</span>
<span class='line-number'>5830</span>
<span class='line-number'>5831</span>
<span class='line-number'>5832</span>
<span class='line-number'>5833</span>
<span class='line-number'>5834</span>
<span class='line-number'>5835</span>
<span class='line-number'>5836</span>
<span class='line-number'>5837</span>
<span class='line-number'>5838</span>
<span class='line-number'>5839</span>
<span class='line-number'>5840</span>
<span class='line-number'>5841</span>
<span class='line-number'>5842</span>
<span class='line-number'>5843</span>
<span class='line-number'>5844</span>
<span class='line-number'>5845</span>
<span class='line-number'>5846</span>
<span class='line-number'>5847</span>
<span class='line-number'>5848</span>
<span class='line-number'>5849</span>
<span class='line-number'>5850</span>
<span class='line-number'>5851</span>
<span class='line-number'>5852</span>
<span class='line-number'>5853</span>
<span class='line-number'>5854</span>
<span class='line-number'>5855</span>
<span class='line-number'>5856</span>
<span class='line-number'>5857</span>
<span class='line-number'>5858</span>
<span class='line-number'>5859</span>
<span class='line-number'>5860</span>
<span class='line-number'>5861</span>
<span class='line-number'>5862</span>
<span class='line-number'>5863</span>
<span class='line-number'>5864</span>
<span class='line-number'>5865</span>
</pre></td><td class='code'><pre><code class='scheme'><span class='line'><span class="o">#</span><span class="nv">lang</span> <span class="nv">racket</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;;; I will introuduce The little scheme From the angles below</span>
</span><span class='line'><span class="c1">;;; 1:</span>
</span><span class='line'><span class="c1">;;;     why introuduce the concept</span>
</span><span class='line'><span class="c1">;;; 2:  </span>
</span><span class='line'><span class="c1">;;;     The main knowledge</span>
</span><span class='line'><span class="c1">;;; 3: </span>
</span><span class='line'><span class="c1">;;;     Map-reduce </span>
</span><span class='line'><span class="c1">;;;     .......</span>
</span><span class='line'><span class="c1">;;; 4:  How you describe the function works in  your own words? </span>
</span><span class='line'><span class="c1">;;; 5:  How do you determine the output when you apply a function?Is it what you want?</span>
</span><span class='line'><span class="c1">;;;     no? why no?</span>
</span><span class='line'><span class="c1">;;;;Namely, Can you write down the definition of the function member? and its arguments</span>
</span><span class='line'><span class="c1">;;;     and refer to them as you go through the next group of questions????</span>
</span><span class='line'><span class="c1">;; Do not rush through this book! Read carefully</span>
</span><span class='line'><span class="c1">;;; From the introuduction chapter </span>
</span><span class='line'><span class="c1">;;; else implicit said that if the condition is wrong do it recurly</span>
</span><span class='line'><span class="c1">;;;      also infer that after the recuring ,please go back to home along the Original road!</span>
</span><span class='line'><span class="c1">;;;  COns &#39;s function: save the buffer to the stack</span>
</span><span class='line'><span class="c1">;;;  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;The first part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; The Basic operator</span>
</span><span class='line'><span class="c1">;;;   The primitive variables of scheme ::  car ,cdr(is pronounced as &quot;could_er&quot;,cons,  null? zero?</span>
</span><span class='line'><span class="c1">;;;                                         eq?(compare two non-numericas atoms),</span>
</span><span class='line'><span class="c1">;;;                                         or (or asks two questions,one at a time. If the first one is true</span>
</span><span class='line'><span class="c1">;;;                                         .Otherwise it asks the second question and answers with whatever the </span>
</span><span class='line'><span class="c1">;;;                                         second question answers)</span>
</span><span class='line'><span class="c1">;;;                                         numbers,add1,sub1</span>
</span><span class='line'><span class="c1">;;;  COns &#39;s function: save the buffer to the stack</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">atom?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">pair? </span><span class="nv">x</span><span class="p">))</span> <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">null? </span><span class="nv">x</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;; New added after myracet1.rkt</span>
</span><span class='line'><span class="c1">;;;  I want to find ( a  h fd  fs)  but not ( a h (fd s) fs),so I want to create the lat?</span>
</span><span class='line'><span class="c1">;;;  can you describe what the function lat? does in your own words? *****************</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;  lat? looks at each S-expression in a list ,in turn,and asks if each S-expression </span>
</span><span class='line'><span class="c1">;;;  is an atom ,untill it runs out of S-expression. If it runs out without encountering </span>
</span><span class='line'><span class="c1">;;;  a list,the value is #f. If it finds a list,the value is #f,false</span>
</span><span class='line'><span class="c1">;;;   What is the meaning of the question *else* ??  </span>
</span><span class='line'><span class="c1">;;;             *else* asks if else if true</span>
</span><span class='line'><span class="c1">;;;                is *else* true?  Yes,because the question else is always true!</span>
</span><span class='line'><span class="c1">;;;         so what is (else #f) means?  ----&gt; as if else is true,If else is true--as it always is</span>
</span><span class='line'><span class="c1">;;; else implicit said that if the condition is wrong do it recurly</span>
</span><span class='line'><span class="c1">;;;      also infer that after the recuring ,please go back to home along the Original road!</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;               --then the answer if #f ---false</span>
</span><span class='line'><span class="c1">;;;               In a word:   else is a question whose value is always (implicit)</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">lat?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nf">lat?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="no">#f</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;; New added after myracet1.rkt</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">&gt;</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">m</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">zero? </span><span class="nv">n</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">zero? </span><span class="nv">m</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">&gt; </span><span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">m</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; What is the maning of (&gt; (sub1 n) (sub1 m))</span>
</span><span class='line'><span class="c1">;;;        Recur, but with both arguments reduced by one</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">dd</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">m</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">zero? </span><span class="nv">n</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">zero? </span><span class="nv">m</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">&gt; </span><span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">m</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; Can you describe what leftmost does?</span>
</span><span class='line'><span class="c1">;;;      Here is our description:</span>
</span><span class='line'><span class="c1">;;;       &quot;The function leftmost finds the leftmost atom in a non-empty list of S-expressions that does not</span>
</span><span class='line'><span class="c1">;;;       contain the empty list&quot;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;       Is left a *-function?</span>
</span><span class='line'><span class="c1">;;;            It works on lists of S-expressions,but it only recurs on the car(so no)</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;     Does leftmost need to ask questions about all three possible cases?</span>
</span><span class='line'><span class="c1">;;;       No,it only needs to ask two questions,We agreed that leftmost works on non-empty</span>
</span><span class='line'><span class="c1">;;;       list that don&#39;t contain empty list</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;       So in a word,the two discussed before,1:recur in car(not together with cdr) 2:2 questions ,not 3 questions which S-expressions</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;       Do you remember what (or ...) does?</span>
</span><span class='line'><span class="c1">;;;            (or as questions one at a time until it finds one that is true.Then (or ...) stops,making its value true.</span>
</span><span class='line'><span class="c1">;;;            If it cannot find a true argument,the value of (or...) is false</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;     After so many illustration ,can you put in your own words what (and ....) does</span>
</span><span class='line'><span class="c1">;;;             We put in our words:(lispers&#39; words)</span>
</span><span class='line'><span class="c1">;;;             &quot;(and ...) ask questions one at a time until it finds one whose value is false.Then (and ...) stops with false.</span>
</span><span class='line'><span class="c1">;;;              If none of the expressions are false,(and ...) is true.&quot;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;     Both (and ...) and (or ...) can be expressed as abbreviations of (cond ...)-expressions:</span>
</span><span class='line'><span class="c1">;;;              (and a b) == (cond a b) (else #f))</span>
</span><span class='line'><span class="c1">;;;              (or a b) == (cond (a #t) (else b))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">leftmost</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">leftmost</span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">rember</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">quote</span><span class="p">()))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>              <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))</span>
</span><span class='line'>              <span class="p">(</span><span class="k">else </span>
</span><span class='line'>               <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                     <span class="p">(</span><span class="nf">rember</span> <span class="nv">a</span>
</span><span class='line'>                             <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))))</span>
</span><span class='line'><span class="c1">;;; Can you write number? which is true if its argument is a numerica atom and false if it is anything else</span>
</span><span class='line'><span class="c1">;;;      No:number? like add1,sub1,zero?,car , cdr, cons,null?, eq?,and atom? is a primitive function</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;      Can you write a function no-nums which gives as a final value a lat obtained by removing all the</span>
</span><span class='line'><span class="c1">;;;      numbers from the lat.</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; Remember to use = for numbers</span>
</span><span class='line'><span class="c1">;;;                 eq? for all other atoms(non-numericas atoms)</span>
</span><span class='line'><span class="c1">;;;     eqan? contains two part to compare the two atoms: 1 a number   2:an atom</span>
</span><span class='line'><span class="c1">;;;     Can you assume that all funtions written using eq? can be generalized by replacing eq?</span>
</span><span class='line'><span class="c1">;;;          By eqan?   ------------------Yes,excpet,of course ,for eqan? itself</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">eqan?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a1</span> <span class="nv">a2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nb">number? </span><span class="nv">a1</span><span class="p">)</span> <span class="p">(</span><span class="nb">number? </span><span class="nv">a2</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">= </span><span class="nv">a1</span> <span class="nv">a2</span><span class="p">))</span>
</span><span class='line'>      <span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nb">number? </span><span class="nv">a1</span><span class="p">)</span> <span class="p">(</span><span class="nb">number? </span><span class="nv">a2</span><span class="p">))</span>
</span><span class='line'>       <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">eq? </span><span class="nv">a1</span>  <span class="nv">a2</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;after the introuction of (and  (or   define leftmost</span>
</span><span class='line'><span class="c1">;;; What is eqlist?</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;  It is a function that determines if two lists are equals</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; How many questions will eqlist? have to ask about it arguments?</span>
</span><span class='line'><span class="c1">;;;             Nine  --------------------------------------------------------------&lt;&lt;&lt;&lt;&lt;The first time so many questions!</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Can you explain why there are nine questions?</span>
</span><span class='line'><span class="c1">;;;        Here are out words:</span>
</span><span class='line'><span class="c1">;;;         &quot;Each arguments may be either</span>
</span><span class='line'><span class="c1">;;;             ----empty</span>
</span><span class='line'><span class="c1">;;;             ----an atom consed onto a list,or</span>
</span><span class='line'><span class="c1">;;;             ----a list consed onto a list</span>
</span><span class='line'><span class="c1">;;;        For example,at the same time as the first argument may be the empty list,the </span>
</span><span class='line'><span class="c1">;;;              seconds argument could be the empty list or have an atom or a list in the car position.&quot;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;         Is it okay to asK (atom? (car l2)) in the second question?</span>
</span><span class='line'><span class="c1">;;;               Yes ,because we know that the second  list cannot be empty.otherwise the first question would have been true.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;         And why is the third question (null? l1)???</span>
</span><span class='line'><span class="c1">;;;              At that point ,we know that when the firs argument is empty,the second argument is neither empty list</span>
</span><span class='line'><span class="c1">;;;              nor a list with an atom as the first element .If(null? l1) is true now,the second argument must be a list whose first element</span>
</span><span class='line'><span class="c1">;;;              is also a list.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;         Does this mean the questions (and (null? l1) (null? l2)) and (or (null? l1) (null? l2)) </span>
</span><span class='line'><span class="c1">;;;                suffice to determine the answer in the first three cases?</span>
</span><span class='line'><span class="c1">;;;             Yes .If the first question is true,eqlist? respoinse with #t; otherwise ,the answer if #f</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">eqlist?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l1</span> <span class="nv">l2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nb">null? </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">null? </span><span class="nv">l2</span><span class="p">))</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nb">null? </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l2</span><span class="p">)))</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l1</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l1</span><span class="p">))</span> <span class="p">(</span><span class="nb">null? </span><span class="nv">l2</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l1</span><span class="p">))</span> <span class="p">(</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l2</span><span class="p">)))</span>
</span><span class='line'>       <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">eqan?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l2</span><span class="p">))</span> <span class="p">(</span><span class="nf">eqlist?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l2</span><span class="p">))))</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l1</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l2</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l2</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">eqlist?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l2</span><span class="p">))</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">eqlist?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l2</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">eqlist1?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l1</span> <span class="nv">l2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nb">null? </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">null? </span><span class="nv">l2</span><span class="p">))</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nb">null? </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">null? </span><span class="nv">l2</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l1</span><span class="p">))</span> <span class="p">(</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l2</span><span class="p">)))</span>
</span><span class='line'>       <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">eqan?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l2</span><span class="p">))</span> <span class="p">(</span><span class="nf">eqlist1?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l2</span><span class="p">))))</span>
</span><span class='line'>      <span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l1</span><span class="p">))</span>
</span><span class='line'>           <span class="p">(</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l2</span><span class="p">)))</span>
</span><span class='line'>       <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">eqlist1?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l2</span><span class="p">))</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">eqlist1?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l2</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; So  What is an S-expresssion? </span>
</span><span class='line'><span class="c1">;;;                                    An S-expression is either an atom or a (possibly empty) list of S-expressions.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;      How many questions does equal? ask to determine whether two S-empty are the same?</span>
</span><span class='line'><span class="c1">;;;           Four. The first argument  may be an atom or a list of S-expressions at the same time as the second argument may be</span>
</span><span class='line'><span class="c1">;;;           an atom or a list of S-expressions.</span>
</span><span class='line'><span class="c1">;;; can we summarize the second questions and the third question of the equal? </span>
</span><span class='line'><span class="c1">;;;   as   (or (atom? s1) (atom? s2))</span>
</span><span class='line'><span class="c1">;;;              Yes, we can</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">equal?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">s1</span> <span class="nv">s2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nf">atom?</span> <span class="nv">s1</span><span class="p">)</span> <span class="p">(</span><span class="nf">atom?</span> <span class="nv">s2</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">eqan?</span> <span class="nv">s1</span> <span class="nv">s2</span><span class="p">))</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">s1</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">s2</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">eqlist?</span> <span class="nv">s1</span> <span class="nv">s2</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">equal1?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">s1</span> <span class="nv">s2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nf">atom?</span> <span class="nv">s1</span><span class="p">)</span> <span class="p">(</span><span class="nf">atom?</span> <span class="nv">s2</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">eqan?</span> <span class="nv">s1</span> <span class="nv">s2</span><span class="p">))</span>
</span><span class='line'>      <span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nf">atom?</span> <span class="nv">s1</span><span class="p">)</span> <span class="p">(</span><span class="nf">atom?</span> <span class="nv">s1</span><span class="p">))</span>
</span><span class='line'>       <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">eqlist?</span> <span class="nv">s1</span> <span class="nv">s2</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; The sixth chapter:</span>
</span><span class='line'><span class="c1">;;;    Is 1,3,1+3,1+3*4,cookie,3^y_5 all arithmetic expression?  Yes ,of course</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; What is an arithmetic expression? in your words?</span>
</span><span class='line'><span class="c1">;;;       In ours:</span>
</span><span class='line'><span class="c1">;;;         &quot;For the purpose of this chapter,an arithmetic expression is either an atom</span>
</span><span class='line'><span class="c1">;;;         (including numbers),or two arithmetic expressions combined by +,-,*,/,or expr.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Is (n+3) an arithmetic expression?</span>
</span><span class='line'><span class="c1">;;;        Not really,since there are parentheses around n+3, our definition of arithmetic</span>
</span><span class='line'><span class="c1">;;;        expression does not mention parentheses....</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Could we think of (n+3) as an arithmetic expression?</span>
</span><span class='line'><span class="c1">;;;        Yes if we keep in mind that the parentheses are not really there (the empire&#39;s new clothes)</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; What would you call (n+3)  </span>
</span><span class='line'><span class="c1">;;;                   we call it a representation for n+3</span>
</span><span class='line'><span class="c1">;;;         why is (n+3) a good representation?</span>
</span><span class='line'><span class="c1">;;;                  Because </span>
</span><span class='line'><span class="c1">;;;                          1. (n+3) is an S-expression. </span>
</span><span class='line'><span class="c1">;;;                               It can therefore serve as an argument for a function</span>
</span><span class='line'><span class="c1">;;;                          2.It stucturally resembles n+3</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; True or false: (numbered? x)  True while x is 1</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; How do you represent 3+4*5  ?                      ------&gt; (3+4*5)</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; What is numbered?     </span>
</span><span class='line'><span class="c1">;;;                     It is a function that determines whether a representation? of an arithmetic expression </span>
</span><span class='line'><span class="c1">;;;                      contains only number besides the +,* and expr</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Now you can write a skeleton for numbered?</span>
</span><span class='line'><span class="c1">;;;           (define numbered?</span>
</span><span class='line'><span class="c1">;;;           (lambda (axep)</span>
</span><span class='line'><span class="c1">;;;           (cond </span>
</span><span class='line'><span class="c1">;;;           (_________   _________)</span>
</span><span class='line'><span class="c1">;;;           (_________   _________)</span>
</span><span class='line'><span class="c1">;;;           (_________   _________)</span>
</span><span class='line'><span class="c1">;;;           (_________   _________))))</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; What is the first question?        --------------(atom? axep)</span>
</span><span class='line'><span class="c1">;;; What is (eq? (car (cdr aexp)) (quote +))  ------It is the second question</span>
</span><span class='line'><span class="c1">;;; can you guess the third one (eq? (car (cdr aexp)) (quote *))</span>
</span><span class='line'><span class="c1">;;; And you must know the fourth one.                     (eq? (car (cdr aexp)) (quote )e)</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; why do we ask four,instead of two,  </span>
</span><span class='line'><span class="c1">;;;          questions about the arithmetic expressions?</span>
</span><span class='line'><span class="c1">;;;          after all,arithmetic expressions like (1+3) are lats</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;         ------------------------------Because we consider (1+3) as a representation of an arithmetic expression in </span>
</span><span class='line'><span class="c1">;;;         list form,not as a list itself.And,an arithmetic expression is either a number,or two arithmetic expressions combined</span>
</span><span class='line'><span class="c1">;;;         by + ,*,expr.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">numbered?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">aexp</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">aexp</span><span class="p">)</span> <span class="p">(</span><span class="nb">number? </span><span class="nv">aexp</span><span class="p">))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">aexp</span><span class="p">))</span> <span class="p">(</span><span class="k">quote </span><span class="nv">+</span><span class="p">))</span>
</span><span class='line'>       <span class="o">...</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">aexp</span><span class="p">))</span> <span class="p">(</span><span class="k">quote </span><span class="nv">+</span><span class="p">))</span>
</span><span class='line'>       <span class="o">...</span><span class="p">)</span>
</span><span class='line'>     <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">aexp</span><span class="p">))</span> <span class="p">(</span><span class="k">quote </span><span class="nv">+</span><span class="p">))</span>
</span><span class='line'>       <span class="o">...</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">numbered1?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">aexp</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">aexp</span><span class="p">)</span> <span class="p">(</span><span class="nb">number? </span><span class="nv">aexp</span><span class="p">))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">aexp</span><span class="p">))</span> <span class="p">(</span><span class="k">quote </span><span class="nv">+</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">numbered?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">aexp</span><span class="p">))</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">numbered?</span>
</span><span class='line'>              <span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">aexp</span><span class="p">))))))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">aexp</span><span class="p">))</span> <span class="p">(</span><span class="k">quote </span><span class="nv">+</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">numbered?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">aexp</span><span class="p">))</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">numbered?</span>
</span><span class='line'>              <span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">aexp</span><span class="p">))))))</span>
</span><span class='line'>     <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">aexp</span><span class="p">))</span> <span class="p">(</span><span class="k">quote </span><span class="nv">+</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">numbered?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">aexp</span><span class="p">))</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">numbered?</span>
</span><span class='line'>              <span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">aexp</span><span class="p">)))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; Since aexp was already understood to be an arithmetic expression,could we have written numbered? in a simpler way?</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">defin</span> <span class="nv">numbered2?</span>
</span><span class='line'>       <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">aexp</span><span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>           <span class="p">((</span><span class="nf">atom?</span> <span class="nv">aexp</span><span class="p">)</span> <span class="p">(</span><span class="nb">number? </span><span class="nv">aexp</span><span class="p">))</span>
</span><span class='line'>           <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>             <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">numbered2?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">aexp</span><span class="p">))</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">numbered2?</span>
</span><span class='line'>                    <span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">aexp</span><span class="p">))))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; why can we simplify ??-</span>
</span><span class='line'><span class="c1">;;;                        because we know we&#39;ve got the function right!</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; We want to value the arithmetic expressions? ------------------</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; THe seventh commandments!!</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Recur on the subparts that are of the same nature:</span>
</span><span class='line'><span class="c1">;;;            On the sublists of a list</span>
</span><span class='line'><span class="c1">;;;            on the subexpressions of an arithmetic expression</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; To (3 + 4)    &#39;s value</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">value</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">nexp</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">nexp</span><span class="p">)</span> <span class="nv">nexp</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">nexp</span><span class="p">))</span> <span class="p">(</span><span class="k">quote </span><span class="nv">+</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">car </span><span class="nv">nexp</span><span class="p">))</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">nexp</span><span class="p">))))))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">nexp</span><span class="p">))</span> <span class="p">(</span><span class="k">quote </span><span class="nv">*</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">car </span><span class="nv">nexp</span><span class="p">))</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">nexp</span><span class="p">))))))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">expr</span> <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">car </span><span class="nv">nexp</span><span class="p">))</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">nexp</span><span class="p">)))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; Can you think of a different representation of arithmetic expressions?</span>
</span><span class='line'><span class="c1">;;;          There are several of thme</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;          (3 4 +)</span>
</span><span class='line'><span class="c1">;;;          (+ 3 4)</span>
</span><span class='line'><span class="c1">;;;          (plus 3 4)</span>
</span><span class='line'><span class="c1">;;;          (+ (* 3 6) (expr 8 2))</span>
</span><span class='line'><span class="c1">;;;         TO value (+ 3 4)</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">value1</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">nexp</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">nexp</span><span class="p">)</span> <span class="nv">nexp</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">nexp</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="nv">+</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">value1</span> <span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">nexp</span><span class="p">)))</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">value1</span> <span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">nexp</span><span class="p">))))))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">nexp</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="nv">*</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">value1</span> <span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">nexp</span><span class="p">)))</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">value1</span> <span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">nexp</span><span class="p">))))))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">expr</span> <span class="p">(</span><span class="nf">value1</span> <span class="p">(</span><span class="nb">car </span><span class="nv">nexp</span><span class="p">))</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">value1</span> <span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">nexp</span><span class="p">)))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;(1 2) is not a arithmetic expressions ,so we  violated The Seventh Commandments. (1 3) is not a subpart that is </span>
</span><span class='line'><span class="c1">;;;   representation of an arithmetic expression! We obviosuly  recurred on a list.But,remember,not alll lists are representations</span>
</span><span class='line'><span class="c1">;;;   of arithmetic expressions. We have to recur subexpressions.</span>
</span><span class='line'><span class="c1">;;;   (3) is the (cdr (cdr nexp)) ,but (3) is not an arithmetic expressions,because there are no parentheses in our </span>
</span><span class='line'><span class="c1">;;;   definition of the arithmetic expressions.</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="mi">1</span><span class="nv">st-sub-exp</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">aexp</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">aexp</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; why do we ask else,</span>
</span><span class='line'><span class="c1">;;;                   because the first question is also the last question</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Can we get by without (cons. ..) if we don&#39;t need to ask questions?</span>
</span><span class='line'><span class="c1">;;;        Yes remember one-liners from chapter4</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="mi">1</span><span class="nv">st-sub-exp1</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">aexp</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">aexp</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="mi">2</span><span class="nv">nd-sub-exp</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">aexp</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">aexp</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">operator</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">aexp</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">car </span><span class="nv">aexp</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">value2</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">nexp</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">nexp</span><span class="p">)</span> <span class="nv">nexp</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nf">operator</span> <span class="nv">nexp</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="nv">+</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="mi">1</span><span class="nv">st-sub-exp1</span> <span class="nv">nexp</span><span class="p">))</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="mi">2</span><span class="nv">nd-sub-exp</span> <span class="nv">nexp</span><span class="p">))))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nf">operator</span> <span class="nv">nexp</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="nv">+</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="mi">1</span><span class="nv">st-sub-exp1</span> <span class="nv">nexp</span><span class="p">))</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="mi">2</span><span class="nv">nd-sub-exp</span> <span class="nv">nexp</span><span class="p">))))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">expr</span> <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="mi">1</span><span class="nv">st-sub-exp1</span> <span class="nv">nexp</span><span class="p">))</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="mi">2</span><span class="nv">nd-sub-exp</span> <span class="nv">nexp</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; so it we chang the (define operator ) and (1st-sub-exp1) exchangeabley ,the different form of arithmetic expressioned.</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;       ********************************************************************************</span>
</span><span class='line'><span class="c1">;;; The Eighth Commandments:</span>
</span><span class='line'><span class="c1">;;;       Use help functions to abstract from representation</span>
</span><span class='line'><span class="c1">;;;       ********************************************************************************</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;       Have we seen representation? before</span>
</span><span class='line'><span class="c1">;;;                                      Yes ,we just did not tell you that were representations.</span>
</span><span class='line'><span class="c1">;;;                             For what entities have we used representations?</span>
</span><span class='line'><span class="c1">;;;                             Truth-values!  Numbers!</span>
</span><span class='line'><span class="c1">;;;                                              Numbers are representations?</span>
</span><span class='line'><span class="c1">;;;                                                    Yes ,for example 4 stands for the concpet four. we close the symbol because</span>
</span><span class='line'><span class="c1">;;;                                                    we are accustomed to arabic representation.</span>
</span><span class='line'><span class="c1">;;;                                              What else could we have used?</span>
</span><span class='line'><span class="c1">;;;                                                (() () () ())  would have serve just as well</span>
</span><span class='line'><span class="c1">;;;                                                what about  (((((((())))))))?  How about (I V)&quot;</span>
</span><span class='line'><span class="c1">;;;                                         Do you know how many primitives we need for numbers?</span>
</span><span class='line'><span class="c1">;;;                                          Four: number? ,zero?, add1,and sub1-------------------------------------------&lt;</span>
</span><span class='line'><span class="c1">;;;                                                            ****Do You know how many primitives we need for list?</span>
</span><span class='line'><span class="c1">;;;                                                                   Four:   atom? null? car cdr</span>
</span><span class='line'><span class="c1">;;;                                         Let&#39;s try anouther representation for numbers. How shall we represent zero now/</span>
</span><span class='line'><span class="c1">;;;                                                       () is our choice</span>
</span><span class='line'><span class="c1">;;;                                         How is one represented?</span>
</span><span class='line'><span class="c1">;;;                                                       (()) </span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;                                         How is two represented?</span>
</span><span class='line'><span class="c1">;;;                                                       (() () )</span>
</span><span class='line'><span class="c1">;;;                                          Got it,What&#39;s Three?</span>
</span><span class='line'><span class="c1">;;;                                                       (() () ())</span>
</span><span class='line'><span class="c1">;;; So now write thefunction to test zero</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">sero?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">null? </span><span class="nv">n</span><span class="p">)))</span>
</span><span class='line'><span class="c1">;;; write a function that is like add1</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">edd1</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="k">quote </span><span class="p">())</span> <span class="nv">n</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;what about sub1</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">zub1</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">cdr </span><span class="nv">n</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; so we can rewrite +</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">plus</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">m</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">sero?</span> <span class="nv">m</span><span class="p">)</span> <span class="nv">n</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">edd1</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">n</span> <span class="p">(</span><span class="nf">zub1</span> <span class="nv">m</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; but what&#39;s lat????t</span>
</span><span class='line'><span class="c1">;;;(define lat?</span>
</span><span class='line'><span class="c1">;;;  (lambda (l)</span>
</span><span class='line'><span class="c1">;;;  (cond</span>
</span><span class='line'><span class="c1">;;;      ((null? l) #t)</span>
</span><span class='line'><span class="c1">;;;      ((atom? (car l)) (lat? (cdr l)))</span>
</span><span class='line'><span class="c1">;;;      (else #f))))</span>
</span><span class='line'><span class="c1">;;; So (lat? (1 2 3))     why did you ask???  but now (lat? ((()) (()()) (()()()))) It is very false,!!!</span>
</span><span class='line'><span class="c1">;;;                                                 So you must beware of shadows!!!bugs implicit!!</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;                         </span>
</span><span class='line'><span class="c1">;;; Why dow we ask (number? aexp) when we know that aexp is an atom?</span>
</span><span class='line'><span class="c1">;;;                   Because we want to know if all arithmetic expressions that are atoms are numbers</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; Does equal1? ask enough questions? --The first commandments!!  </span>
</span><span class='line'><span class="c1">;;;              Yes,The questions cover all four possible cases</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;; Now rewrite the eqlist? using equal???                --------------equal? is the most common ,which  S-expression as the arguments</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">eqlist1?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l1</span> <span class="nv">l2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nb">null? </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">null? </span><span class="nv">l2</span><span class="p">))</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nb">null? </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">null? </span><span class="nv">l2</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nb">equal? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l2</span><span class="p">))</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">eqlist?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l2</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;; THe sixth Commandments</span>
</span><span class='line'><span class="c1">;;;     Simplify  only  after the function is correct.   ---------------------------------&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;; Can you describe what (rember1 a lat) do?</span>
</span><span class='line'><span class="c1">;;;          It takes an atom and a lat as its *arguments*,and makes a new *lat*</span>
</span><span class='line'><span class="c1">;;;          with the *first* occurrence of the atom in the old lat removed</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;     How do we(lispers,implicitly) ask questions?</span>
</span><span class='line'><span class="c1">;;;            By using</span>
</span><span class='line'><span class="c1">;;;                   (cond</span>
</span><span class='line'><span class="c1">;;;                     (__________     ____________)</span>
</span><span class='line'><span class="c1">;;;                     (__________     ____________)</span>
</span><span class='line'><span class="c1">;;;                     (__________     ____________)</span>
</span><span class='line'><span class="c1">;;;                     ...</span>
</span><span class='line'><span class="c1">;;;                     (__________     ____________)).</span>
</span><span class='line'><span class="c1">;;;     How do we  remove the first occurrence of a in the rest of lat?</span>
</span><span class='line'><span class="c1">;;;             (rember a (cdr lat))</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Write down the function rember and its arguments, and refer to them as you go</span>
</span><span class='line'><span class="c1">;;; through the next sequence of questions(the unit test)</span>
</span><span class='line'><span class="c1">;;;    In our words:</span>
</span><span class='line'><span class="c1">;;;              &quot;The function rember checked each atom of the lat , one at a time,</span>
</span><span class='line'><span class="c1">;;;               to see if it was the same  as the atom &#39;and&#39;.If the car was not the</span>
</span><span class='line'><span class="c1">;;;               same as the atom, we saved it to be consed to the final value later.</span>
</span><span class='line'><span class="c1">;;;               when rember found the atom &#39;and&#39;,it dropped it ,and consed the previous</span>
</span><span class='line'><span class="c1">;;;               atoms back onto the rest of the lat</span>
</span><span class='line'><span class="c1">;;;  ---------------------------------cons --------------------------------------</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">rember</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="nv">cond</span>
</span><span class='line'>            <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))</span>
</span><span class='line'>            <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                        <span class="p">(</span><span class="nf">rember</span> <span class="nv">a</span>
</span><span class='line'>                                <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; Can you rewrite rember so that it reflects the abouve description</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">rembersimple</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">rember</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;;  What is the meaning of the  (cons (car lat) (rember a (cdr lat))) </span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;           This says to refer to the funciton rember but with the </span>
</span><span class='line'><span class="c1">;;;           argument lat replaced by (cdr lat) and  that after we arrive at a value for</span>
</span><span class='line'><span class="c1">;;;           (rember a (cdr lat)) we must cons (car lat) --bacon --onto it</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;           This also says we recur using the function rember, with the argument lat</span>
</span><span class='line'><span class="c1">;;;           replaced by (cdr lat),and that after we arrive at a value for (rember a (cdr lat))</span>
</span><span class='line'><span class="c1">;;;           we must cons (car lat)---lettuce --onto it</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Here is rember1  after we replace lat by a list l of S-expression </span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">rember1</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">s</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">quote</span><span class="p">()))</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>         <span class="p">((</span><span class="nb">equal? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">s</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>             <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span>
</span><span class='line'>                         <span class="p">(</span><span class="nf">rember1</span> <span class="nv">s</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>         <span class="p">((</span><span class="nb">equal? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">s</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span> <span class="p">))</span>
</span><span class='line'>         <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span>
</span><span class='line'>                     <span class="p">(</span><span class="nf">rember1</span> <span class="nv">s</span>
</span><span class='line'>                             <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))))</span>
</span><span class='line'><span class="c1">;;;  And how does that differ?</span>
</span><span class='line'><span class="c1">;;;        The funciton rember now removes the first matching S-expression s in l,</span>
</span><span class='line'><span class="c1">;;;                  instead of the first matching atom a in lat.</span>
</span><span class='line'><span class="c1">;;;    Is rember a  &quot;star&quot; function now? </span>
</span><span class='line'><span class="c1">;;;             NO.</span>
</span><span class='line'><span class="c1">;;;     Why not?</span>
</span><span class='line'><span class="c1">;;;          because rember recurs with the cdr of l only (not togeterh with the car of l ,,correspoding to (define leftmost)</span>
</span><span class='line'><span class="c1">;;;; can we simplify rember1 ?</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">rember2</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">s</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">quote</span><span class="p">()))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span>
</span><span class='line'>       <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>         <span class="p">((</span><span class="nb">equal? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">s</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>          <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">rember2</span> <span class="nv">s</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span><span class="mi">0</span><span class="p">))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; Can rember2 be further simplified????????????????????????</span>
</span><span class='line'><span class="c1">;;;   Yes,the inner(cond...) asks questions that the outer(cond...) could ask1</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">rember3</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">s</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">equal? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">s</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">rember3</span> <span class="nv">s</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; &quot;...*&quot; makes us think &quot;oh my gawd&quot;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">rember*</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span> <span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>        <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">rember*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))</span>
</span><span class='line'>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span>
</span><span class='line'>                    <span class="p">(</span><span class="nf">rember*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">rember*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">rember*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'><span class="c1">;; Notice that now we are recurring down the car of the list,instead of just the cdr of the list</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">insertL</span>
</span><span class='line'>       <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>           <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>           <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>                   <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">old</span><span class="p">)</span>
</span><span class='line'>                    <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span>
</span><span class='line'>                          <span class="p">(</span><span class="nb">cons </span><span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))</span>
</span><span class='line'>                   <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                               <span class="p">(</span><span class="nf">insertL</span> <span class="nv">new</span> <span class="nv">old</span>
</span><span class='line'>                                        <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;; after ------------------------------------&lt;the (define firsts  </span>
</span><span class='line'><span class="c1">;;;In your own words, what does (insertR new old lat) do?</span>
</span><span class='line'><span class="c1">;;;     In our words:</span>
</span><span class='line'><span class="c1">;;;             &quot;It takes three arguments: the atoms new  and old,and lat.</span>
</span><span class='line'><span class="c1">;;;             The function insertR builds a lat with new inserted to the</span>
</span><span class='line'><span class="c1">;;;             right of the *first* occurence of old</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;     Which arguments changes when we recur with insertR?</span>
</span><span class='line'><span class="c1">;;;           lat, because we can only  look at one of its atoms at a time.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;     Which questions do we ask?</span>
</span><span class='line'><span class="c1">;;;       First, we ask (null? lat) .Second we ask else,because else is </span>
</span><span class='line'><span class="c1">;;;       always the last question.</span>
</span><span class='line'><span class="c1">;;;     Which questions do we ask about the first elements?????? Still rember the typical element</span>
</span><span class='line'><span class="c1">;;;       in the (define firsts)</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;     First,we ask (eq? (car lat) old ) .Then we ask else,because there are no other interesting cases</span>
</span><span class='line'><span class="c1">;;;  </span>
</span><span class='line'><span class="c1">;;;  COns &#39;s function: save the buffer to the stack</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;  I want to write an procedure: which sort the list  afterwards?</span>
</span><span class='line'><span class="c1">;;;            So I want the change the function&#39; return value?????????????????????????</span>
</span><span class='line'><span class="c1">;;;            What I should do??</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">insertR</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>              <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">old</span><span class="p">)</span>
</span><span class='line'>               <span class="p">(</span><span class="nb">cons </span><span class="nv">old</span>
</span><span class='line'>                     <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))</span>
</span><span class='line'>              <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                           <span class="p">(</span><span class="nf">insertR</span> <span class="nv">new</span> <span class="nv">old</span>
</span><span class='line'>                                    <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;; after the (define makeset1)</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">subset</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>              <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">old</span><span class="p">)</span>
</span><span class='line'>               <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))</span>
</span><span class='line'>              <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                          <span class="p">(</span><span class="nf">subset</span> <span class="nv">new</span> <span class="nv">old</span>
</span><span class='line'>                                  <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">subset2</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">o1</span> <span class="nv">o2</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>              <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">o1</span><span class="p">)</span>
</span><span class='line'>               <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))</span>
</span><span class='line'>              <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">o2</span><span class="p">)</span>
</span><span class='line'>               <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))</span>
</span><span class='line'>              <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                          <span class="p">(</span><span class="nf">subset2</span> <span class="nv">new</span> <span class="nv">o1</span> <span class="nv">o2</span>
</span><span class='line'>                                   <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">rember5</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">rember5</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">factorial</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&lt;= </span><span class="nv">x</span> <span class="mi">1</span><span class="p">)</span> <span class="mi">1</span>
</span><span class='line'>          <span class="p">(</span><span class="nb">* </span><span class="nv">x</span> <span class="p">(</span><span class="nf">factorial</span> <span class="p">(</span><span class="nb">- </span><span class="nv">x</span> <span class="mi">1</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;;  after rember ---------------------------------------------------&lt;&lt;&lt;&lt;&lt;</span>
</span><span class='line'><span class="c1">;;; In  your own words , what does (firsts l) do</span>
</span><span class='line'><span class="c1">;;;          We tried the following:</span>
</span><span class='line'><span class="c1">;;;          &quot;The function firsts takes one argument, a list,which is either</span>
</span><span class='line'><span class="c1">;;;          a null list or contains only non-empty lists. It builds another list</span>
</span><span class='line'><span class="c1">;;;          composed of the first S-expression(atom or list  or pair) of each internal list</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;          REMEMBER THe Commandments</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;          Why (define firsts</span>
</span><span class='line'><span class="c1">;;;                 (lambda (l)</span>
</span><span class='line'><span class="c1">;;;                  ...)                     Because we always state the function name,(lambda,and the </span>
</span><span class='line'><span class="c1">;;;                                           argument(s) of the function</span>
</span><span class='line'><span class="c1">;;;          Why (cond ...)</span>
</span><span class='line'><span class="c1">;;;                                           Because we need to ask questions about the actual arguments</span>
</span><span class='line'><span class="c1">;;;          Why ((null? l) ...)</span>
</span><span class='line'><span class="c1">;;;                                           The first Commandments</span>
</span><span class='line'><span class="c1">;;;          Why (else</span>
</span><span class='line'><span class="c1">;;;                                           Because we only have two equstions to ask about the list l:</span>
</span><span class='line'><span class="c1">;;;                                                      either It is the null list,</span>
</span><span class='line'><span class="c1">;;;                                                                or it contains at least one non-empty list.</span>
</span><span class='line'><span class="c1">;;;                                                 And Because the last question is always else</span>
</span><span class='line'><span class="c1">;;;         Why (cons </span>
</span><span class='line'><span class="c1">;;;                                           Because we are building  a lsit  -----The second commandments</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;         Why (firsts (cdr l)) </span>
</span><span class='line'><span class="c1">;;;                                           Because we can only  look at one S-expression at at time .</span>
</span><span class='line'><span class="c1">;;;                                                   To look at the rest,we must recur</span>
</span><span class='line'><span class="c1">;;;         why )))</span>
</span><span class='line'><span class="c1">;;;                                           Because these are the matching  parentheses for (cond, (lambda,</span>
</span><span class='line'><span class="c1">;;;                                           and (define, and they always appear at the end of a function </span>
</span><span class='line'><span class="c1">;;;                                           definition</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;        When we find a typical element of (firsts l) </span>
</span><span class='line'><span class="c1">;;;                 what do we do with it?</span>
</span><span class='line'><span class="c1">;;;                                       --cons it onto the recursion --(firsts (cdr l))</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;     The third commandments :</span>
</span><span class='line'><span class="c1">;;;                 When building a list, describe the first typical element,and then cons it onto the natural recursion</span>
</span><span class='line'><span class="c1">;;;         So What is the first typical element?</span>
</span><span class='line'><span class="c1">;;;                             -----------------------&gt;  In the (define firsts  The typical element is (car (car l))</span>
</span><span class='line'><span class="c1">;;;            What  is the natural recursion?</span>
</span><span class='line'><span class="c1">;;;                            -----------------------&gt; (firsts (cdr l))</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;             ****************************we are still missing one important ingredient in our recipe!</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;             So what is the meaning of (cons (car (car l))  (firsts (cdr l)))</span>
</span><span class='line'><span class="c1">;;;                           Save (car (car l)) ,and recur with (firsts (cdr l))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">firsts</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">firsts</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">multirember</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>         <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">multirember</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))</span>
</span><span class='line'>         <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                     <span class="p">(</span><span class="nf">multirember</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))))</span>
</span><span class='line'><span class="c1">;;; What is the meaning of (cons (car lat) (multirember a (cdr lat)))</span>
</span><span class='line'><span class="c1">;;;  Save (car lat) ---coffee ---- to be consed onto the value of (multirember a (cdr lat)) later</span>
</span><span class='line'><span class="c1">;;;  Now determine (multirember a (cdr lat))</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;  THe Fourth commandments:</span>
</span><span class='line'><span class="c1">;;;         Always change at least one arguments while recuring.It must be changed to be closer to </span>
</span><span class='line'><span class="c1">;;;         termination.The changing argument must be tested in the termination condition:</span>
</span><span class='line'><span class="c1">;;;                   When using cdr, test termination with null?, such as (null? lat)  lat is the </span>
</span><span class='line'><span class="c1">;;;                   changing argument,so it occur in the terminal condition.</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">multiinsertR</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span>
</span><span class='line'>       <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>         <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">old</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span>
</span><span class='line'>                      <span class="p">(</span><span class="nf">multiinsertR</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))</span>
</span><span class='line'>         <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                     <span class="p">(</span><span class="nf">multiinsertR</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">multiinsertL</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span>
</span><span class='line'>       <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>         <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">old</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span>
</span><span class='line'>                <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                      <span class="p">(</span><span class="nf">multiinsertL</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))</span>
</span><span class='line'>         <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                     <span class="p">(</span><span class="nf">multiinsertL</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">multisubset</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>         <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">old</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">multisubset</span> <span class="nv">new</span> <span class="nv">old</span>
</span><span class='line'>                             <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>          <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">multisubset</span> <span class="nv">new</span> <span class="nv">old</span>
</span><span class='line'>                             <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">add1</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="mi">1</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">sub1</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">- </span><span class="nv">x</span> <span class="mi">1</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">; (define +</span>
</span><span class='line'><span class="c1">;   (lambda (n m)</span>
</span><span class='line'><span class="c1">;     (cond </span>
</span><span class='line'><span class="c1">;       ((zero? m) n)</span>
</span><span class='line'><span class="c1">;       (else (add1 (+ n (sub1 m)))))))</span>
</span><span class='line'><span class="c1">; </span>
</span><span class='line'><span class="c1">; (define -</span>
</span><span class='line'><span class="c1">;   (lambda (n m)</span>
</span><span class='line'><span class="c1">;     (cond </span>
</span><span class='line'><span class="c1">;       ((zero? m) n)</span>
</span><span class='line'><span class="c1">;       (else (sub1 (- n (sub1 m)))))))</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">;;;  Can you describe how (- n m) works??</span>
</span><span class='line'><span class="c1">;;;    It takes two numbers as arguments,and reduces the second until it hits zeros.</span>
</span><span class='line'><span class="c1">;;;    It subtracts one from the result as many times as it did to cause the second </span>
</span><span class='line'><span class="c1">;;;    one to reach zero!!!</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;if add the box above the wrong to the expr define</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;  What is the natural terminal condition for a list?</span>
</span><span class='line'><span class="c1">;;;              (null? l)</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;  What is the natural terminal conditon for a tup?</span>
</span><span class='line'><span class="c1">;;;              (null? tup)</span>
</span><span class='line'><span class="c1">;;;              </span>
</span><span class='line'><span class="c1">;;; When we build a number from a list of numbers, what should the terminal condition line look like?</span>
</span><span class='line'><span class="c1">;;;               ((null? tup) 0)  ,just as ((null? l) (quote ()))  is ofter the terminal conditon line</span>
</span><span class='line'><span class="c1">;;;               for lists</span>
</span><span class='line'><span class="c1">;;;     So what is the terminal condition line of addtup?</span>
</span><span class='line'><span class="c1">;;;           What does addtup do?</span>
</span><span class='line'><span class="c1">;;;             It builds a number by totalling all the numbers in its arguments</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; What is used in the natural recursion on a list?</span>
</span><span class='line'><span class="c1">;;;       (cdr lat)</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; What is used in the natural recursion on a tup?</span>
</span><span class='line'><span class="c1">;;;        (cdr tup)</span>
</span><span class='line'><span class="c1">;;; Why?</span>
</span><span class='line'><span class="c1">;;;      Because the rest of a non-empty list is a list</span>
</span><span class='line'><span class="c1">;;;              The rest of a non-empty tup  is a tup</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; How is a number defined?</span>
</span><span class='line'><span class="c1">;;;    It is either zero or it is one added to a res,</span>
</span><span class='line'><span class="c1">;;;           where rest is again  a number</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; what is  the natural terminal condition for numbers?</span>
</span><span class='line'><span class="c1">;;;         (zero? n)</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; What is the natural recursion on a number? (sub1 n)            (Cdr tup)  (cdr l)</span>
</span><span class='line'><span class="c1">;;;        (how many questions do we need to ask about a number?   ---------------&lt; two</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;        So The first commandments(revision)</span>
</span><span class='line'><span class="c1">;;;          When recurring on a list of atoms,lat, ask two questions about it: (null? lat) and else</span>
</span><span class='line'><span class="c1">;;;          When recurring on a number,n ,as two questions about it:(zero? n) and else</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;    and What is the terminal condition line of addtup</span>
</span><span class='line'><span class="c1">;;;           ((null? tup) 0)</span>
</span><span class='line'><span class="c1">;;; So what is the natural recursion for addtup?</span>
</span><span class='line'><span class="c1">;;;           (addtup (cdr tup))</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;     what does addtup use to build a number?</span>
</span><span class='line'><span class="c1">;;;               It uses + , because + builds numbers, too!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">addtup</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">tup</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">tup</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">car </span><span class="nv">tup</span><span class="p">)</span> <span class="p">(</span><span class="nf">addtup</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">tup</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'>       <span class="c1">;;(cons (car tup) (addtup (cdr tup)))))))   The last line of function rember is the similar to the one in the addtup!!!!</span>
</span><span class='line'>       <span class="c1">;;</span>
</span><span class='line'><span class="c1">;;;; The fourth commandments(revision)</span>
</span><span class='line'><span class="c1">;;;  Always change at least one arguments while recurring. It must be changed to be closer to termination.The changing argument must</span>
</span><span class='line'><span class="c1">;;;  be tested in the termination condition:</span>
</span><span class='line'><span class="c1">;;;         when using cdr, test termination with  null? and</span>
</span><span class='line'><span class="c1">;;;         when using sub1, test termination with zero</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">expr</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">m</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">zero? </span><span class="nv">m</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">* </span><span class="nv">n</span> <span class="p">(</span><span class="nf">expr</span> <span class="nv">n</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">m</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">multiplication</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">m</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">zero? </span><span class="nv">m</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">+ </span><span class="nv">n</span> <span class="p">(</span><span class="nf">multiplication</span> <span class="nv">n</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">m</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">divide</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span> <span class="nv">n</span> <span class="nv">m</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">&lt; </span><span class="nv">n</span> <span class="nv">m</span> <span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">divide</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="nv">m</span><span class="p">)</span> <span class="nv">m</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">pick</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">zero? </span><span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">))</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">pick</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; Can you write number? which is true if its argument is a numerica atom and false if it is anything else</span>
</span><span class='line'><span class="c1">;;;      No:number? like add1,sub1,zero?,car , cdr, cons,null?, eq?,and atom? is a primitive function</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;      Can you write a function no-nums which gives as a final value a lat obtained by removing all the</span>
</span><span class='line'><span class="c1">;;;      numbers from the lat.</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; after (define rempick)  --------------------------------------------&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">no-nums</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>         <span class="p">((</span><span class="nb">number? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">no-nums</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))</span>
</span><span class='line'>         <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                     <span class="p">(</span><span class="nf">no-nums</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">all-nums</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span>
</span><span class='line'>       <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>         <span class="p">((</span><span class="nb">number? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
</span><span class='line'>          <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">all-nums</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))</span>
</span><span class='line'>         <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">all-nums</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;;     after the define of eqan? (define eqan?)</span>
</span><span class='line'><span class="c1">;;;what does occur do?</span>
</span><span class='line'><span class="c1">;;;        the function occur which counts the number of times an atom a appears in a lat</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">occur</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>         <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">occur</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))</span>
</span><span class='line'>         <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">occur</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">one?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">zero? </span><span class="nv">n</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">zero? </span><span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">one1?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">(</span><span class="nb">= </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="no">#f</span><span class="p">))))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">one11?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">= </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)))</span>
</span><span class='line'><span class="c1">;;; Guess how we can further simplify this  function ,maing it a one-liner</span>
</span><span class='line'><span class="c1">;;;       By removing the (cond )clause.</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">negativeone?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">zero? </span><span class="nv">n</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">zero? </span><span class="p">(</span><span class="nf">add1</span> <span class="nv">n</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">rember*</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>         <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">rember*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))</span>
</span><span class='line'>         <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span>
</span><span class='line'>                     <span class="p">(</span><span class="nf">rember*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))</span>
</span><span class='line'>     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">rember*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>           <span class="p">(</span><span class="nf">rember*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; After rember*            (define rember*) -----------------------------------------&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
</span><span class='line'><span class="c1">;;; How are insertR* and rember* similar?</span>
</span><span class='line'><span class="c1">;;;        0--------------------Each function asks three questions,. Each function recurs on the car</span>
</span><span class='line'><span class="c1">;;;                  of its argument when it finds out that the argument&#39;s car is a list</span>
</span><span class='line'><span class="c1">;;;                  namely,They both recur with car,whenever the car is alist,as well as with the cdr</span>
</span><span class='line'><span class="c1">;;; ******************************************************************************************************************</span>
</span><span class='line'><span class="c1">;;;        The first commandments(Final version)</span>
</span><span class='line'><span class="c1">;;;          When recurring on  a list of atoms,lat,ask two questions about it:</span>
</span><span class='line'><span class="c1">;;;                       (null? lat) and else</span>
</span><span class='line'><span class="c1">;;;          When recurring on a number,n ,ask two questions about it:</span>
</span><span class='line'><span class="c1">;;;                       (zero? n) and else.</span>
</span><span class='line'><span class="c1">;;;          When recurring on a list of S-expression,l ,ask three questtion,about it:</span>
</span><span class='line'><span class="c1">;;;                       (null? l),(atom? (car l)) , and else</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; ******************************************************************************************************************</span>
</span><span class='line'><span class="c1">;;; How are rember* and multirember different?</span>
</span><span class='line'><span class="c1">;;;         The function multirember does not recur with the car. The function rember* recurs with the car when if</span>
</span><span class='line'><span class="c1">;;;           finds out that the car is a list</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; So how are all *-functions similar?</span>
</span><span class='line'><span class="c1">;;;          They all ask three questions and recur with the car as well as   with the cdr,whenever the car is a list</span>
</span><span class='line'><span class="c1">;;;          Why?</span>
</span><span class='line'><span class="c1">;;;                             Because all *-functions work on lists that are either </span>
</span><span class='line'><span class="c1">;;;                                                                      ---empty</span>
</span><span class='line'><span class="c1">;;;                                                                      ---an atom consed onto a list,or</span>
</span><span class='line'><span class="c1">;;;                                                                      ---a list consed onto a list</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; ******************************************************************************************************************</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;         TheFourthe commandments(final version)</span>
</span><span class='line'><span class="c1">;;;             Always change at least one argument while recurring. </span>
</span><span class='line'><span class="c1">;;;              when recurring on alist of atoms, lat,use (cdr lat.</span>
</span><span class='line'><span class="c1">;;;              When recurring on a number,n ,use (sub1 n). And  </span>
</span><span class='line'><span class="c1">;;;              when recurring on a list of S-expressions,l,use (car l) and (cdr l) if neither (null? l) nor (atom? (car l) are true</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;              It must be changed to be closer to termination. The changing argument must be tested in the termination condition:</span>
</span><span class='line'><span class="c1">;;;                     When using cdr, test termination with null? and</span>
</span><span class='line'><span class="c1">;;;                     When using sub1, test termination with zero?</span>
</span><span class='line'><span class="c1">;;; ******************************************************************************************************************</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">insertR*</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>         <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">old</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="nb">cons </span><span class="nv">old</span>
</span><span class='line'>                <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nf">insertR*</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))</span>
</span><span class='line'>         <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span>
</span><span class='line'>                     <span class="p">(</span><span class="nf">insertR*</span> <span class="nv">new</span> <span class="nv">old</span>
</span><span class='line'>                               <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))</span>
</span><span class='line'>       <span class="p">(</span><span class="k">else </span><span class="nv">cons</span> <span class="p">(</span><span class="nf">insertR*</span> <span class="nv">new</span> <span class="nv">old</span>
</span><span class='line'>                            <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>             <span class="p">(</span><span class="nf">insertR*</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; </span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">insertL*</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>         <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">old</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span>
</span><span class='line'>                <span class="p">(</span><span class="nb">cons </span><span class="nv">old</span> <span class="p">(</span><span class="nf">insertR*</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))</span>
</span><span class='line'>         <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span>
</span><span class='line'>                     <span class="p">(</span><span class="nf">insertL*</span> <span class="nv">new</span> <span class="nv">old</span>
</span><span class='line'>                               <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))</span>
</span><span class='line'>       <span class="p">(</span><span class="k">else </span><span class="nv">cons</span> <span class="p">(</span><span class="nf">insertL*</span> <span class="nv">new</span> <span class="nv">old</span>
</span><span class='line'>                            <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>             <span class="p">(</span><span class="nf">insertL*</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">occur*</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span> <span class="mi">0</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>         <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">occur*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))</span>
</span><span class='line'>         <span class="p">(</span><span class="k">else </span>
</span><span class='line'>          <span class="p">(</span><span class="nf">occur*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">occur*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">occur*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;;</span>
</span><span class='line'><span class="c1">;;;  I introuduce how the (or (null? l) (atom? a))  works,Then I can go on </span>
</span><span class='line'><span class="c1">;;;    introuducing the member</span>
</span><span class='line'><span class="c1">;;; else implicit said that if the condition is wrong do it recurly</span>
</span><span class='line'><span class="c1">;;;      also infer that after the recuring ,please go back to home along the Original road!</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">member*</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
</span><span class='line'>           <span class="p">(</span><span class="nf">member*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nf">member*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>           <span class="p">(</span><span class="nf">member*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; The function tells:</span>
</span><span class='line'><span class="c1">;;;          (condition return values)</span>
</span><span class='line'><span class="c1">;;; Can you write down the definition of the function member? and its arguments</span>
</span><span class='line'><span class="c1">;;;     and refer to them as you go through the next group of questions????</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">member?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">member?</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">first</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">p</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span><span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">car </span><span class="nv">p</span><span class="p">)))))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">second</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">p</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">p</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;;Could  after (define subset? )        write a function (intersect?)</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">intersect?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set1</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">set1</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>          <span class="p">((</span><span class="nf">member?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="k">else </span>
</span><span class='line'>            <span class="p">(</span><span class="nf">intersect?</span>
</span><span class='line'>              <span class="p">(</span><span class="nb">cdr </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">intersect1?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set1</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">set1</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">member?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span>
</span><span class='line'>            <span class="p">(</span><span class="nf">intersect1?</span>
</span><span class='line'>              <span class="p">(</span><span class="nb">cdr </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)))))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">intersect2?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set1</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">set1</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nf">member?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">intersect1?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">intersect</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set1</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">set1</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">member?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">set1</span><span class="p">)</span>
</span><span class='line'>             <span class="p">(</span><span class="nf">intersect</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">intersect</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)))))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">intersect</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set1</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">set1</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">member?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">set1</span><span class="p">)</span>
</span><span class='line'>             <span class="p">(</span><span class="nf">intersect</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">intersect</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;; In our words: It is a function that return s all the atoms</span>
</span><span class='line'><span class="c1">;;;in set1 that are not in the set2,That is ,xxx is the (set) difference functions=</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">xxx</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set1</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">set1</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">member?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">xxx</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">set1</span><span class="p">)</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">xxx</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">instersectall</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l-set</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">l-set</span><span class="p">))</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l-set</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">interset</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l-set</span><span class="p">)</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">intersectall</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l-set</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">union</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set1</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">null? </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>       <span class="p">((</span><span class="nf">member?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">union</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">set1</span><span class="p">)</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">union</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set1</span><span class="p">)</span> <span class="p">(</span><span class="nf">set2</span><span class="p">)))))))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">build</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">s1</span> <span class="nv">s2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="nv">s1</span>
</span><span class='line'>                  <span class="p">(</span><span class="nb">cons </span><span class="nv">s2</span> <span class="p">(</span><span class="k">quote </span><span class="p">())))))))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;The first part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;The second part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;;;;;  myracet2.rkt ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;Can you write a function  insert-g that would insert either at the left or at the right!!</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;Which pieces differ?</span>
</span><span class='line'><span class="c1">;;;              The second lines differ from each other ,In insertL it is:</span>
</span><span class='line'><span class="c1">;;;               ((eq? (car l) old)</span>
</span><span class='line'><span class="c1">;;;                (cons new (cons old (cdr l))))</span>
</span><span class='line'><span class="c1">;;;               But in the insertR it is:</span>
</span><span class='line'><span class="c1">;;;               ((eq? (car l) old)</span>
</span><span class='line'><span class="c1">;;;                (cons new (cons old (cdr l))))</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;         Put the difference in words!</span>
</span><span class='line'><span class="c1">;;;               We say:</span>
</span><span class='line'><span class="c1">;;;                      &quot;The two functions cons old and new in a different order onto the cdr of the list l</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;         So how can we get rid of the difference &gt;</span>
</span><span class='line'><span class="c1">;;;                You probably guessed it: by passing in a function that expresses tha appropriate consing.</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">seqL</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">old</span> <span class="nv">l</span><span class="p">))))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">seqR</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">cons </span><span class="nv">old</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="nv">l</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; so you can (insert-g seqL)  (insert-g seqR)</span>
</span><span class='line'><span class="c1">;;; (define insertL (insert-g seqL))</span>
</span><span class='line'><span class="c1">;;; (define insertR (insert-g seqR))</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">insert-g</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">seq</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>        <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>        <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">old</span><span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">seq</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))</span>
</span><span class='line'>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span>
</span><span class='line'>                    <span class="p">((</span><span class="nf">insert-g</span> <span class="nv">seq</span><span class="p">)</span> <span class="nv">new</span> <span class="nv">old</span>
</span><span class='line'>                                    <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))))</span>
</span><span class='line'><span class="c1">;;; So we can define insertL again with insert-g *****************************^-^************************************</span>
</span><span class='line'><span class="c1">;;; Do not pass in seqL this time.</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">insertL1</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">insert-g</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">old</span> <span class="nv">l</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;;;; Perfect--- it is  a great abstraction!</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;Is it better?</span>
</span><span class='line'><span class="c1">;;;      Yes,Because youu do not need to remember as many names,you can</span>
</span><span class='line'><span class="c1">;;;      (rember func-name &quot;your-mind&quot;) </span>
</span><span class='line'><span class="c1">;;;                Where func-name is seqL</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;                Do you remember the definition of subst</span>
</span><span class='line'><span class="c1">;;;                Yes! it looks like insert-L  insertR  .Just the answer of the second cond-line is differenct</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">subst</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">old</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">subst</span> <span class="nv">new</span> <span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;subst insertL insertR the common property is else and different </span>
</span><span class='line'><span class="c1">;operator so we can abstract them to the insert-g</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">seqS</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="nv">l</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">subst1</span> <span class="p">(</span><span class="nf">insert-g</span> <span class="nv">seqS</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">seqrem</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>    <span class="nv">l</span><span class="p">))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">yyy</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">((</span><span class="nf">insert-g</span> <span class="nv">seqrem</span><span class="p">)</span> <span class="no">#f</span> <span class="nv">a</span> <span class="nv">l</span><span class="p">)))</span>
</span><span class='line'><span class="c1">;;;;;What do you yyy is?</span>
</span><span class='line'><span class="c1">;;;            Surprise ! It is our old friend rember,</span>
</span><span class='line'><span class="c1">;;;            Step through the evaluation of (yyy a l)</span>
</span><span class='line'><span class="c1">;;;            where </span>
</span><span class='line'><span class="c1">;;;                a  is sausage</span>
</span><span class='line'><span class="c1">;;;                and l is (pizza with sausage and bacon)</span>
</span><span class='line'><span class="c1">;;;             What role does #f paly?</span>
</span><span class='line'><span class="c1">;;;             New in the insertL and insertR   ,a is old in the insertL and insertR</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;             **********************************************************************</span>
</span><span class='line'><span class="c1">;;;             THe ninth commandments:</span>
</span><span class='line'><span class="c1">;;;              Abstract the common patterns with a new function.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;             **********************************************************************</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;So can you simplify the function (define value1)</span>
</span><span class='line'><span class="c1">;;; Can you write the funciton atom-to-function </span>
</span><span class='line'><span class="c1">;;;         which:</span>
</span><span class='line'><span class="c1">;;;               1: Taes one argument x </span>
</span><span class='line'><span class="c1">;;;               2: returns the function + if (eq? x (quote +))</span>
</span><span class='line'><span class="c1">;;;                  returns the function * if (eq? x (quote *))</span>
</span><span class='line'><span class="c1">;;;                  returns the function expr if (eq? x (quote expr))</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">atom-to-function</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">x</span> <span class="p">(</span><span class="k">quote </span><span class="nv">+</span><span class="p">)</span> <span class="nv">+</span><span class="p">))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">x</span> <span class="p">(</span><span class="k">quote </span><span class="nv">*</span><span class="p">)</span> <span class="nv">*</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="nv">expr</span><span class="p">))))</span>
</span><span class='line'><span class="c1">;;;(atom-to-function (operator nexp))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">value3</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">nexp</span><span class="p">)</span>
</span><span class='line'>    <span class="p">((</span><span class="nf">atom?</span> <span class="nv">nexp</span><span class="p">)</span> <span class="nv">nexp</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom-to-function</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">operator</span> <span class="nv">nexp</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">value3</span> <span class="p">(</span><span class="mi">1</span><span class="nv">st-sub-exp</span> <span class="nv">nexp</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">value3</span> <span class="p">(</span><span class="mi">2</span><span class="nv">nd-sub-exp</span> <span class="nv">nexp</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">multirember</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">multirember</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">multirember</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">multirember-f</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">test?</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>        <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>        <span class="p">((</span><span class="nf">test?</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
</span><span class='line'>         <span class="p">((</span><span class="nf">multirember-f</span> <span class="nv">test?</span><span class="p">)</span> <span class="nv">a</span>
</span><span class='line'>                               <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))</span>
</span><span class='line'>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                    <span class="p">((</span><span class="nf">multirember</span> <span class="nv">test?</span><span class="p">)</span>  <span class="nv">a</span>
</span><span class='line'>                                          <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">multirember-eq?</span> <span class="p">(</span><span class="nf">multirember-f</span> <span class="ss">&#39;eq?</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; After the insturciton os a pair----&gt;  </span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">first</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">p</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">car </span><span class="nv">p</span><span class="p">)))))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">second</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">p</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">p</span><span class="p">))))))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">third</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">p</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">p</span><span class="p">)))))))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">third1</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">build</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">s1</span> <span class="nv">s2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="nv">s1</span>
</span><span class='line'>                  <span class="p">(</span><span class="nb">cons </span><span class="nv">s2</span> <span class="p">(</span><span class="k">quote </span><span class="p">())))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;; After the (define fun?)</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">revrel</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">rel</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">rel</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">build</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">second</span>  <span class="p">(</span><span class="nb">car </span><span class="nv">rel</span><span class="p">))</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">first</span> <span class="p">(</span><span class="nb">car </span><span class="nv">rel</span><span class="p">)))</span>
</span><span class='line'>             <span class="p">(</span><span class="nf">revrel</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">rel</span><span class="p">)))))))</span>
</span><span class='line'><span class="c1">;; maybe we can abstract the build part,because it&#39;s the pair part</span>
</span><span class='line'><span class="c1">;;</span>
</span><span class='line'><span class="c1">;; Now do you see how representabtion aids readability????</span>
</span><span class='line'><span class="c1">;;         second   first is the (car (car rel))         second is (car (cdr (car rel)</span>
</span><span class='line'><span class="c1">;; so it can hide the build inverse process </span>
</span><span class='line'><span class="c1">;;</span>
</span><span class='line'><span class="c1">;; Suppose we had the funciton revpair that reversed the two componets of a pair like this:</span>
</span><span class='line'><span class="c1">;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">revpair</span><span class="c1">;;hide the build process</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">pair</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">build</span> <span class="p">(</span><span class="nf">second</span> <span class="nv">pair</span><span class="p">)</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">pair</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">revrel1</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">rel</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">rel</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">revpair</span> <span class="p">(</span><span class="nb">car </span><span class="nv">rel</span><span class="p">))</span><span class="c1">;so it can be hided</span>
</span><span class='line'>             <span class="p">(</span><span class="nf">revrel1</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">rel</span><span class="p">)))))))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">member?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">member?</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; The 7 chapter ,,after the numbered</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">set?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>         <span class="p">((</span><span class="nf">member?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))</span> <span class="no">#f</span>
</span><span class='line'>               <span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">set?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; simplify set?              -------------------------&lt;&lt;&lt;&lt;&lt;&lt;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">set1?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">member?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">set?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))))</span>
</span><span class='line'><span class="c1">;;; Were you surprised to see the function member? appear in the definition of set?</span>
</span><span class='line'><span class="c1">;;;       You should not be,because we have written memeber? already,and now we can </span>
</span><span class='line'><span class="c1">;;;       use it whenever we want</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">makeset</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">member?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">makeset</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">makeset</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">makeset1</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">makeset</span> <span class="p">(</span><span class="nf">multirember</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))))))</span>
</span><span class='line'><span class="c1">;;; Describe in your own words how the second definition of makeset works?????</span>
</span><span class='line'><span class="c1">;;;        Here are our words:</span>
</span><span class='line'><span class="c1">;;;         &quot;&quot;THe function makeset remembers to cons the first atom in the lat onto the result of the</span>
</span><span class='line'><span class="c1">;;;          natural recursion ,after removing all occurences of the first atom from the rest of the lat.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">subset?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set1</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">set1</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>              <span class="p">((</span><span class="nf">member?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>               <span class="p">(</span><span class="nf">subset?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">))</span>
</span><span class='line'>              <span class="p">(</span><span class="k">else </span><span class="no">#f</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; can you  write a shorter version of subset?</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">subset1?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set1</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">set1</span><span class="p">)</span> <span class="no">#t</span> <span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">member?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">subset?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="no">#f</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; Try to write subset1? with (and ...)</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">subset2?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set1</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">set1</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">member?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>             <span class="p">(</span><span class="nf">subset?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; equip list</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">eqset?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set1</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">subset?</span> <span class="nv">set1</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">subset?</span> <span class="nv">set2</span> <span class="nv">set1</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="no">#f</span><span class="p">))))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">eqset1?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set1</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>      <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">subset?</span> <span class="nv">set1</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">subset?</span> <span class="nv">set2</span> <span class="nv">set1</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">eqset2?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set1</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">subset?</span> <span class="nv">set1</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">subset?</span> <span class="nv">set2</span> <span class="nv">set1</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">firsts</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">rel</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">rel</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">first</span> <span class="p">(</span><span class="nb">car </span><span class="nv">rel</span><span class="p">))</span>
</span><span class='line'>             <span class="p">(</span><span class="nf">firsts</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">rel</span><span class="p">)))))))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">seconds</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">rel</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">rel</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">second</span> <span class="p">(</span><span class="nb">car </span><span class="nv">rel</span><span class="p">))</span>
</span><span class='line'>             <span class="p">(</span><span class="nf">seconds</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">rel</span><span class="p">)))))))</span>
</span><span class='line'><span class="c1">;; one important known : in the (else,things is called recur</span>
</span><span class='line'><span class="c1">;; in the cond&#39;s first question is called the end condtion</span>
</span><span class='line'><span class="c1">;; multi and sigle is recognise by the doing&#39;s if satisfied the </span>
</span><span class='line'><span class="c1">;; questions!</span>
</span><span class='line'><span class="c1">;;</span>
</span><span class='line'><span class="c1">;; After te define (pair)</span>
</span><span class='line'><span class="c1">;;</span>
</span><span class='line'><span class="c1">;;Is fun? a simple one-liner?  It sure is</span>
</span><span class='line'><span class="c1">;;</span>
</span><span class='line'><span class="c1">;;How do we reprensent a finite function?</span>
</span><span class='line'><span class="c1">;;       For us(lispers)m</span>
</span><span class='line'><span class="c1">;;                         a finite function is a list of pairs in which</span>
</span><span class='line'><span class="c1">;;                         no first element of any pair is the same as any</span>
</span><span class='line'><span class="c1">;;                         other first element</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">fun?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">rel</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">set?</span> <span class="p">(</span><span class="nf">firsts</span> <span class="nv">rel</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">fullfun?</span><span class="c1">;;fun is also a relation</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">fun</span><span class="p">)</span><span class="c1">;;fullfun is based on the fun</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">set?</span> <span class="p">(</span><span class="nf">seconds</span> <span class="nv">fun</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;fullfun&#39;s another name is one-to-one</span>
</span><span class='line'><span class="c1">;;so we can define it another way</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">one-to-one?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">fun</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">fun?</span> <span class="p">(</span><span class="nf">revrel</span> <span class="nv">fun</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">expr</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">m</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">zero? </span><span class="nv">m</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">* </span><span class="nv">n</span> <span class="p">(</span><span class="nf">expr</span> <span class="nv">n</span> <span class="p">(</span><span class="nb">- </span><span class="nv">m</span> <span class="mi">1</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">cookies</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">()</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">bake</span>
</span><span class='line'>      <span class="p">(</span><span class="k">quote </span><span class="p">(</span><span class="mi">350</span> <span class="nv">degrees</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">quote </span><span class="p">(</span><span class="mi">12</span> <span class="nv">minitus</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">mix</span>
</span><span class='line'>        <span class="p">(</span><span class="k">quote </span><span class="p">(</span><span class="nf">walnuts</span> <span class="mi">1</span> <span class="nv">cup</span><span class="p">))</span>
</span><span class='line'>        <span class="p">(</span><span class="k">quote </span><span class="p">(</span><span class="nf">chocolate-chips</span> <span class="mi">16</span> <span class="nv">ounces</span><span class="p">))</span>
</span><span class='line'>        <span class="nv">mix</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">mix</span>
</span><span class='line'>          <span class="p">(</span><span class="k">quote </span><span class="p">(</span><span class="nf">flour</span> <span class="mi">2</span> <span class="nv">cups</span><span class="p">))</span>
</span><span class='line'>          <span class="p">(</span><span class="k">quote </span><span class="p">(</span><span class="nf">oatmeal</span> <span class="mi">2</span> <span class="nv">cups</span><span class="p">))</span>
</span><span class='line'>          <span class="p">(</span><span class="k">quote </span><span class="p">(</span><span class="nf">salt</span> <span class="o">.</span><span class="mi">5</span> <span class="nv">teaspoon</span><span class="p">))</span>
</span><span class='line'>          <span class="p">(</span><span class="k">quote </span><span class="p">(</span><span class="nf">baking-powder</span> <span class="mi">1</span> <span class="nv">teaspoon</span><span class="p">))</span>
</span><span class='line'>          <span class="p">(</span><span class="k">quote </span><span class="p">(</span><span class="nf">baking-soda</span> <span class="mi">1</span> <span class="nv">teaspoon</span><span class="p">)))</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">mix</span>
</span><span class='line'>          <span class="p">(</span><span class="k">quote </span><span class="p">(</span><span class="nf">eggs</span> <span class="mi">2</span> <span class="nv">large</span><span class="p">))</span>
</span><span class='line'>          <span class="p">(</span><span class="k">quote </span><span class="p">(</span><span class="nf">vanilla</span> <span class="mi">1</span> <span class="nv">teaspoon</span><span class="p">))</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">cream</span>
</span><span class='line'>            <span class="p">(</span><span class="k">quote </span><span class="p">(</span><span class="nf">butter</span> <span class="mi">1</span> <span class="nv">cup</span><span class="p">))</span>
</span><span class='line'>            <span class="p">(</span><span class="k">quote </span><span class="p">(</span><span class="nf">sugar</span> <span class="mi">2</span> <span class="nv">cups</span><span class="p">))))))))</span>
</span><span class='line'><span class="c1">;;;  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;Y</span>
</span><span class='line'><span class="c1">;;;The Fifth commandments:</span>
</span><span class='line'><span class="c1">;;;  When building a  value with +, always use 0 for the value of the terminating line,for adding 0 does not change the value of an addiction</span>
</span><span class='line'><span class="c1">;;;  When building a  value with *, always use 1 for the value of the termination line,for multiplying 1 does not change the value of a multiplication</span>
</span><span class='line'><span class="c1">;;;  When building a  value with cons, always consider () for the value of the terminating line</span>
</span><span class='line'><span class="c1">;;;  ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;Y</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; What does (tup+ tup1 tup2) do?</span>
</span><span class='line'><span class="c1">;;;         It adds the first number of tup1 to the first number of tup2,then it adds the second number of tup1 to the second number of tup2,etc</span>
</span><span class='line'><span class="c1">;;;               building a tup of answers,for tups of the same length</span>
</span><span class='line'><span class="c1">;;; What is the unusal about tup+?</span>
</span><span class='line'><span class="c1">;;;         It looks at each element of two tups at the same time,or in other words, it recus on two tups.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; If you recur on one tup how many questions do you have to ask?</span>
</span><span class='line'><span class="c1">;;;         two,they are (null? tup) and else</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; When recuring on two tups, how many question need to be asked about the tups? </span>
</span><span class='line'><span class="c1">;;;      Four: if the first tup is empty or none-empty,and if the second tup is empty or non-emptyy</span>
</span><span class='line'><span class="c1">;;;      Do you mean the questions (and (null? tup1) (null? tup2)) (null? tup1) (null? tup2) and else </span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;      But can the first tup be () at the same time as the second is other than ().</span>
</span><span class='line'><span class="c1">;;;         No ,because the tups must have the same length</span>
</span><span class='line'><span class="c1">;;;     Does this mean (and (null? tup1) (null? tup2))  and else are the only questions we need to ask?</span>
</span><span class='line'><span class="c1">;;;     Yes!</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">tup+</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">tup1</span> <span class="nv">tup2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="k">and </span> <span class="p">(</span><span class="nb">null? </span><span class="nv">tup1</span><span class="p">)</span> <span class="p">(</span><span class="nb">null? </span><span class="nv">tup2</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">car </span><span class="nv">tup1</span><span class="p">)</span> <span class="p">(</span><span class="nb">car </span><span class="nv">tup2</span><span class="p">))</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">tup+</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">tup1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">tup2</span><span class="p">)))))))</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;;;  Why  does the natural recursion include the cdr of bouth arguments?</span>
</span><span class='line'><span class="c1">;;;      Because the typical element of the final value use the car of both tups,so now</span>
</span><span class='line'><span class="c1">;;;      we are ready to consider the rest of both tups -----------------------------&lt;&lt;&lt;&lt;&lt;&lt;Yes the right logic</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">tup++</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">tup1</span> <span class="nv">tup2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nb">null? </span><span class="nv">tup1</span><span class="p">)</span> <span class="p">(</span><span class="nb">null? </span><span class="nv">tup2</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">tup1</span><span class="p">)</span> <span class="nv">tup2</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">tup2</span><span class="p">)</span> <span class="nv">tup1</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">car </span><span class="nv">tup1</span><span class="p">)</span> <span class="p">(</span><span class="nb">car </span><span class="nv">tup2</span><span class="p">))</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">tup++</span>
</span><span class='line'>                <span class="p">(</span><span class="nb">cdr </span><span class="nv">tup1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">tup2</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;; can you simplify it????????????????????????????////</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">tup+++</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">tup1</span> <span class="nv">tup2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">tup1</span><span class="p">)</span> <span class="nv">tup2</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">tup2</span><span class="p">)</span> <span class="nv">tup1</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">car </span><span class="nv">tup1</span><span class="p">)</span> <span class="p">(</span><span class="nb">car </span><span class="nv">tup2</span><span class="p">))</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">tup+++</span>
</span><span class='line'>                <span class="p">(</span><span class="nb">cdr </span><span class="nv">tup1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">tup2</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">atom-to-function</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">x</span> <span class="p">(</span><span class="k">quote </span><span class="nv">+</span><span class="p">))</span> <span class="nv">+</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">x</span> <span class="p">(</span><span class="k">quote </span><span class="nv">*</span><span class="p">))</span> <span class="nv">*</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">x</span> <span class="p">(</span><span class="k">quote </span><span class="nv">^</span><span class="p">))</span> <span class="nv">expr</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">x</span> <span class="p">(</span><span class="k">quote </span><span class="nv">eq?</span><span class="p">))</span> <span class="nv">eq?</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="nv">-</span><span class="p">))))</span>
</span><span class='line'><span class="c1">; (rember-f (atom-to-function &#39;eq?) &#39;ff &#39;(dfds gi ff sd))  </span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">; In the common lisp:</span>
</span><span class='line'><span class="c1">;            L: (funcall test? (car l) a) ,use the funcall when invoking a function argument or a function that has </span>
</span><span class='line'><span class="c1">;            not been defuned</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">rember-f</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">test?</span> <span class="nv">a</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>         <span class="p">((</span><span class="nf">test?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))</span><span class="c1">;;I think here needs atom2function</span>
</span><span class='line'>         <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span>
</span><span class='line'>                     <span class="p">(</span><span class="nf">rember-f</span> <span class="nv">test?</span> <span class="nv">a</span>
</span><span class='line'>                               <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; The short version! </span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">rember1-f</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">test?</span> <span class="nv">a</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">test?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))</span><span class="c1">;;I think here needs atom2function</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span>
</span><span class='line'>                     <span class="p">(</span><span class="nf">rember-f</span> <span class="nv">test?</span> <span class="nv">a</span>
</span><span class='line'>                               <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'><span class="c1">;;; What kind of values can functions return&gt;</span>
</span><span class='line'><span class="c1">;;;                  Lists and atoms</span>
</span><span class='line'><span class="c1">;;;                       But in the eye of us ,all the things are the lists and atoms</span>
</span><span class='line'><span class="c1">;;;                        so we can return all the kind of values</span>
</span><span class='line'><span class="c1">;;;                        so what about function themselves? Yes</span>
</span><span class='line'><span class="c1">;;;                         such as (lambda (a l) ...) is a function of two arguments ,a and l! returns the function!</span>
</span><span class='line'><span class="c1">;;;                 This is calld &quot;Curry-ing&quot;</span>
</span><span class='line'><span class="c1">;;;     In the scheme ,Using (define ...)give the preceding function a name,</span>
</span><span class='line'><span class="c1">;;;     but in theCL: (define eq?-c  (a) (function (lambda (x) (eq x a))))</span>
</span><span class='line'><span class="c1">;;;     while the scheme : (define eq?-c (lambda (a) (lambda (x) (eq? x a))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">insertL-f</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">test?</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>        <span class="p">((</span> <span class="nv">null?</span> <span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>        <span class="p">((</span><span class="nf">test?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">old</span><span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">old</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))</span>
</span><span class='line'>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span>
</span><span class='line'>                    <span class="p">((</span><span class="nf">insertL-f</span> <span class="nv">test?</span><span class="p">)</span> <span class="nv">new</span> <span class="nv">old</span>
</span><span class='line'>                                       <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">insertR-f</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">test?</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>        <span class="p">((</span> <span class="nv">null?</span> <span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>        <span class="p">((</span><span class="nf">test?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">old</span><span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="nb">cons </span><span class="nv">old</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))</span>
</span><span class='line'>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span>
</span><span class='line'>                    <span class="p">((</span><span class="nf">insertR-f</span> <span class="nv">test?</span><span class="p">)</span> <span class="nv">new</span> <span class="nv">old</span>
</span><span class='line'>                                       <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))))</span>
</span><span class='line'><span class="c1">;;The basic principle</span>
</span><span class='line'><span class="c1">;;(name --&gt;(null? ---&gt;(eq?    ---&gt;single (cons new (cdr l))    --&gt;(else</span>
</span><span class='line'><span class="c1">;;                            ---&gt;multi (cons new (name (cdr l)))--&gt;(else</span>
</span><span class='line'><span class="c1">;;                ---&gt;(eqan?   ---&gt;single (cons new (cdr l))    --&gt;(else</span>
</span><span class='line'><span class="c1">;;                            ---&gt;multi (cons new (name (cdr l)))--&gt;(else</span>
</span><span class='line'><span class="c1">;;                ---&gt;(equal?  ---&gt;single (cons new (cdr l))    --&gt;(else</span>
</span><span class='line'><span class="c1">;;                            ---&gt;multi (cons new (name (cdr l)))--&gt;(else</span>
</span><span class='line'><span class="c1">;;                ---&gt;(eqlist? ---&gt;single (cons new (cdr l))    --&gt;(else</span>
</span><span class='line'><span class="c1">;;                            ---&gt;multi (cons new (name (cdr l)))--&gt;(else</span>
</span><span class='line'><span class="c1">;;sometimes we abstuct the condition to adapt to different state</span>
</span><span class='line'><span class="c1">;; sometimes we abstuct the operations to simplify it</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">multirember1</span>
</span><span class='line'> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>     <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>     <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">multirember</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))</span>
</span><span class='line'>     <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                 <span class="p">(</span><span class="nf">multirember</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">multirember1-f</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">test?</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>        <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>        <span class="p">((</span><span class="nf">test?</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
</span><span class='line'>         <span class="p">((</span><span class="nf">multirember1-f</span> <span class="nv">test?</span><span class="p">)</span> <span class="nv">a</span>
</span><span class='line'>                                <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))</span>
</span><span class='line'>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                    <span class="p">((</span><span class="nf">multirember1-f</span> <span class="nv">test?</span><span class="p">)</span>  <span class="nv">a</span>
</span><span class='line'>                                            <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))))))</span>
</span><span class='line'><span class="c1">;;((multirember1-f (atom-to-function &#39;eq?)) &#39;fd &#39;(sgs fd gasdg fd))</span>
</span><span class='line'><span class="c1">;;&#39;(sgs gasdg)</span>
</span><span class='line'><span class="c1">;;(define multirember1-eq (multirember1-f (atom-to-function &#39;eq?)))</span>
</span><span class='line'><span class="c1">;;Actually:</span>
</span><span class='line'><span class="c1">;;((multirember1-f eq?) &#39;fd &#39;(gsd fd gjsi fd go))</span>
</span><span class='line'><span class="c1">;;direct apply function eq?,That doesn&#39;t need (eq?, I learn from</span>
</span><span class='line'><span class="c1">;; (multiremberT eq?-salad)</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">rembern</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">((</span><span class="nf">insert-g</span> <span class="nv">seqrem</span><span class="p">)</span> <span class="no">#f</span> <span class="nv">a</span> <span class="nv">l</span><span class="p">)))</span><span class="c1">;;seqrem doesn&#39;t need (seqrem solve my ?.</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">seqrem</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">old</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>    <span class="nv">l</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">multiremberT</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">test?</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">test?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">multiremberT</span> <span class="nv">test?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>             <span class="p">(</span><span class="nf">multiremberT</span> <span class="nv">test?</span>
</span><span class='line'>                           <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">eq?-c</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nb">eq? </span><span class="nv">x</span> <span class="nv">a</span><span class="p">))))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">eq?-salad</span> <span class="p">(</span><span class="nf">eq?-c</span> <span class="ss">&#39;salad</span><span class="p">))</span>
</span><span class='line'><span class="c1">;;(multiremberT eq?-salad &#39;(fsfd salad fsdf sald sg salad))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; What is the name of the third arguments that multiremberco uses for the natural recursion?</span>
</span><span class='line'><span class="c1">;;; what is the name of the third argument ? And do you know what col stands for?</span>
</span><span class='line'><span class="c1">;;;       The name col is short for &quot;collector&quot;, A collector is sometimes called a continuation</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">multiremberco</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span> <span class="nv">col</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="k">quote </span><span class="p">())</span> <span class="p">(</span><span class="k">quote </span><span class="p">())))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">multiremberco</span> <span class="nv">a</span>
</span><span class='line'>                      <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                      <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newlat</span> <span class="nv">seen</span><span class="p">)</span>
</span><span class='line'>                        <span class="p">(</span><span class="nf">col</span> <span class="nv">newlat</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">seen</span><span class="p">)))))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">multiremberco</span> <span class="nv">a</span>
</span><span class='line'>                      <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>        <span class="p">)</span>             <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newlat</span> <span class="nv">seen</span><span class="p">)</span>
</span><span class='line'>                        <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">newlat</span><span class="p">)</span>
</span><span class='line'>                             <span class="nv">seen</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">a-friend</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span> <span class="nv">y</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">null? </span><span class="nv">y</span><span class="p">)))</span>
</span><span class='line'><span class="c1">;(multiremberco &#39;tuna &#39;(sfds tuna fsd jif) a-friend)</span>
</span><span class='line'><span class="c1">;#f</span>
</span><span class='line'><span class="c1">;&gt; (multiremberco &#39;tuna &#39;(sfds tuna1 fsd jif) a-friend)</span>
</span><span class='line'><span class="c1">;#t</span>
</span><span class='line'><span class="c1">;;how can  you get another value in the col</span>
</span><span class='line'><span class="c1">;;</span>
</span><span class='line'><span class="c1">;;can you write this definition differently!  Do you mean the new way where we put tuna into the definition?</span>
</span><span class='line'><span class="c1">;;  col is to a-frined what (car lat) is to tuna.   so we can replace the col with a-frined</span>
</span><span class='line'><span class="c1">;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">new-friend</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newlat</span> <span class="nv">seen</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">a-friend</span> <span class="nv">newlat</span>
</span><span class='line'>         <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="k">quote </span><span class="nv">tuna</span><span class="p">)</span> <span class="nv">seen</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;; So ANd now?</span>
</span><span class='line'><span class="c1">;;;      multiremberco finds out that(null? lat) is true, which means that it uses the collector on two empty lists.</span>
</span><span class='line'><span class="c1">;;;        which collector is this?</span>
</span><span class='line'><span class="c1">;;;          It is new-friend.</span>
</span><span class='line'><span class="c1">;;; how does a-friend differ from new-friend ?</span>
</span><span class='line'><span class="c1">;;;              New-friend uses a-friend on the empty list and </span>
</span><span class='line'><span class="c1">;;;               the value of (cons (quote tuna) (quote ()))</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; And what does the old-collector do (a-friend) with such arguments?</span>
</span><span class='line'><span class="c1">;;;              It answers #f,because its second argument is (tuna),which is not the empty list!</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;;;;;; I don&#39;t know that the list length ,so easy but I don&#39;t think it clearly!!!!</span>
</span><span class='line'><span class="c1">;;;What is terminal condition ?  (null? lat)</span>
</span><span class='line'><span class="c1">;;;what is terminal condition line ? ((null? lat) 0)   (terminal_contition terminal_value)</span>
</span><span class='line'><span class="c1">;;;what is the (+1 (length (cdr lat)))</span>
</span><span class='line'><span class="c1">;;;        build the number with +,so the terminal condition line is ((null? lat) 0)   use (cdr lat) to closer the terminal!</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">length</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="p">(</span><span class="nb">length </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; a is tuna and lat is (and tuna)  col is a-friend</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">latest-friend</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newlat</span> <span class="nv">seen</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">a-friend</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">quotee</span> <span class="nv">and</span><span class="p">)</span> <span class="nv">newlat</span><span class="p">)</span>
</span><span class='line'>              <span class="nv">seen</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;The third collector : the last-friend</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">last-friend</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newlat</span> <span class="nv">seen</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">length </span><span class="nv">newlat</span><span class="p">)))</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;****************************************************************************</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;****************************************************************************</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;****************************************************************************</span>
</span><span class='line'><span class="c1">;;;;So  what does (multiremberco a lat f) do?</span>
</span><span class='line'><span class="c1">;;;      It looks at every atom of the lat to see whether </span>
</span><span class='line'><span class="c1">;;;      it is eq? to a.Those atoms that are  not  are collected in one list ls1</span>
</span><span class='line'><span class="c1">;;;      it is eq? to a.The others which the answer is true    are collected in second list ls2</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;      Finally  it determine the value of (f ls1 ls2)</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;      Namely under the process of time(timestep=0,1,2,3,n-1),In the col it classify the data: use cons </span>
</span><span class='line'><span class="c1">;;;              while at the last time(timestep=n) in the a-friend (col) it determine the cons datas!!</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;****************************************************************************</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;****************************************************************************</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;****************************************************************************</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;****************************************************************************</span>
</span><span class='line'><span class="c1">;;;        The Tenth commandments:</span>
</span><span class='line'><span class="c1">;;;            Build functions to collect more than one value at a time.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;****************************************************************************</span>
</span><span class='line'><span class="c1">;&gt; (multiremberco &#39;tuna &#39;(tunanfdfj tuan jsidjf tuna) last-friend)</span>
</span><span class='line'><span class="c1">;3</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;actually</span>
</span><span class='line'><span class="c1">;;The basic principle</span>
</span><span class='line'><span class="c1">;;(name --&gt;(null? (col (quote()...)---&gt;(eq?    ---&gt;single (cons new (cdr l))    --&gt;(else</span>
</span><span class='line'><span class="c1">;;                            ---&gt;multi (cons new (name (cdr l)))--&gt;(else</span>
</span><span class='line'><span class="c1">;;                ---&gt;(eqan?   ---&gt;single (cons new (cdr l))    --&gt;(else</span>
</span><span class='line'><span class="c1">;;                            ---&gt;multi (cons new (name (cdr l)))--&gt;(else</span>
</span><span class='line'><span class="c1">;;                ---&gt;(equal?  ---&gt;single (cons new (cdr l))    --&gt;(else</span>
</span><span class='line'><span class="c1">;;                            ---&gt;multi (cons new (name (cdr l)))--&gt;(else</span>
</span><span class='line'><span class="c1">;;                ---&gt;(eqlist? ---&gt;single (cons new (cdr l))    --&gt;(else</span>
</span><span class='line'><span class="c1">;;                            ---&gt;multi (cons new (name (cdr l)))--&gt;(else</span>
</span><span class='line'><span class="c1">;;sometimes we abstuct the condition to adapt to different state</span>
</span><span class='line'><span class="c1">;; sometimes we abstuct the operations to simplify it</span>
</span><span class='line'><span class="c1">;;multiremboco sometimes we want to change the return value,so co it</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">multiinsertLR</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">oldL</span> <span class="nv">oldR</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">oldL</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span>
</span><span class='line'>             <span class="p">(</span><span class="nb">cons </span><span class="nv">oldL</span>
</span><span class='line'>                   <span class="p">(</span><span class="nf">multiinsertLR</span> <span class="nv">new</span> <span class="nv">oldL</span> <span class="nv">oldR</span>
</span><span class='line'>                                  <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">oldR</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">cons </span><span class="nv">oldR</span>
</span><span class='line'>             <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span>
</span><span class='line'>                   <span class="p">(</span><span class="nf">multiinsertLR</span> <span class="nv">new</span> <span class="nv">oldL</span> <span class="nv">oldR</span>
</span><span class='line'>                                 <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">multiinsertLR</span> <span class="nv">new</span> <span class="nv">oldL</span> <span class="nv">oldR</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;; The function multiinsertLRco is to multiinsertLR what multiremberco is to multirember</span>
</span><span class='line'><span class="c1">;;;           Does this mean that multiinsertLRco takes one more argument than multiinsertLR?</span>
</span><span class='line'><span class="c1">;;;            Yes! and what kind of argument is it? </span>
</span><span class='line'><span class="c1">;;;                   It is a collector function.</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">multiinsertLRco</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span> <span class="nv">oldL</span> <span class="nv">oldR</span> <span class="nv">lat</span> <span class="nv">col</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="k">quote </span><span class="p">())</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">oldL</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">multiinsertLRco</span> <span class="nv">new</span> <span class="nv">oldL</span> <span class="nv">oldR</span>
</span><span class='line'>                        <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                        <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newlat</span> <span class="nv">L</span> <span class="nv">R</span><span class="p">)</span>
</span><span class='line'>                          <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span>
</span><span class='line'>                                     <span class="p">(</span><span class="nb">cons </span><span class="nv">oldL</span> <span class="nv">newlat</span><span class="p">))</span>
</span><span class='line'>                               <span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="nv">L</span><span class="p">)</span> <span class="nv">R</span><span class="p">))))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">oldR</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">multiinsertLRco</span> <span class="nv">new</span> <span class="nv">oldL</span> <span class="nv">oldR</span>
</span><span class='line'>                        <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                        <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newlat</span> <span class="nv">L</span> <span class="nv">R</span><span class="p">)</span>
</span><span class='line'>                          <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">oldR</span>
</span><span class='line'>                                     <span class="p">(</span><span class="nb">cons </span><span class="nv">new</span> <span class="nv">newlat</span><span class="p">))</span>
</span><span class='line'>                               <span class="nv">L</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="nv">R</span><span class="p">)))))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">multiinsertLRco</span> <span class="nv">new</span> <span class="nv">oldL</span> <span class="nv">oldR</span>
</span><span class='line'>                        <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                        <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newlat</span> <span class="nv">L</span> <span class="nv">R</span><span class="p">)</span>
</span><span class='line'>                          <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">newlat</span><span class="p">)</span>
</span><span class='line'>                               <span class="nv">L</span> <span class="nv">R</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">even?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nb">/ </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">2</span><span class="p">)</span> <span class="nv">n</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">/</span>  <span class="c1">;rewrite the divide to replace the origianl divide from Drracket</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">m</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">&lt; </span><span class="nv">n</span> <span class="nv">m</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="p">(</span><span class="nb">/ </span><span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="nv">m</span><span class="p">)</span> <span class="nv">m</span><span class="p">))))))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">evens-only*</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>         <span class="p">((</span><span class="nb">even? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>          <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">evens-only*</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">evens-only*</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">evens-only*</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">evens-only*</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">atom?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">pair? </span><span class="nv">x</span><span class="p">))</span> <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">null? </span><span class="nv">x</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;  Can you explain what (evens-only*co (carl) ...) accomplishes?</span>
</span><span class='line'><span class="c1">;;;      It visits every number in the car of l and collects the list without odd numbers,the</span>
</span><span class='line'><span class="c1">;;;      product of the even numbers,and the sum of the odd numbers.</span>
</span><span class='line'><span class="c1">;;;      So it is the most complicated,actually not very easy to be understood!</span>
</span><span class='line'><span class="c1">;;;         You can understand with another lat,so you how to associate two lat!</span>
</span><span class='line'><span class="c1">;;;         Youknow (even? (car l)) is in  a lat,so it do +*cons in the lat&#39;s number!</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">evens-only*co</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span> <span class="nv">col</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="k">quote </span><span class="p">())</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">))</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>         <span class="p">((</span><span class="nb">even? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">evens-only*co</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span>
</span><span class='line'>                         <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newl</span> <span class="nv">p</span> <span class="nv">s</span><span class="p">)</span>
</span><span class='line'>                           <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">newl</span><span class="p">)</span><span class="c1">;if it is evens ,so cons it into the newl</span>
</span><span class='line'>                                <span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">p</span><span class="p">)</span> <span class="nv">s</span><span class="p">))))</span>
</span><span class='line'>         <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">evens-only*co</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span>
</span><span class='line'>                              <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newl</span> <span class="nv">p</span> <span class="nv">s</span><span class="p">)</span>
</span><span class='line'>                                <span class="p">(</span><span class="nf">col</span> <span class="nv">newl</span> <span class="nv">p</span> <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">s</span><span class="p">)))))))</span>
</span><span class='line'>       <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">evens-only*co</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span>
</span><span class='line'>                            <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">al</span> <span class="nv">ap</span> <span class="nv">as</span><span class="p">)</span>
</span><span class='line'>                              <span class="p">(</span><span class="nf">evens-only*co</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span>
</span><span class='line'>                                             <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">dl</span> <span class="nv">dp</span> <span class="nv">ds</span><span class="p">)</span>
</span><span class='line'>                                               <span class="p">(</span><span class="nf">col</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">al</span> <span class="nv">dl</span><span class="p">)</span>
</span><span class='line'>                                                    <span class="p">(</span><span class="nb">* </span><span class="nv">ap</span> <span class="nv">dp</span><span class="p">)</span>
</span><span class='line'>                                                    <span class="p">(</span><span class="nb">+ </span><span class="nv">as</span> <span class="nv">ds</span><span class="p">))))))))))</span>
</span><span class='line'><span class="c1">;the fourth collector :: the last-last-friend</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">the-last-last-friend</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">newl</span> <span class="nv">product</span> <span class="nv">sum</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">cons </span><span class="nv">sum</span>
</span><span class='line'>          <span class="p">(</span><span class="nb">cons </span><span class="nv">product</span>
</span><span class='line'>                <span class="nv">newl</span><span class="p">))))</span>
</span><span class='line'><span class="c1">;&gt; (evens-only*co &#39;(45389 63 45 6 4 234  6 4 23 52 43) the-last-last-friend)</span>
</span><span class='line'><span class="c1">;&#39;(45563 7008768 6 4 234 6 4 52)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;;  after the length !!!!(define length) -------------------------------------&lt;</span>
</span><span class='line'><span class="c1">;;;  use car !!   zero?  sub1</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">pick</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">zero? </span><span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">))</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">pick</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">rempick</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">zero? </span><span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">))</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">rempick</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))</span>
</span><span class='line'>      <span class="c1">;;;; because n  lat is occur in the terminal condition!!!!!</span>
</span><span class='line'><span class="c1">;;; use the function one? to rewrite the function rempick that removes the nth atom from a lat.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">rempick1</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nf">one?</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">rempick</span> <span class="p">((</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">)</span>
</span><span class='line'>                            <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))))))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">keep-looking</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">sorn</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">number? </span><span class="nv">sorn</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">keep-looking</span> <span class="nv">a</span> <span class="p">(</span><span class="nf">pick</span> <span class="nv">sorn</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">lat</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">eq? </span><span class="nv">sorn</span> <span class="nv">a</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">looking</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">keep-looking</span> <span class="nv">a</span> <span class="p">(</span><span class="nf">pick</span> <span class="mi">1</span> <span class="nv">lat</span><span class="p">)</span> <span class="nv">lat</span><span class="p">)))</span>
</span><span class='line'><span class="c1">;&gt; (looking &#39;cavier &#39;(6 2 4 cavier 5 7 3))</span>
</span><span class='line'><span class="c1">;#t</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">eternity</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">eternity</span> <span class="nv">x</span><span class="p">)))</span>
</span><span class='line'><span class="c1">;;it doesn&#39;t stop ,because the goal is not absolutely, rather then</span>
</span><span class='line'><span class="c1">;; 相对的</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; This is trivival; It&#39;s not even recursive</span>
</span><span class='line'><span class="c1">;;; What does shift do?</span>
</span><span class='line'><span class="c1">;;;   Here are our words:</span>
</span><span class='line'><span class="c1">;;;     The shift function takes a pair whose first component is a pair and builds a pair</span>
</span><span class='line'><span class="c1">;;;     by shifting the second part of the first component into the second component!</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;     So what is the meaning of component?  --------Component can means atom,pair and list</span>
</span><span class='line'><span class="c1">;;;                  Now it means pair.</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">shift</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">pair</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">build</span> <span class="p">(</span><span class="nf">first</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">pair</span><span class="p">))</span>
</span><span class='line'>           <span class="p">(</span><span class="nf">build</span> <span class="p">(</span><span class="nf">second</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">pair</span><span class="p">))</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">second</span> <span class="nv">pair</span><span class="p">)))))</span>
</span><span class='line'><span class="c1">;&gt; (shift &#39;((fsd fd)(fd gs)))</span>
</span><span class='line'><span class="c1">;&#39;(fsd (fd (fd gs)))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">align</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">pora</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">pora</span><span class="p">)</span> <span class="nv">pora</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">a-pair?</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">pora</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">align</span> <span class="p">(</span><span class="nf">shift</span> <span class="nv">pora</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">build</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">pora</span><span class="p">)</span>
</span><span class='line'>                   <span class="p">(</span><span class="nf">align</span> <span class="p">(</span><span class="nf">second</span> <span class="nv">pora</span><span class="p">)))))))</span>
</span><span class='line'><span class="c1">;;; What does it  have in common with keep-looking </span>
</span><span class='line'><span class="c1">;;;          Both functions change their arguments for their recursive uses but in neither</span>
</span><span class='line'><span class="c1">;;;          case is the change guaranteed to get us closer to the goal</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Why are we not guaranteed that align makes progress?</span>
</span><span class='line'><span class="c1">;;;                In the second cond-line shift creates an argument for align that </span>
</span><span class='line'><span class="c1">;;;                is not a part of the original argument.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Which commandment does that violate?</span>
</span><span class='line'><span class="c1">;;;              The Seventh Commandment.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Is the new argument at least  smaller than the original one?</span>
</span><span class='line'><span class="c1">;;;            It does not look that way</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Why not?</span>
</span><span class='line'><span class="c1">;;;           The function shift only rearranges the pair it gets.</span>
</span><span class='line'><span class="c1">;;; And?</span>
</span><span class='line'><span class="c1">;;;           Both the result and the argument of shift have the same number of atoms.</span>
</span><span class='line'><span class="c1">;;; Can you write a function that counts the number of atoms</span>
</span><span class='line'><span class="c1">;;; After the (define intersectall)</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;align do what shift can&#39;t do?</span>
</span><span class='line'><span class="c1">;;;        Such as  (align &#39;(a b))         but (shift &#39;(a b)) will get wrong message.</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">a-pair?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">x</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">x</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">x</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">x</span><span class="p">)))</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="no">#f</span><span class="p">))))</span>
</span><span class='line'><span class="c1">;;; how can you refer to the first S-expression of a pair?</span>
</span><span class='line'><span class="c1">;;;      By taking the car of the pari</span>
</span><span class='line'><span class="c1">;;; How can you refer to the second S-expression of a pair?</span>
</span><span class='line'><span class="c1">;;;      By taking the car of the cdr of the pair</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; How can you build a pair with two atoms?</span>
</span><span class='line'><span class="c1">;;;  You cons the first ne onto the cons of the second one onto (). Thatis (cons x1 (cons x2 (quote ())))</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;  How can you build a pair with two S-expressions?</span>
</span><span class='line'><span class="c1">;;;   you cns the first one onto the cons of the second one onto ().That is</span>
</span><span class='line'><span class="c1">;;;   (cons s1 (cons s2 (quote ()))) or (cons x1 (cons x2 (quote ())))</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;   Did you notice the difference between the last two answers?</span>
</span><span class='line'><span class="c1">;;;     No ,there aren&#39;t any</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;Is align a partial function?</span>
</span><span class='line'><span class="c1">;;;        We don&#39;t now yet.There may be arguments for which it keeps aligning things.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Is there something else that changes about the arguments to align and its recursive uses?</span>
</span><span class='line'><span class="c1">;;;        Yes, there is .The first component of a  pair becomes simpler,though the second component becomes more complicated</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; In what way is the first component simpler?</span>
</span><span class='line'><span class="c1">;;;       IT is only a part (IT intelligent technique   is equal to it) of the original pair&#39;s first component.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Doesn&#39;t this mean that lenght * is the wrong function for determining the length of the argument? Can you find a better function</span>
</span><span class='line'><span class="c1">;;;         A better function should pay more attention to the first component</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; How much more attention should we pay to the first component?</span>
</span><span class='line'><span class="c1">;;;          At least twice as much</span>
</span><span class='line'><span class="c1">;;;          Do you mean something like weight*</span>
</span><span class='line'><span class="c1">;;;     DOes This mean that the arguments get simpler?</span>
</span><span class='line'><span class="c1">;;;       Yes ,the weigth* of align&#39;s arguments become successively smaller</span>
</span><span class='line'><span class="c1">;;;     Is align a partial function?</span>
</span><span class='line'><span class="c1">;;;        No,it yields a value for every argument rather than the partial function looking and looking again.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">length*</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">pora</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span> <span class="nv">atom?</span> <span class="nv">pora</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">length*</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">pora</span><span class="p">))</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">length*</span> <span class="p">(</span><span class="nf">second</span> <span class="nv">pora</span><span class="p">)))))))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">weight*</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">pora</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">pora</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">* </span><span class="p">(</span><span class="nf">weight*</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">pora</span><span class="p">))</span> <span class="mi">2</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">weight*</span> <span class="p">(</span><span class="nf">second</span> <span class="nv">pora</span><span class="p">)))))))</span>
</span><span class='line'><span class="c1">;;;  Here is shuffle which is like align but uses revpair from chapter7, instead of shift:(when the first component is a-pair?</span>
</span><span class='line'><span class="c1">;;;       THen do revpair.</span>
</span><span class='line'><span class="c1">;;; The function shuffle and revpair swap the components of pairs when the first component is a pair...</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Does this mean that shuffle is total?</span>
</span><span class='line'><span class="c1">;;;        We don&#39;t know yet.(actually  it is not.)</span>
</span><span class='line'><span class="c1">;;; Okay,let&#39;s do something interesting. What is the value of (shuffle x) where x is ((a b) (c d))</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; And how are you going to do that?</span>
</span><span class='line'><span class="c1">;;;          We are going to determine the value (shuffle pora) where pora is ((c d) (a b))</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Doesn&#39;t this mean that we need to know the value of (shuffle (revpair pora))</span>
</span><span class='line'><span class="c1">;;;            where (revpair pora) is ((a b) (c d))  , yes we do.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; And?</span>
</span><span class='line'><span class="c1">;;;         The function shuffle is not total because it now swaps the components of the pair again, which means that we start all over.</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">shuffle</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">pora</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">pora</span><span class="p">)</span> <span class="nv">pora</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">a-pair?</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">pora</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">shuffle</span> <span class="p">(</span><span class="nf">revpair</span> <span class="nv">pora</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">build</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">pora</span><span class="p">)</span>
</span><span class='line'>                   <span class="p">(</span><span class="nf">shuffle</span> <span class="p">(</span><span class="nf">second</span> <span class="nv">pora</span><span class="p">)))))))</span>
</span><span class='line'><span class="c1">;&gt; (shuffle &#39;(a (b c)))</span>
</span><span class='line'><span class="c1">;&#39;(a (b c))</span>
</span><span class='line'><span class="c1">;&gt; (shuffle &#39;(a b c))</span>
</span><span class='line'><span class="c1">;&#39;(a b)</span>
</span><span class='line'><span class="c1">;&gt; (shuffle &#39;(a b))</span>
</span><span class='line'><span class="c1">;&#39;(a b)</span>
</span><span class='line'><span class="c1">;;;;         Thankyou ,Lother Collatz(1910-1990)! It doesn&#39;t yield a value for 0, but otherwise nobody knows.</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">C</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">one?</span> <span class="nv">n</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>          <span class="p">((</span><span class="nb">even? </span><span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nf">C</span> <span class="p">(</span><span class="nb">/ </span><span class="nv">n</span> <span class="mi">2</span><span class="p">)))</span>
</span><span class='line'>          <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">C</span> <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nb">* </span><span class="mi">3</span> <span class="nv">n</span><span class="p">)))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;;          Thank you,Wilhelm ackermann(1853-1946)</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">A</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">m</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">zero? </span><span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="nv">m</span><span class="p">))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">zero? </span><span class="nv">m</span><span class="p">)</span> <span class="p">(</span><span class="nf">A</span> <span class="p">(</span><span class="nb">- </span><span class="mi">1</span> <span class="nv">n</span><span class="p">)</span> <span class="mi">1</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">A</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">)</span>
</span><span class='line'>               <span class="p">(</span><span class="nf">A</span> <span class="nv">n</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">m</span><span class="p">)))))))</span>
</span><span class='line'><span class="c1">;;; What does A have in common with shuffle and looking?</span>
</span><span class='line'><span class="c1">;;;         A&#39;s arguments ,like shuffle&#39;s and looking&#39;s,  do not necessarily decrease for the recursion</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Dose A always give an answer? </span>
</span><span class='line'><span class="c1">;;;         Yes,it&#39;s total</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Wouldn&#39;t it be great if we could write a function that tells us whether some function returns with a </span>
</span><span class='line'><span class="c1">;;; value for every  argument.</span>
</span><span class='line'><span class="c1">;;;        It sure would.Now that we have seen function that never return a value or return a value so lat that </span>
</span><span class='line'><span class="c1">;;;        it is too late ,we should have some tool like this around</span>
</span><span class='line'><span class="c1">;;;Okay,let&#39;s write it</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;            It sounds complicated.A function can work for many different arguments</span>
</span><span class='line'><span class="c1">;;; Then let&#39;s make it simpler.For a warm-up exercise,let&#39;s focus on a function that checks whether some function stops</span>
</span><span class='line'><span class="c1">;;; for just the empty list,the simplest of all arguments.</span>
</span><span class='line'><span class="c1">;;;          That world simplify it a lot</span>
</span><span class='line'><span class="c1">;;; Here is the beginning of this function:</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; (define will-stop?  (lambda (f) ...)))</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; What does it do?  Do will-stop? return a value for all arguments?</span>
</span><span class='line'><span class="c1">;;; That&#39;s the easy part: we said that it either returns #t or #f,depending on whether the argument stops when applied to ()</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Is will-stop? total then?</span>
</span><span class='line'><span class="c1">;;;   Yes,it is.It always return #t or #f</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;okay here is  a function that could be an interesting argument for will-stop?</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">last-try</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">lambda</span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nf">will-stop?</span> <span class="nv">last-try</span><span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">eternity</span> <span class="nv">x</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">;;; what is (will-stop? last-try)</span>
</span><span class='line'>    <span class="c1">;;;</span>
</span><span class='line'>    <span class="c1">;;; What does it do?</span>
</span><span class='line'>    <span class="c1">;;;</span>
</span><span class='line'>    <span class="c1">;;; Here is our meaning:</span>
</span><span class='line'>    <span class="c1">;;;    &quot;we took a really close look at the two possible cases.IF we can define will-stop?,</span>
</span><span class='line'>    <span class="c1">;;;     then (will-stop? last-try) must yield either #t or #f.Bu it cannot- due to the very</span>
</span><span class='line'>    <span class="c1">;;;     definition of what will-stop? is supposed to do.This must mean that will-stop? cannot </span>
</span><span class='line'>    <span class="c1">;;;     be defined&quot;</span>
</span><span class='line'>    <span class="c1">;;;</span>
</span><span class='line'>    <span class="c1">;;;     Because you know,let&#39;s make up some examples.</span>
</span><span class='line'>    <span class="c1">;;;     what is the value of (will-stop? last-try) (eternity (quote ()))))</span>
</span><span class='line'>    <span class="c1">;;;         That depends on the value of (will-stop? last-try)</span>
</span><span class='line'>    <span class="c1">;;;</span>
</span><span class='line'>    <span class="c1">;;;         we said that will-stop? will stop,so it must return #t or #f,</span>
</span><span class='line'>    <span class="c1">;;;         let&#39;s say (will-stop? last-try) is #f ,yes,itis .we predict just the opposite</span>
</span><span class='line'>    <span class="c1">;;;            if the value of (will-stop? last-try) is #f,which really means that last-try</span>
</span><span class='line'>    <span class="c1">;;;            will not stop..</span>
</span><span class='line'>    <span class="c1">;;;        So we must have been wrong about (will-stop? last-try) (because it cannot be stopped)</span>
</span><span class='line'>    <span class="c1">;;;               That&#39;s correct.It must return #t,because will-stop? always gives an answer. we</span>
</span><span class='line'>    <span class="c1">;;;               said it total(assume)</span>
</span><span class='line'>    <span class="c1">;;;         Fine. If(will-stop? last-try) is #t. What is the value of (last-try (quote ())) in the definition of last-try.</span>
</span><span class='line'>    <span class="c1">;;;           Now we just need to determine the value of (and #t (eternity (quote ()))</span>
</span><span class='line'>    <span class="c1">;;;           which is the same as the value of (eternity (quote ()))</span>
</span><span class='line'>    <span class="c1">;;;</span>
</span><span class='line'>    <span class="c1">;;;           What is the value of (eternity (quote ())) </span>
</span><span class='line'>    <span class="c1">;;;                 It doesn&#39;t have a value.we know that it doesn&#39;t stop</span>
</span><span class='line'>    <span class="c1">;;;                 !</span>
</span><span class='line'>    <span class="c1">;;;         But that means that we were wrong again!!! The will-stop? neither return #f nor #t. What the hell</span>
</span><span class='line'>    <span class="c1">;;;                will-stop? will return?</span>
</span><span class='line'>    <span class="c1">;;;</span>
</span><span class='line'>    <span class="c1">;;;         So will-stop? cannot be defined.</span>
</span><span class='line'>    <span class="c1">;;;         Is this unique?</span>
</span><span class='line'>    <span class="c1">;;;                Yes , it is .It makes will-stop? the first function that we can describe percisely but cannot </span>
</span><span class='line'>    <span class="c1">;;;                define in our language.</span>
</span><span class='line'>    <span class="c1">;;;</span>
</span><span class='line'>    <span class="c1">;;;         Is there any way around this problem?</span>
</span><span class='line'>    <span class="c1">;;;                No ,thank you  ,Alan M. Turing (1912-1954)</span>
</span><span class='line'>    <span class="c1">;;;                and Kurt Godel(1906-1978)</span>
</span><span class='line'>    <span class="c1">;;;</span>
</span><span class='line'>    <span class="c1">;;;         What is (define...)</span>
</span><span class='line'>    <span class="c1">;;;                 That is an interesting question. We just saw that (define...) doesn&#39;t work for will-stop?.</span>
</span><span class='line'>    <span class="c1">;;;</span>
</span><span class='line'>    <span class="c1">;;;             So what are the recurive definition?</span>
</span><span class='line'>    <span class="c1">;;;               Hold tight,take a deep breath,and plunge forward when you&#39;re ready.</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;The second part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;****************;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;The third part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;;;;;   myracet3.rkt;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">length</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="p">(</span><span class="nb">length </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">eternity</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">eternity</span> <span class="nv">x</span><span class="p">)))</span>
</span><span class='line'><span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span> <span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="p">(</span><span class="nf">eternity</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))</span>
</span><span class='line'><span class="c1">;length&lt;=1</span>
</span><span class='line'><span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span>
</span><span class='line'>       <span class="p">(</span><span class="nb">+ </span><span class="mi">1</span>
</span><span class='line'>          <span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>             <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>               <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>               <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">+ </span><span class="mi">1</span>
</span><span class='line'>                        <span class="p">(</span><span class="nf">eternity</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))</span>
</span><span class='line'>           <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;length &lt;=2</span>
</span><span class='line'><span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">+ </span><span class="mi">1</span>
</span><span class='line'>        <span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>           <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>             <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>             <span class="p">(</span><span class="k">else </span>
</span><span class='line'>              <span class="p">(</span><span class="nb">+ </span><span class="mi">1</span>
</span><span class='line'>                 <span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>                    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>                      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>                      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>                       <span class="p">(</span><span class="nb">+ </span><span class="mi">1</span>
</span><span class='line'>                          <span class="p">(</span><span class="nf">eternity</span>
</span><span class='line'>                           <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))</span>
</span><span class='line'>                  <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))</span>
</span><span class='line'>         <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; Now what do you thin recursion is?</span>
</span><span class='line'><span class="c1">;;;           What do you mean?</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Well,we have seen how to determine the length of a list with no items,with no more that</span>
</span><span class='line'><span class="c1">;;; one item,with no more than two items,and so on. How could we get the function length back.</span>
</span><span class='line'><span class="c1">;;;           If we could write an infinite function in the style of length0 ,length1,length2..</span>
</span><span class='line'><span class="c1">;;;           then we could write lengthinfinite,which would determine the length of all lists</span>
</span><span class='line'><span class="c1">;;;           we can make.</span>
</span><span class='line'><span class="c1">;;;     But we cannot write an infinite function. No we can&#39;t, (yes ,we can&#39;t mae it)</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;      And we still have all these repetitions and patterns in these functions. yes we do.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;      What do these pattern look like?</span>
</span><span class='line'><span class="c1">;;;               All these programs contain a function that looks like length.Perhaps we should</span>
</span><span class='line'><span class="c1">;;;               abstract out this function: see The Ninth Commandment.</span>
</span><span class='line'><span class="c1">;;;     We need a function that looks just lie length but starts with (lambda (length) ...).</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;Do you mean this?</span>
</span><span class='line'><span class="c1">;;;((lambda (length)</span>
</span><span class='line'><span class="c1">;;;(lambda (l)  (cond ((null? l) 0)  (else (add1 (length (cdr l)))))) eternity)</span>
</span><span class='line'><span class="c1">;;;       Yes,that&#39;s okay. It creates length0</span>
</span><span class='line'><span class="c1">;;;so rewrite length1  in the same style</span>
</span><span class='line'><span class="c1">;;;See below.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;we need a function that looks just like length </span>
</span><span class='line'><span class="c1">;but starts with (lambda (length)...) and inside it is not </span>
</span><span class='line'><span class="c1">;(lambda (length) but maybe (lambda (l)</span>
</span><span class='line'><span class="c1">;length0</span>
</span><span class='line'><span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">legnth</span><span class="p">)</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>        <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nb">length </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))</span>
</span><span class='line'>    <span class="nv">eternity</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">;length1</span>
</span><span class='line'><span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">f</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>        <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="k">else </span>
</span><span class='line'>         <span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>   <span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">g</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>          <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="p">(</span><span class="nf">g</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>    <span class="nv">eternity</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;  Do we have to use length to name the argument?</span>
</span><span class='line'><span class="c1">;;         No ,we just used f and g. As long as we are consistent,everything&#39;s okay</span>
</span><span class='line'><span class="c1">;length2</span>
</span><span class='line'><span class="c1">;;length &lt;=2</span>
</span><span class='line'><span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">length</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="p">(</span><span class="nb">length </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'> <span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">length</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>        <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="p">(</span><span class="nb">length </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>  <span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">length</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>         <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="p">(</span><span class="nb">length </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>   <span class="nv">eternity</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; close,  But there are still repetitions.  True,let&#39;s get rid of it.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;  Where should we start?</span>
</span><span class='line'><span class="c1">;;;         Name the function that takes length as an argument and that returns a function that looks like length.</span>
</span><span class='line'><span class="c1">;;;  What&#39;s a good-name for this function?</span>
</span><span class='line'><span class="c1">;;;           how about mk-length  for &quot;make length&quot;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;let eternity move ahead , eternity in the first part</span>
</span><span class='line'><span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">mk-length</span> <span class="nv">eternity</span><span class="p">))</span>
</span><span class='line'> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">length</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>       <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="p">(</span><span class="nb">length </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
</span><span class='line'>   <span class="c1">;;提取池</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">mk-length</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">mk-length</span> <span class="nv">eternity</span><span class="p">)))</span>
</span><span class='line'> <span class="c1">;;发生池</span>
</span><span class='line'> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">length</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>       <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="p">(</span><span class="nb">length </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))))</span>
</span><span class='line'><span class="c1">;;length&lt;=2</span>
</span><span class='line'><span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
</span><span class='line'>   <span class="c1">;;提取池</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">mk-length</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">mk-length</span>
</span><span class='line'>     <span class="p">(</span><span class="nf">mk-length</span> <span class="nv">eternity</span><span class="p">))))</span>
</span><span class='line'> <span class="c1">;;发生池</span>
</span><span class='line'> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">length</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>       <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="p">(</span><span class="nb">length </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))))</span>
</span><span class='line'> <span class="c1">;;length &lt;=3</span>
</span><span class='line'> <span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
</span><span class='line'>   <span class="c1">;;提取池</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">mk-length</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">mk-length</span>
</span><span class='line'>     <span class="p">(</span><span class="nf">mk-length</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">mk-length</span> <span class="nv">eternity</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">;;;;              So   What is recursion like?</span>
</span><span class='line'>  <span class="c1">;;;                             It is like an infinite tower of applications of mk-length to ab arbitrary function.</span>
</span><span class='line'>  <span class="c1">;;;               Do you really need an infinite tower?</span>
</span><span class='line'>  <span class="c1">;;;                      Not really of course.Everytime we use length we only need a finite number,but we never know </span>
</span><span class='line'>  <span class="c1">;;;                      know many.</span>
</span><span class='line'>  <span class="c1">;;;               could we guess how many we need?</span>
</span><span class='line'>  <span class="c1">;;;                     Sure,but we may not guess a large enough number!</span>
</span><span class='line'>  <span class="c1">;;;               When do  we  find out that we didn&#39;t guess a large enough number?</span>
</span><span class='line'>  <span class="c1">;;;                     When we apply the function eternity that is  passed to innermost mk-length.</span>
</span><span class='line'>  <span class="c1">;;;               What if we could create another application of mk-length to eternity at this point?</span>
</span><span class='line'>  <span class="c1">;;;                       That would only postpone the problem by one and besides,how could we do that?</span>
</span><span class='line'>  <span class="c1">;;;</span>
</span><span class='line'>  <span class="c1">;;;                Well,since nobody cares what function we passwd to mk-length we could pass it mk-length initially.</span>
</span><span class='line'>  <span class="c1">;;;                      That&#39;s the right idea(right?       )             And then we invoke mk-length on eternity and the </span>
</span><span class='line'>  <span class="c1">;;;                      result of this on the cdr so that we get one more piece of this tower.</span>
</span><span class='line'> <span class="c1">;;发生池</span>
</span><span class='line'> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">length</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>       <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">+ </span><span class="mi">1</span> <span class="p">(</span><span class="nb">length </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))))</span>
</span><span class='line'>
</span><span class='line'> <span class="c1">;;how if we replace the eternity with the mk-length</span>
</span><span class='line'>
</span><span class='line'> <span class="c1">;length0; 因为没有人关心我们到底我们传递什么给mk-length 如果他是无穷的话</span>
</span><span class='line'> <span class="c1">;那我们可不可以第一次初始化的时候就传递给他 mk-length 来替代eternity呢？</span>
</span><span class='line'> <span class="c1">;;; Yes,we could even use mk-length instead of length.</span>
</span><span class='line'> <span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="nf">mk-length</span> <span class="nv">mk-length</span><span class="p">))</span>
</span><span class='line'>   <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">length</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>         <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">+ </span><span class="mi">1</span>
</span><span class='line'>                  <span class="p">(</span><span class="nb">length </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))))</span>
</span><span class='line'> <span class="c1">;;和上面一样</span>
</span><span class='line'> <span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="nf">mk-length</span> <span class="nv">mk-length</span><span class="p">))</span>
</span><span class='line'>   <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>         <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">+ </span><span class="mi">1</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">mk-length</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))))</span>
</span><span class='line'> <span class="c1">;; WHy would we want to do that?</span>
</span><span class='line'> <span class="c1">;;         All names are equal, but some names are more equal than others! (with apologies to George Orwell(1903-1950)</span>
</span><span class='line'> <span class="c1">;;         True: as long as we use the names consistently ,we are just fine.</span>
</span><span class='line'> <span class="c1">;;</span>
</span><span class='line'> <span class="c1">;;     And mk-length is a far more equal  name than length. If we use a name like mk-length, it is a  contstant reminder that</span>
</span><span class='line'> <span class="c1">;;      the first argument to mk-length is mk-length</span>
</span><span class='line'>
</span><span class='line'> <span class="c1">;;我们为什么想着上面的做法呢？</span>
</span><span class='line'> <span class="c1">;;因为所有的名字都是一样的，但是有些名字是更一样比其他</span>
</span><span class='line'> <span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">mk-length</span> <span class="nv">mk-length</span><span class="p">))</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>        <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">add1</span>
</span><span class='line'>               <span class="p">((</span><span class="nf">mk-length</span> <span class="nv">eternity</span><span class="p">)</span>
</span><span class='line'>                <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))))</span>
</span><span class='line'>
</span><span class='line'> <span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">mk-length</span> <span class="nv">mk-length</span><span class="p">))</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
</span><span class='line'>    <span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">length</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>           <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>           <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nb">length </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>     <span class="p">(</span><span class="nf">mk-length</span> <span class="nv">mk-length</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; How about this?</span>
</span><span class='line'><span class="c1">;;;     Yes,this looks just fine.</span>
</span><span class='line'><span class="c1">;;; Let&#39;s see thether it works?</span>
</span><span class='line'><span class="c1">;;;      Yes ,okay</span>
</span><span class='line'><span class="c1">;;; First,we need to know the value of it?</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'> <span class="c1">;;; what would  you call this  function above?</span>
</span><span class='line'> <span class="c1">;;;        It&#39;s length,of course</span>
</span><span class='line'> <span class="c1">;;;</span>
</span><span class='line'> <span class="c1">;;;    How does it work?</span>
</span><span class='line'> <span class="c1">;;;           It keeps adding recurive uses by  passing mk-length to itself,just as it is about to expire</span>
</span><span class='line'> <span class="c1">;;;</span>
</span><span class='line'> <span class="c1">;;;           One problem is left: it  no longer contains the function that looks like length.</span>
</span><span class='line'> <span class="c1">;;;</span>
</span><span class='line'> <span class="c1">;;;           can you fix the (mk-length mk-length) .?</span>
</span><span class='line'> <span class="c1">;;;            We could extract this new application of mk-length to itself and call it length</span>
</span><span class='line'> <span class="c1">;;;        WHy?</span>
</span><span class='line'> <span class="c1">;;;             Because it really makes the function length.</span>
</span><span class='line'>
</span><span class='line'> <span class="c1">;;since (mk-length mk-length returns a fucntion of one argument,</span>
</span><span class='line'> <span class="c1">;;does (lambda (x) ((mk-length mk-length) x)) retrun a function of</span>
</span><span class='line'> <span class="c1">;;one argument? Actually,it is a function</span>
</span><span class='line'> <span class="c1">;;</span>
</span><span class='line'> <span class="c1">;;Okay ,let&#39;s do this to the application of mk-length to itself</span>
</span><span class='line'>  <span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">mk-length</span> <span class="nv">mk-length</span><span class="p">))</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>        <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">add1</span>
</span><span class='line'>               <span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>                  <span class="p">((</span><span class="nf">mk-length</span> <span class="nv">mk-length</span><span class="p">)</span> <span class="nv">x</span><span class="p">))</span>
</span><span class='line'>                <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))))</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1">;;move out the new function so that we get length back</span>
</span><span class='line'>  <span class="c1">;;Why can&#39;t you move out (lambda (x) ((mk-length mk-length) x))  </span>
</span><span class='line'>  <span class="c1">;;       </span>
</span><span class='line'>  <span class="c1">;;            Because you add the (lambda (length)  which is like the definition of define.(actually are)</span>
</span><span class='line'>  <span class="c1">;;            also here the meaning of length is  (lambda(x) ((mk-length mk-length) x)),so you can use the</span>
</span><span class='line'>  <span class="c1">;;            usage of lambda(length) and the definition of length in the same S-expressions!!(By zhaoliang)</span>
</span><span class='line'>  <span class="c1">;;                    You know the same S-expression (the same parathese here)</span>
</span><span class='line'>  <span class="c1">;;</span>
</span><span class='line'>  <span class="c1">;;            Is it okay to move out the function?</span>
</span><span class='line'>  <span class="c1">;;                     Yes,we just always did the opposite by replacing a name with its value. Here we</span>
</span><span class='line'>  <span class="c1">;;                     extract a value and give it a name.</span>
</span><span class='line'>  <span class="c1">;;            Can we extract the function in the box(p171) that looks like length and give it a name</span>
</span><span class='line'>  <span class="c1">;;                          Yes,it does not depend on mk-length at all!</span>
</span><span class='line'>  <span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="nf">mk-length</span> <span class="nv">mk-length</span><span class="p">))</span>
</span><span class='line'>   <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
</span><span class='line'>     <span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">length</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>            <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>             <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nb">length </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>        <span class="p">((</span><span class="nf">mk-length</span> <span class="nv">mk-length</span><span class="p">)</span> <span class="nv">x</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;The third part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;***************;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;The fourth part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;;;;;;  myracet4.rkt ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;; Is this the right function!             ------you can check back the nottation above.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;Here the definition of le(lambda (length)...) and the usage of le (lambda (le)...) is in the same </span>
</span><span class='line'><span class="c1">;;;S-expressions!!(the same parathese)</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">le</span><span class="p">)</span>
</span><span class='line'>   <span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">mk-length</span> <span class="nv">mk-length</span><span class="p">))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">le</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>            <span class="p">((</span><span class="nf">mk-length</span> <span class="nv">mk-length</span><span class="p">)</span> <span class="nv">x</span><span class="p">))))))</span>
</span><span class='line'> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">length</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nb">length </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;; Let&#39;s separate the funtion that makes length from the function that looks like length.</span>
</span><span class='line'><span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">le</span><span class="p">)</span>
</span><span class='line'>  <span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="nf">mk-length</span> <span class="nv">mk-length</span><span class="p">))</span>
</span><span class='line'>   <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">mk-length</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="nf">le</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>           <span class="p">((</span><span class="nf">mk-length</span> <span class="nv">mk-length</span><span class="p">)</span> <span class="nv">x</span><span class="p">))))))</span>
</span><span class='line'><span class="c1">;;; Does this function have a name?</span>
</span><span class='line'><span class="c1">;;;         Yes ,it is called the application-order Y combinator.</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">Y</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">le</span><span class="p">)</span>
</span><span class='line'>    <span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">f</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">f</span> <span class="nv">f</span><span class="p">))</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">f</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">le</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>             <span class="p">((</span><span class="nf">f</span> <span class="nv">f</span><span class="p">)</span> <span class="nv">x</span><span class="p">)))))))</span>
</span><span class='line'><span class="c1">;;; the above function is replace the mk-length with  f ,so it looks more common!      BUt</span>
</span><span class='line'><span class="c1">;;;      it lacks the definition of (le)  just the usage of le.so it means the Y combinator.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;      (lambda (length)</span>
</span><span class='line'><span class="c1">;;;            (lambda  (l)</span>
</span><span class='line'><span class="c1">;;;                 ...           ---&lt; it is the definition of function length</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;     ((lambda  (le)</span>
</span><span class='line'><span class="c1">;;;          ...</span>
</span><span class='line'><span class="c1">;;;        )</span>
</span><span class='line'><span class="c1">;;;     (lambda (length)</span>
</span><span class='line'><span class="c1">;;;         ...</span>
</span><span class='line'><span class="c1">;;;         ))</span>
</span><span class='line'><span class="c1">;;;                             ----&lt;  it is the definition of function le is the (lambda (length)...)) and the use </span>
</span><span class='line'><span class="c1">;;;                             of the le is in the (lambda (le) ...)   Take care what the left parathese and right </span>
</span><span class='line'><span class="c1">;;;                             parathese I utilize.</span>
</span><span class='line'><span class="c1">;;;                             ----------------------which is similar to apply-closure that contains three part</span>
</span><span class='line'><span class="c1">;;;                                                            table-of   form-of    body-of</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">;; An entry is a pair of lists whose first list is a set. Also ,the two lists must be of equal </span>
</span><span class='line'><span class="c1">;; length.Make up some examples for entries</span>
</span><span class='line'><span class="c1">;;              Here are some examples:</span>
</span><span class='line'><span class="c1">;;              ((appetizer entree beverage)</span>
</span><span class='line'><span class="c1">;;              (pate boeuf vin))</span>
</span><span class='line'><span class="c1">;;</span>
</span><span class='line'><span class="c1">;;              and</span>
</span><span class='line'><span class="c1">;;              ((appetizer entree beverage)</span>
</span><span class='line'><span class="c1">;;              (beer beer beer)  ---------------------------&lt; but the second list can be not a set</span>
</span><span class='line'><span class="c1">;;</span>
</span><span class='line'><span class="c1">;;              and </span>
</span><span class='line'><span class="c1">;;              (( beverage dessert)</span>
</span><span class='line'><span class="c1">;;               ((food is) (number one with us)))</span>
</span><span class='line'><span class="c1">;;</span>
</span><span class='line'><span class="c1">;;</span>
</span><span class='line'><span class="c1">;;How can we build an entry from a set of names and a list of values?</span>
</span><span class='line'><span class="c1">;;           (define new-entry build)           ----&gt;Try to build our examples with this function.</span>
</span><span class='line'><span class="c1">;;</span>
</span><span class='line'><span class="c1">;;What is (lookup-in-entry name entry)</span>
</span><span class='line'><span class="c1">;;     where name is entree</span>
</span><span class='line'><span class="c1">;;</span>
</span><span class='line'><span class="c1">;;     and entry is ((appetizer entree beverage)</span>
</span><span class='line'><span class="c1">;;                   (food tastes  good))</span>
</span><span class='line'><span class="c1">;;                ------------------------------&gt;tastes</span>
</span><span class='line'><span class="c1">;;</span>
</span><span class='line'><span class="c1">;;      What if name is dessert</span>
</span><span class='line'><span class="c1">;;             In this case we would like to leave the decision about what to do with the user of lookup-in-entry</span>
</span><span class='line'><span class="c1">;;      How can we accomplish this?</span>
</span><span class='line'><span class="c1">;;             lookup-in-entry takes an additional argument this is invoked when name is not found in the first </span>
</span><span class='line'><span class="c1">;;                list of an entry.</span>
</span><span class='line'><span class="c1">;;</span>
</span><span class='line'><span class="c1">;;      How many arguments do you think this extra function should take?</span>
</span><span class='line'><span class="c1">;;            We think it should take one , name. Why?</span>
</span><span class='line'><span class="c1">;;</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;The fourth part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;***************;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;The fifth part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;;;;;myracet5.rkt ;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">atom?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">pair? </span><span class="nv">x</span><span class="p">))</span> <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">null? </span><span class="nv">x</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">build</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">s1</span> <span class="nv">s2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="nv">s1</span>
</span><span class='line'>                  <span class="p">(</span><span class="nb">cons </span><span class="nv">s2</span> <span class="p">(</span><span class="k">quote </span><span class="p">())))))))</span>
</span><span class='line'><span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">nothing</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">nothing</span> <span class="p">(</span><span class="k">quote </span><span class="nv">something</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="k">quote </span><span class="nv">nothing</span><span class="p">))))</span>
</span><span class='line'>   <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;; Here is our dfinition of lookup-in-entry:</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">lookup-in-entry</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">name</span> <span class="nv">entry</span> <span class="nv">entry-f</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">lookup-in-entry-help</span> <span class="nv">name</span>
</span><span class='line'>                          <span class="p">(</span><span class="nf">first</span> <span class="nv">entry</span><span class="p">)</span>
</span><span class='line'>                          <span class="p">(</span><span class="nf">second</span> <span class="nv">entry</span><span class="p">)</span>
</span><span class='line'>                          <span class="p">(</span><span class="nf">entry-f</span><span class="p">))))</span>
</span><span class='line'><span class="c1">;;;Finish the function lookup-in-entry-help-----------------</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">lookup-in-entry-help</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">name</span> <span class="nv">names</span> <span class="nv">values</span> <span class="nv">entry-f</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">names</span><span class="p">)</span> <span class="p">(</span><span class="nf">entry-f</span> <span class="nv">name</span><span class="p">))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">names</span><span class="p">)</span> <span class="nv">name</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">car </span><span class="nv">values</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">lookup-in-entry-help</span> <span class="nv">name</span>
</span><span class='line'>                                  <span class="p">(</span><span class="nb">cdr </span><span class="nv">names</span><span class="p">)</span>
</span><span class='line'>                                  <span class="p">(</span><span class="nb">cdr </span><span class="nv">values</span><span class="p">)</span>
</span><span class='line'>                                  <span class="nv">entry-f</span><span class="p">)))))</span>
</span><span class='line'><span class="c1">;;;     A table(based on entries) (also   called an environment) is a list of entries.Here is one example: The empty table</span>
</span><span class='line'><span class="c1">;;;     ,represented by ()</span>
</span><span class='line'><span class="c1">;;;     Make up some others.</span>
</span><span class='line'><span class="c1">;;;      Here is another one:</span>
</span><span class='line'><span class="c1">;;;                          (((appetizer entree beverage)</span>
</span><span class='line'><span class="c1">;;;                            (pate boeuf vin))</span>
</span><span class='line'><span class="c1">;;;                            ((beverage desert)</span>
</span><span class='line'><span class="c1">;;;                             ((food is) (number one with us)))</span>
</span><span class='line'><span class="c1">;;;                           )</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;         Define the function extend-table which takes an entry and a table (possibly the empty one)</span>
</span><span class='line'><span class="c1">;;;         and create a new table by putting the new entry in front of the old table.</span>
</span><span class='line'><span class="c1">;;;         (define extend-table cons)</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; What is  </span>
</span><span class='line'><span class="c1">;;;         (lookup-in-table name table table-f)</span>
</span><span class='line'><span class="c1">;;;          where </span>
</span><span class='line'><span class="c1">;;;                 name is entree</span>
</span><span class='line'><span class="c1">;;;                 table is (((entree dessert)</span>
</span><span class='line'><span class="c1">;;;                            (spaghetti spumoni))</span>
</span><span class='line'><span class="c1">;;;                           ((appetizer entree beverage)</span>
</span><span class='line'><span class="c1">;;;                            (food tastes good)))</span>
</span><span class='line'><span class="c1">;;;                 and </span>
</span><span class='line'><span class="c1">;;;                    table-f is (lambda (name) ...)</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;             -----&gt; It could be either spaghetti or tastes,but lookup-in-table searches the list of entries in order</span>
</span><span class='line'><span class="c1">;;;                    So it is spaghetti</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Can you describe what the following function </span>
</span><span class='line'><span class="c1">;;; represents:</span>
</span><span class='line'><span class="c1">;;;            (lambda (name)</span>
</span><span class='line'><span class="c1">;;;                (lookup-in-table name</span>
</span><span class='line'><span class="c1">;;;                     (cdr table)</span>
</span><span class='line'><span class="c1">;;;                     table-f))</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;                     ---------------------------&gt; This function is the action to take when the name is not found in the first entry</span>
</span><span class='line'><span class="c1">;;;                                                  In one table there are a set of entries (set means each of the entries is different </span>
</span><span class='line'><span class="c1">;;;                                                  from each other)</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Have we chosen a good representation for expressions?</span>
</span><span class='line'><span class="c1">;;;           Yes .They are all S-expressions so they can be data for functions.</span>
</span><span class='line'><span class="c1">;;; What kind of functions?</span>
</span><span class='line'><span class="c1">;;;           For example ,value(later on ,the value is defined as another name  compiler.(like gcc  gfortran  ifort  python perl etc)</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Do you remember value from chapter 6?</span>
</span><span class='line'><span class="c1">;;;          Recall that value is the function that returns the natural value of expressions.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; What is the value of</span>
</span><span class='line'><span class="c1">;;;  (car (quote (a b c)))</span>
</span><span class='line'><span class="c1">;;;         We don&#39;t even know  what (quote (a b c)) is .---------------------------------&lt;&lt;&lt;&lt;The original state of you learning english!</span>
</span><span class='line'><span class="c1">;;;                                                                          You don&#39;t know &#39;am&#39; &#39;are&#39; &#39;is&#39; etc.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;What is the value of</span>
</span><span class='line'><span class="c1">;;;      (cons rep-a</span>
</span><span class='line'><span class="c1">;;;        (cons rep-b</span>
</span><span class='line'><span class="c1">;;;          (cons rep-c</span>
</span><span class='line'><span class="c1">;;;             (quote ()))))</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;     Where </span>
</span><span class='line'><span class="c1">;;;       rep-a is a</span>
</span><span class='line'><span class="c1">;;;       rep-b is b</span>
</span><span class='line'><span class="c1">;;;     and</span>
</span><span class='line'><span class="c1">;;;       rep-c is c</span>
</span><span class='line'><span class="c1">;;;                                         ==================&gt;&gt; It is the same as (a b c)</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;And what is the value of</span>
</span><span class='line'><span class="c1">;;; (cons rep-car</span>
</span><span class='line'><span class="c1">;;;     (cons (cons rep-quote</span>
</span><span class='line'><span class="c1">;;;              (cons </span>
</span><span class='line'><span class="c1">;;;                  (cons rep-a</span>
</span><span class='line'><span class="c1">;;;                     (cons rep-b</span>
</span><span class='line'><span class="c1">;;;                        (cons rep-c</span>
</span><span class='line'><span class="c1">;;;                             (quote ()))))</span>
</span><span class='line'><span class="c1">;;;                  (quote ())))</span>
</span><span class='line'><span class="c1">;;;       (quote ())))</span>
</span><span class='line'><span class="c1">;;;       where </span>
</span><span class='line'><span class="c1">;;;         rep-car is car</span>
</span><span class='line'><span class="c1">;;;         rep-quote is quote</span>
</span><span class='line'><span class="c1">;;;         rep-a is a</span>
</span><span class='line'><span class="c1">;;;         rep-b is b</span>
</span><span class='line'><span class="c1">;;;         and</span>
</span><span class='line'><span class="c1">;;;         rep-c is c</span>
</span><span class='line'><span class="c1">;;;                                        ====================&gt;&gt; It is the representation of the expressions:</span>
</span><span class='line'><span class="c1">;;;                                                                      (car (quote (a b c)))</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;                                                                      ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^</span>
</span><span class='line'><span class="c1">;;;                                                                      The above is  what I say: Lisp is the data with program!</span>
</span><span class='line'><span class="c1">;;;                                                                              Data can be code,code can also become data!</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; What is value of</span>
</span><span class='line'><span class="c1">;;;      (car (quote (a b c)))           </span>
</span><span class='line'><span class="c1">;;;                                       =====================&gt;&gt; a</span>
</span><span class='line'><span class="c1">;;; What is (value e)</span>
</span><span class='line'><span class="c1">;;;      where </span>
</span><span class='line'><span class="c1">;;;          e is (car (quote (a b c)))</span>
</span><span class='line'><span class="c1">;;;                                       =====================&gt;&gt; a</span>
</span><span class='line'><span class="c1">;;; What is (value e)</span>
</span><span class='line'><span class="c1">;;;       where </span>
</span><span class='line'><span class="c1">;;;           e is (quote (car (quote (a b c))))</span>
</span><span class='line'><span class="c1">;;;                                       =====================&gt;&gt; (car (quote (a b c)))</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; What is (value e)</span>
</span><span class='line'><span class="c1">;;;        where</span>
</span><span class='line'><span class="c1">;;;            e is (add1 6)</span>
</span><span class='line'><span class="c1">;;;                                        ====================&gt;&gt; 7</span>
</span><span class='line'><span class="c1">;;; What is (value e)</span>
</span><span class='line'><span class="c1">;;;        where </span>
</span><span class='line'><span class="c1">;;;            e is 6</span>
</span><span class='line'><span class="c1">;;;                                        ====================&gt;&gt; 6 .because numbers are constants</span>
</span><span class='line'><span class="c1">;;; What is (value e)</span>
</span><span class='line'><span class="c1">;;;        where </span>
</span><span class='line'><span class="c1">;;;            e is (quote nothing)</span>
</span><span class='line'><span class="c1">;;;                                        ====================&gt;&gt; nothing</span>
</span><span class='line'><span class="c1">;;; What is (value e)</span>
</span><span class='line'><span class="c1">;;;         where</span>
</span><span class='line'><span class="c1">;;;           e is ((lambda (nothing)</span>
</span><span class='line'><span class="c1">;;;                    (cons nothing (quote ())))</span>
</span><span class='line'><span class="c1">;;;                 (quote </span>
</span><span class='line'><span class="c1">;;;                    (from nothing comes something)))</span>
</span><span class='line'><span class="c1">;;;                                        ====================&gt;&gt; ((from nothing come something)).</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; What is (value e)</span>
</span><span class='line'><span class="c1">;;;        where </span>
</span><span class='line'><span class="c1">;;;            e is ((lambda (nothing)</span>
</span><span class='line'><span class="c1">;;;                     (cond</span>
</span><span class='line'><span class="c1">;;;                        (nothing (quote something))</span>
</span><span class='line'><span class="c1">;;;                        (else (quote nothing))))</span>
</span><span class='line'><span class="c1">;;;                  #t)             -------------------------&lt; It means nothing is #t(The semtatics of language (the infer of language))</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;                                       =====================&gt;&gt; something</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; What is the type of e</span>
</span><span class='line'><span class="c1">;;;         where  </span>
</span><span class='line'><span class="c1">;;;              e is 6</span>
</span><span class='line'><span class="c1">;;;                                        ====================&gt;&gt; *const</span>
</span><span class='line'><span class="c1">;;; What is the type of e</span>
</span><span class='line'><span class="c1">;;;         where </span>
</span><span class='line'><span class="c1">;;;              e is #f</span>
</span><span class='line'><span class="c1">;;;                                       ======================&gt;&gt; *const</span>
</span><span class='line'><span class="c1">;;; What is (value e)</span>
</span><span class='line'><span class="c1">;;;         where </span>
</span><span class='line'><span class="c1">;;;              e is #f                 ======================&gt;&gt; #f</span>
</span><span class='line'><span class="c1">;;;; What is the type of e</span>
</span><span class='line'><span class="c1">;;;         where </span>
</span><span class='line'><span class="c1">;;;              e is cons</span>
</span><span class='line'><span class="c1">;;;                                       ======================&gt;&gt; *const             -----------------------&gt;I think is must be somethin wrong </span>
</span><span class='line'><span class="c1">;;;                                                                                   -----------------------&gt;I think it is primitive car</span>
</span><span class='line'><span class="c1">;;;                                                                                   -----------------------&gt;I am wrong ,primitive is also *const</span>
</span><span class='line'><span class="c1">;;;;; What is the type of e</span>
</span><span class='line'><span class="c1">;;;         where </span>
</span><span class='line'><span class="c1">;;;              e is car</span>
</span><span class='line'><span class="c1">;;;                                       ======================&gt;&gt; (primitive car)</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;;;; What is the type of e</span>
</span><span class='line'><span class="c1">;;;         where </span>
</span><span class='line'><span class="c1">;;;              e is (quote nothing)</span>
</span><span class='line'><span class="c1">;;;                                       ======================&gt;&gt; *quote</span>
</span><span class='line'><span class="c1">;;; What is the type of e</span>
</span><span class='line'><span class="c1">;;;         where </span>
</span><span class='line'><span class="c1">;;;              e is nothing</span>
</span><span class='line'><span class="c1">;;;                                       ======================&gt;&gt; *identifier</span>
</span><span class='line'><span class="c1">;;;;;; What is the type of e</span>
</span><span class='line'><span class="c1">;;;         where </span>
</span><span class='line'><span class="c1">;;;              e is (lambda (x y) (cons x y))</span>
</span><span class='line'><span class="c1">;;;                                       ======================&gt;&gt; *lambda</span>
</span><span class='line'><span class="c1">;;; What is the type of e</span>
</span><span class='line'><span class="c1">;;;         where </span>
</span><span class='line'><span class="c1">;;;              e is ((lambda (nothing)</span>
</span><span class='line'><span class="c1">;;;                      (cond</span>
</span><span class='line'><span class="c1">;;;                          (nothing (quote something))</span>
</span><span class='line'><span class="c1">;;;                          (else (quote nothing))))</span>
</span><span class='line'><span class="c1">;;;                     #t)</span>
</span><span class='line'><span class="c1">;;;                                       ======================&gt;&gt; *application</span>
</span><span class='line'><span class="c1">;;; What is the type of e</span>
</span><span class='line'><span class="c1">;;;         where </span>
</span><span class='line'><span class="c1">;;;              e is (cond</span>
</span><span class='line'><span class="c1">;;;                      (nothing  (quote something))</span>
</span><span class='line'><span class="c1">;;;                      (else (quote nothing)))</span>
</span><span class='line'><span class="c1">;;;                                       ======================&gt;&gt; *cond</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; How many types do you think there are?</span>
</span><span class='line'><span class="c1">;;;                          we found six:</span>
</span><span class='line'><span class="c1">;;;                                         *const</span>
</span><span class='line'><span class="c1">;;;                                         *quote</span>
</span><span class='line'><span class="c1">;;;                                         *identifier</span>
</span><span class='line'><span class="c1">;;;                                         *lambda</span>
</span><span class='line'><span class="c1">;;;                                         *cond</span>
</span><span class='line'><span class="c1">;;;                                         and</span>
</span><span class='line'><span class="c1">;;;                                           *application</span>
</span><span class='line'><span class="c1">;;; How do you think we should represent types?</span>
</span><span class='line'><span class="c1">;;;              We choose functions.We call these functions &quot;action&quot;;------------------------------------&lt;In python ,it is called as objects</span>
</span><span class='line'><span class="c1">;;;                                                                   or,in oop(orient object programming) ,it is called as objects</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; If actions are functions that do &quot;the right thing&quot;  when applied to the appropriate type of expression,</span>
</span><span class='line'><span class="c1">;;;                 What should value do?</span>
</span><span class='line'><span class="c1">;;;     You guessed it. It would have to find out the type of expression it was passed  and then use the associated action.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Do you remember atom-to-function from chapter8?</span>
</span><span class='line'><span class="c1">;;;         We found atom-to-function usefule when we rewrote value for numbered expressions.</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">lookup-in-table</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">name</span> <span class="nv">table</span> <span class="nv">table-f</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">table</span><span class="p">)</span> <span class="p">(</span><span class="nf">table-f</span> <span class="nv">name</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">lookup-in-entry</span> <span class="nv">name</span>
</span><span class='line'>                             <span class="p">(</span><span class="nb">car </span><span class="nv">table</span><span class="p">)</span>
</span><span class='line'>                             <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">name</span><span class="p">)</span>
</span><span class='line'>                               <span class="p">(</span><span class="nf">lookup-in-table</span> <span class="nv">name</span>
</span><span class='line'>                                                <span class="p">(</span><span class="nb">cdr </span><span class="nv">table</span><span class="p">)</span>
</span><span class='line'>                                                <span class="p">(</span><span class="nf">table-f</span><span class="p">))))))))</span>
</span><span class='line'><span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">name</span> <span class="nv">table</span> <span class="nv">table-f</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">lookup-in-table</span> <span class="nv">name</span>
</span><span class='line'>                     <span class="p">(</span><span class="nb">cdr </span><span class="nv">table</span><span class="p">)</span>
</span><span class='line'>                     <span class="p">(</span><span class="nf">table-f</span><span class="p">)))</span>
</span><span class='line'><span class="c1">;;; Below is a function that produces the correct action (or function) for each possible S-expression:</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; The top level make-up</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">expression-to-action</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">e</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">e</span><span class="p">)</span> <span class="p">(</span><span class="nf">atom-to-action</span> <span class="nv">e</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">list-to-action</span> <span class="nv">e</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; IN the III-formed S-expressions suchas (quote a b), () , (lambda (#t) #t),(lambda (4) 4)  ,(lambda (car) car)</span>
</span><span class='line'><span class="c1">;;;         (lambda a),(cond (3 c) (else b) (5 a)) , And (1 2) are not considered here.They can be detected by an </span>
</span><span class='line'><span class="c1">;;;         appropriate function to which S-expressions are submitted before they are passed to value.</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">atom-to-action</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">e</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">number? </span><span class="nv">e</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="no">#t</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="no">#f</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="p">(</span><span class="k">quote </span><span class="nv">cons</span><span class="p">))</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="p">(</span><span class="k">quote </span><span class="nv">car</span><span class="p">))</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="p">(</span><span class="k">quote </span><span class="nv">cdr</span><span class="p">))</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="p">(</span><span class="k">quote </span><span class="nv">null?</span><span class="p">))</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="p">(</span><span class="k">quote </span><span class="nv">eq?</span><span class="p">))</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="p">(</span><span class="k">quote </span><span class="nv">atom?</span><span class="p">))</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="p">(</span><span class="k">quote </span><span class="nv">zero?</span><span class="p">))</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="p">(</span><span class="k">quote </span><span class="nv">add1</span><span class="p">))</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="p">(</span><span class="k">quote </span><span class="nv">sub1</span><span class="p">))</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="p">(</span><span class="k">quote </span><span class="nv">number?</span><span class="p">))</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="nv">*identifier</span><span class="p">))))</span>
</span><span class='line'><span class="c1">;;;; so *const is consed by three parts: primitive part ,number , #t or #f part.(not include string part, because string part is called *identifier)</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;By zhaoliang</span>
</span><span class='line'><span class="c1">;;;It means that the following identifier can see the list as its function&#39;s argument!    --------------------------&lt;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">list-to-action</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">e</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">e</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>         <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">e</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="nv">quote</span><span class="p">))</span>
</span><span class='line'>          <span class="nv">*quote</span><span class="p">)</span>
</span><span class='line'>         <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">e</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="nv">lambda</span><span class="p">))</span>
</span><span class='line'>          <span class="nv">*lambda</span><span class="p">)</span>
</span><span class='line'>         <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">e</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="nv">cond</span><span class="p">))</span>
</span><span class='line'>          <span class="nv">*cond</span><span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="k">else </span><span class="nv">*application</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="nv">*application</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;;; So the compiler is comming on the way............................</span>
</span><span class='line'><span class="c1">;;;       If we assuming the expression-to-action works,we can use it to define value and meanning</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">value</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">e</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">meaning</span> <span class="nv">e</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))))</span>  <span class="c1">;;;Now table is empty set.</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">meaning</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">e</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>    <span class="p">((</span><span class="nf">expression-to-action</span> <span class="nv">e</span><span class="p">)</span> <span class="nv">e</span> <span class="nv">table</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;; The function value, together with all the functions it uses ,is called an interpreter.(Note that: all the relevent function value use</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;The function value approximates the function eval  available in Schemes(and Lisp)</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;How many arguments should actions take according to the above?</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;             Two,the expression e and a table</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Here is the action for constants:</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">*const</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">e</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">number? </span><span class="nv">e</span><span class="p">)</span> <span class="nv">e</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="no">#t</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="no">#f</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">build</span> <span class="p">(</span><span class="k">quote </span><span class="nv">primitive</span><span class="p">)</span> <span class="nv">e</span><span class="p">)))))</span>  <span class="c1">;;;;-----------------&lt;&lt;&lt;&lt; Yes,primitive car,primitive con,primitive cdr</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; Here is the action for constants:</span>
</span><span class='line'><span class="c1">;;; </span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">*quote</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">e</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">text-of</span> <span class="nv">e</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">first</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">p</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">car </span><span class="nv">p</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">second</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">p</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="nv">car</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">p</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">third</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">p</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="nv">car</span> <span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">p</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">text-of</span> <span class="nv">second</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; Have we used the table yet?</span>
</span><span class='line'><span class="c1">;;;                   No, But we will in a moment.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Why do we need the table?</span>
</span><span class='line'><span class="c1">;;;                   To remember the values of identifiers</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;; Given that the table contains the values of identifiers ,write the action of *identifier</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">*identifier</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">e</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">lookup-in-table</span> <span class="nv">e</span> <span class="nv">table</span> <span class="nv">initial-table</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; Here is the initial-table ---------------------------------------------&gt;&gt;&gt;&gt;&gt;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">initial-table</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">name</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="k">quote </span><span class="p">()))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; When is it used?</span>
</span><span class='line'><span class="c1">;;;                       Let&#39;s hope never. Why?</span>
</span><span class='line'><span class="c1">;;</span>
</span><span class='line'><span class="c1">;;What is the value of (lambda (x) x)</span>
</span><span class='line'><span class="c1">;;         We don&#39;t know yet, But we know that it must be the representation for a non-primitive</span>
</span><span class='line'><span class="c1">;;                  function.</span>
</span><span class='line'><span class="c1">;;</span>
</span><span class='line'><span class="c1">;;  How are non-primitive functions different from primitives?</span>
</span><span class='line'><span class="c1">;;   We know what primitives do;  non-primitives are defined by their argumentss and their function bodier</span>
</span><span class='line'><span class="c1">;;                                                     ^^^^^ ^^ ^^^^^ ^^^^^^^^^^ ^^^ ^^^^^ ^^^^^^^^ ^^^^^^</span>
</span><span class='line'><span class="c1">;;                                                     What does it mean?</span>
</span><span class='line'><span class="c1">;;                                                      arguments (x y ...)       function bodier: x</span>
</span><span class='line'><span class="c1">;;  So when we want to use a non-primitive we need to remember its formal arguments and its function body.</span>
</span><span class='line'><span class="c1">;;       At least. Fortunately this is just the cdr of a lambda expression! Because the car of the lambda expression is lambda</span>
</span><span class='line'><span class="c1">;;</span>
</span><span class='line'><span class="c1">;;  And what else do we need to remember?</span>
</span><span class='line'><span class="c1">;;                             </span>
</span><span class='line'><span class="c1">;;                              We wll also put the table in,just in case we might need it later</span>
</span><span class='line'><span class="c1">;;</span>
</span><span class='line'><span class="c1">;;  And How do we represent this?</span>
</span><span class='line'><span class="c1">;;                   In a list,of course.</span>
</span><span class='line'><span class="c1">;;</span>
</span><span class='line'><span class="c1">;; Here is the action *lambda</span>
</span><span class='line'><span class="c1">;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">*lambda</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">e</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">build</span> <span class="p">(</span><span class="k">quote </span><span class="nv">non-primitive</span><span class="p">)</span>
</span><span class='line'>           <span class="p">(</span><span class="nb">cons </span><span class="nv">table</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">e</span><span class="p">)))))</span>
</span><span class='line'><span class="c1">;;; What is (meanning a table)</span>
</span><span class='line'><span class="c1">;;;        where</span>
</span><span class='line'><span class="c1">;;;              e is (lambda (x) (cons x y))</span>
</span><span class='line'><span class="c1">;;;        and</span>
</span><span class='line'><span class="c1">;;;              table is (((y z) ((8) 9)))</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;              ==========================================&gt;&gt;&gt; (non-primitive</span>
</span><span class='line'><span class="c1">;;;                                                                   (   (((y z) ((8) 9)))         (x)             (cons x y)   ))</span>
</span><span class='line'><span class="c1">;;;                                                                       ^^^^^^^^^^^^^^^^^         ^^^             ^^^^^^^^^^^^^^^</span>
</span><span class='line'><span class="c1">;;;                                                                           table                 formals             body</span>
</span><span class='line'><span class="c1">;;;It is probably a good idea to define some help functions for getting back the parts in this three elements</span>
</span><span class='line'><span class="c1">;;;list (i.e. the tables,the formal arguments,and the body).</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">table-of</span> <span class="nv">first</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">formals-of</span> <span class="nv">second</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">body-of</span> <span class="nv">third</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; Describe (cond...) in your own words</span>
</span><span class='line'><span class="c1">;;;     </span>
</span><span class='line'><span class="c1">;;;      It is a special form that takes any number of cond-lines. It considers</span>
</span><span class='line'><span class="c1">;;;      each line in turn. If the question part on the left is false, it looks</span>
</span><span class='line'><span class="c1">;;;      at the rest of the lines.Otherwise it proceeds to answer the right part.</span>
</span><span class='line'><span class="c1">;;;       If it sees an else-line,it treats that cond-line as if its question part</span>
</span><span class='line'><span class="c1">;;;       were true.</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;;</span>
</span><span class='line'><span class="c1">;;; Here is the function evcon that does what we said in words</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">evcon</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lines</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nf">else?</span> <span class="p">(</span><span class="nf">question-of</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lines</span><span class="p">)))</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">meaning</span> <span class="p">(</span><span class="nf">answer-of</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lines</span><span class="p">))</span>
</span><span class='line'>                <span class="nv">table</span><span class="p">))</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">meaning</span> <span class="p">(</span><span class="nf">question-of</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lines</span><span class="p">))</span>
</span><span class='line'>                <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">meaning</span> <span class="p">(</span><span class="nf">answer-of</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lines</span><span class="p">))</span>
</span><span class='line'>                <span class="nv">table</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">evcon</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lines</span><span class="p">)</span> <span class="nv">table</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;; else? determine whether the (car expression)  is else or not!</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">else?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">eq? </span><span class="nv">x</span> <span class="p">(</span><span class="k">quote </span><span class="nv">else</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="no">#f</span><span class="p">))))</span>
</span><span class='line'><span class="c1">;;; didn&#39;t we violate the First Commandment?</span>
</span><span class='line'><span class="c1">;;;          Yes,we don&#39;t ask (null? lines), so one of the questions in every cond better be true</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">question-of</span> <span class="nv">first</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">answer-of</span> <span class="nv">second</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; Now use the function evcon to write the *cond action</span>
</span><span class='line'><span class="c1">;;; </span>
</span><span class='line'><span class="c1">;;; Here is the action for *cond</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">*cond</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">e</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">evcon</span> <span class="p">(</span><span class="nf">cond-lines-of</span> <span class="nv">e</span><span class="p">)</span> <span class="nv">table</span><span class="p">)))</span>
</span><span class='line'><span class="c1">;;; Aren&#39;t these help functions useful?</span>
</span><span class='line'><span class="c1">;;;          Yes they make things quite a bit more readable.But you already knew that.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Do you understand *cond now?</span>
</span><span class='line'><span class="c1">;;;           Perhaps not</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; How can you become familiar with it?</span>
</span><span class='line'><span class="c1">;;;         The best way is to try an example.</span>
</span><span class='line'><span class="c1">;;;         A good one (examples ) is</span>
</span><span class='line'><span class="c1">;;;                (*cond e table)</span>
</span><span class='line'><span class="c1">;;;                  where </span>
</span><span class='line'><span class="c1">;;;                       e is (cond (coffee klatsch) (else (party))</span>
</span><span class='line'><span class="c1">;;;                  and </span>
</span><span class='line'><span class="c1">;;;                       table is (((coffee) (#t))</span>
</span><span class='line'><span class="c1">;;;                                 ((klatsch party) (5 (6))))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">cond-lines-of</span> <span class="nv">cdr</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;; Have we seen how the table gets used?</span>
</span><span class='line'><span class="c1">;;;            Yes,*lambda and *identifier use it</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;But how do the identifiers get into the table?</span>
</span><span class='line'><span class="c1">;;;            In the only action we have not defined:</span>
</span><span class='line'><span class="c1">;;;                      *application</span>
</span><span class='line'><span class="c1">;;;                      ^^^^^^^^^^^^</span>
</span><span class='line'><span class="c1">;;;                      ||||||||||||</span>
</span><span class='line'><span class="c1">;;; How is an application represented?</span>
</span><span class='line'><span class="c1">;;;       </span>
</span><span class='line'><span class="c1">;;;        An application us a list of  expressions whose car position contains an expression whose value is a function.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;How does an application differ from a special form, like (and ...) (or ...) or (cond ...)</span>
</span><span class='line'><span class="c1">;;;     An application must always determine the meaning of all its arguments.</span>
</span><span class='line'><span class="c1">;;; Before we can apply a function ,do we have to get the meaning of all of its arguments?</span>
</span><span class='line'><span class="c1">;;;       Yes.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Write a function evils that takes a list of (representations of) arguments and a table, and</span>
</span><span class='line'><span class="c1">;;;  returns a list composed of the meaning of each argument</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">evlis</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">args</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">args</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">meaning</span> <span class="p">(</span><span class="nb">car </span><span class="nv">args</span><span class="p">)</span> <span class="nv">table</span><span class="p">)</span>  <span class="c1">;;; really  importan  for every argument!</span>
</span><span class='line'>             <span class="p">(</span><span class="nf">evlis</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">args</span><span class="p">)</span> <span class="nv">table</span><span class="p">))))))</span>
</span><span class='line'><span class="c1">;;;; What else do we need before we can determine the meaning of an application?</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;We need to find out what its function-of means</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;And what then?</span>
</span><span class='line'><span class="c1">;;;  </span>
</span><span class='line'><span class="c1">;;;  Then we apply the meaning of the function to the meaning of the arguments</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;  Here is *application</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">*application</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">e</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">apply</span>
</span><span class='line'>     <span class="p">(</span><span class="nf">meaning</span> <span class="p">(</span><span class="nf">function-of</span> <span class="nv">e</span><span class="p">)</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="nf">evlis</span> <span class="p">(</span><span class="nf">arguments-of</span> <span class="nv">e</span><span class="p">)</span> <span class="nv">table</span><span class="p">))))</span>
</span><span class='line'><span class="c1">;;; Of course, we just have to define apply , function-of, and arguments-of correctly</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">function-of</span> <span class="nv">car</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">arguments-of</span> <span class="nv">cdr</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;; How many different kinds of functions are there?</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;     Two: primitive and non-primitive</span>
</span><span class='line'><span class="c1">;;; What are the two representation of functions?</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; (primitive primitive-name)</span>
</span><span class='line'><span class="c1">;;; and (non-primitive (table formals body))</span>
</span><span class='line'><span class="c1">;;;      The list (table formals body) is called a  closure record.</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;      Write primitive? and non-primitive?</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">primitive?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">eq? </span><span class="p">(</span><span class="nf">first</span> <span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="nv">primitive</span><span class="p">))))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">non-primitive?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">eq? </span><span class="p">(</span><span class="nf">first</span> <span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="nv">non-primitive</span><span class="p">))))</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; If fun does not evaluate to either a primitive or a non-primitive as</span>
</span><span class='line'><span class="c1">;;;         in the expression ((lambda (x) (x 5)) 3) ------&lt;&lt;&lt; This expression cannot be detected in the now preocedure</span>
</span><span class='line'><span class="c1">;;;         there is no answer. The function apply approximatly the funcion apply available in Scheme (and lisp)</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">apply</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">fun</span> <span class="nv">vals</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">primitive?</span> <span class="nv">fun</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">apply-primitive</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">second</span> <span class="nv">fun</span><span class="p">)</span> <span class="nv">vals</span><span class="p">))</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">non-primitive?</span> <span class="nv">fun</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">apply-closure</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">second</span> <span class="nv">fun</span><span class="p">)</span> <span class="nv">vals</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;; This is the definition of apply-primitive</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">apply-primitive</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">name</span> <span class="nv">vals</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">name</span> <span class="p">(</span><span class="k">quote </span><span class="nv">cons</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">)</span> <span class="p">(</span><span class="nf">second</span> <span class="nv">vals</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">name</span> <span class="p">(</span><span class="k">quote </span><span class="nv">car</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">name</span> <span class="p">(</span><span class="k">quote </span><span class="nv">cdr</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">name</span> <span class="p">(</span><span class="k">quote </span><span class="nv">null?</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">null? </span><span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">name</span> <span class="p">(</span><span class="k">quote </span><span class="nv">eq?</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">eq? </span><span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">)</span> <span class="p">(</span><span class="nf">second</span> <span class="nv">vals</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">name</span> <span class="p">(</span><span class="k">quote </span><span class="nv">atom?</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">:atom?</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">name</span> <span class="p">(</span><span class="k">quote </span><span class="nv">zero?</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">zero? </span><span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">name</span> <span class="p">(</span><span class="k">quote </span><span class="nv">add1</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">name</span> <span class="p">(</span><span class="k">quote </span><span class="nv">sub1</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">sub1</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">name</span> <span class="p">(</span><span class="k">quote </span><span class="nv">number?</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">number? </span><span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">))))))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">:atom?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="nv">x</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">x</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="nv">primitive</span><span class="p">))</span>
</span><span class='line'>       <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="nv">non-primitive</span><span class="p">))</span>
</span><span class='line'>       <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="no">#f</span><span class="p">))))</span>
</span><span class='line'><span class="c1">;;;Is apply-closure  the only function left?</span>
</span><span class='line'><span class="c1">;;;        Yes,and apply-closure must extent the table</span>
</span><span class='line'><span class="c1">;;;                    extent the table?</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;     how could we first find the result of (f a b)</span>
</span><span class='line'><span class="c1">;;;     where</span>
</span><span class='line'><span class="c1">;;;       f is (lambda (x y) (cons x y))</span>
</span><span class='line'><span class="c1">;;;       a is 1</span>
</span><span class='line'><span class="c1">;;;       and </span>
</span><span class='line'><span class="c1">;;;       b  is (2)</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;       ===================That&#39;s tricky. But we know what to do to find the meaning of (cons x y)</span>
</span><span class='line'><span class="c1">;;;                                               where </span>
</span><span class='line'><span class="c1">;;;                                                     table is (((x y)</span>
</span><span class='line'><span class="c1">;;;                                                                (1 (2)))).</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;  Table is the contain of the variables defined by you!!!</span>
</span><span class='line'><span class="c1">;;;  Why can we do this?</span>
</span><span class='line'><span class="c1">;;;           Here ,we don&#39;t need apply-closure</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;; Can you generalize the last two steps?</span>
</span><span class='line'><span class="c1">;;;                                 Applying a non-primitive function --a closure---to</span>
</span><span class='line'><span class="c1">;;;                                 a list of values  is the same as finding the meaning  of </span>
</span><span class='line'><span class="c1">;;;                                 closure&#39;s body with its table extended by an entry of the form</span>
</span><span class='line'><span class="c1">;;;                                 (formals values)</span>
</span><span class='line'><span class="c1">;;;                                 In this entry,formals is the formals of closure and values is </span>
</span><span class='line'><span class="c1">;;;                                 the result of evils</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">apply-closure</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">closure</span> <span class="nv">vals</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">meaning</span> <span class="p">(</span><span class="nf">body-of</span> <span class="nv">closure</span><span class="p">)</span>
</span><span class='line'>             <span class="p">(</span><span class="nf">extend-table</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">new-entry</span>
</span><span class='line'>               <span class="p">(</span><span class="nf">formals-of</span> <span class="nv">closure</span><span class="p">)</span>
</span><span class='line'>               <span class="nv">vals</span><span class="p">)</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">table-of</span> <span class="nv">closure</span><span class="p">)))))</span>
</span><span class='line'><span class="c1">;;;; This is a complicated function and it deserves an example.</span>
</span><span class='line'><span class="c1">;;;         In the following,</span>
</span><span class='line'><span class="c1">;;;              closure is ((((u v w)          ;;; entry name</span>
</span><span class='line'><span class="c1">;;;                            (1 2 3))         ;;; entry value</span>
</span><span class='line'><span class="c1">;;;                            ((x y  z)        ;;;;entry name</span>
</span><span class='line'><span class="c1">;;;                             (4 5 6)))       ;;;; entry value</span>
</span><span class='line'><span class="c1">;;;                            (x y)             ;;; formal</span>
</span><span class='line'><span class="c1">;;;                            (cons z x))        ;;; body </span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">new-entry</span> <span class="nv">build</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">extend-table</span> <span class="nv">cons</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;The fifth part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;****************;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;The sixth part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;;;;; myracet6.rkt ;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'><span class="c1">;;;</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">member1?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nb">eq? </span><span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">member1?</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</span><span class='line'><span class="c1">;;the most common thinking,find it and then continul</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">is-first?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">a</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">two-in-a-row?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nf">is-first?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))</span>
</span><span class='line'>           <span class="p">(</span><span class="nf">two-in-a-row?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</span><span class='line'><span class="c1">;;;the development, more close,but if-first-b must use</span>
</span><span class='line'><span class="c1">;;the two-in-a-row? ,so can we write a version which </span>
</span><span class='line'><span class="c1">;;didn&#39;t use two-in-a-row? at all?</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">is-first-b?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">a</span> <span class="p">)</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">two-in-a-row?</span> <span class="nv">lat</span><span class="p">))))))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">two-in-a-row-b?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">is-first-b?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))))</span>
</span><span class='line'><span class="c1">;;the is-first-b? only do the job about eq?,so why can I</span>
</span><span class='line'><span class="c1">;;let is-first-b? also do another thing,recur. So I</span>
</span><span class='line'><span class="c1">;;don&#39;t need two-in-a-row? again.</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">is-first-c?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">preceding</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">preceding</span><span class="p">)</span>
</span><span class='line'>           <span class="p">(</span><span class="nf">is-first-c?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                        <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">two-in-a-row-c?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">is-first-c?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>                         <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))))</span>
</span><span class='line'><span class="c1">;;although two-in-a-row-c? and two-in-a-row-b? look</span>
</span><span class='line'><span class="c1">;;the same in the shape;</span>
</span><span class='line'><span class="c1">;;but the essence is not the same!</span>
</span><span class='line'><span class="c1">;;version b, is just encasual the is-first? and two-</span>
</span><span class='line'><span class="c1">;;in-a-row?</span>
</span><span class='line'><span class="c1">;;version c, is updated version, used it by itself?</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">sum-of-prefixes-b</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">sonssf</span> <span class="nv">tup</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">tup</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">+ </span><span class="nv">sonssf</span> <span class="p">(</span><span class="nb">car </span><span class="nv">tup</span><span class="p">))</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">sum-of-prefixes-b</span>
</span><span class='line'>                   <span class="p">(</span><span class="nb">+ </span><span class="nv">sonssf</span> <span class="p">(</span><span class="nb">car </span><span class="nv">tup</span><span class="p">))</span><span class="c1">;;thinking hole</span>
</span><span class='line'>                   <span class="p">(</span><span class="nb">cdr </span><span class="nv">tup</span><span class="p">)))))))</span>
</span><span class='line'><span class="c1">;;not leave before,important for your thinking</span>
</span><span class='line'><span class="c1">;;(sum-of-prefixes-b 0 &#39;(1 3 5))</span>
</span><span class='line'><span class="c1">;;two arguments</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">pick</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span>
</span><span class='line'>       <span class="p">(</span><span class="nf">pick</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">scramble-b</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">tup</span> <span class="nv">rev-pre</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">tup</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">pick</span> <span class="p">(</span><span class="nb">car </span><span class="nv">tup</span><span class="p">)</span>
</span><span class='line'>                   <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">tup</span><span class="p">)</span> <span class="nv">rev-pre</span><span class="p">))</span>
</span><span class='line'>             <span class="p">(</span><span class="nf">scramble-b</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">tup</span><span class="p">)</span>
</span><span class='line'>                         <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">tup</span><span class="p">)</span> <span class="nv">rev-pre</span><span class="p">)))))))</span>
</span><span class='line'><span class="c1">;;&gt;  (scramble-b &#39;(1 1 1 3 4 2 1 1 9 2) (quote ()))</span>
</span><span class='line'><span class="c1">;;&#39;(1 1 1 1 1 4 1 1 1 9)</span>
</span><span class='line'><span class="c1">;;(scramble-b &#39;(2 1 1 3 4 2 1 1 9 2) (quote ())) have a bug</span>
</span><span class='line'><span class="c1">;;&gt; (scramble-b &#39;(1 2 1 3 4 2 1 1 9 2) (quote ()))</span>
</span><span class='line'><span class="c1">;;&#39;(1 1 1 2 2 4 1 1 1 9)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;the base procedure</span>
</span><span class='line'><span class="c1">;;result     rev-pre</span>
</span><span class='line'><span class="c1">;;1          1</span>
</span><span class='line'><span class="c1">;;1 1        2(tup di er wei) 1</span>
</span><span class='line'><span class="c1">;;1 1 1      1(tup di san wei) 2 1</span>
</span><span class='line'><span class="c1">;;1 1 1 2    3 1 2 1 (from here to select the index 3 so is 2)</span>
</span><span class='line'><span class="c1">;;1 1 1 2 2  4 3 1 2 1  (select the index 4 of lat)</span>
</span><span class='line'><span class="c1">;;1 1 1 2 2 4    2 4 3 1 2 1</span>
</span><span class='line'><span class="c1">;;1 1 1 2 2 4 1  1 2 4 3 1 2 1</span>
</span><span class='line'><span class="c1">;;1 1 1 2 2 4 1 1     1 1 2 4 3 1 2 1</span>
</span><span class='line'><span class="c1">;;1 1 1 2 2 4 1 1 1   9 1 1 2 4 2 1 2 1</span>
</span><span class='line'><span class="c1">;;1 1 1 2 2 4 1 1 1 9   2 9 1 1 2 4 2 1 2 1</span>
</span><span class='line'><span class="c1">;;actually in the list of the lat,</span>
</span><span class='line'><span class="c1">;;the first number in the rev-pre expose the target I </span>
</span><span class='line'><span class="c1">;;should get from the rev-pre,so on the one-hand,I should</span>
</span><span class='line'><span class="c1">;;pick-up the value according the index from varient and</span>
</span><span class='line'><span class="c1">;;increasing lat ,on the second hand I should constuct</span>
</span><span class='line'><span class="c1">;;the varient list of revpre!</span>
</span><span class='line'><span class="c1">;;step1 car the current tup </span>
</span><span class='line'><span class="c1">;;step2 and put it into the list of revpre</span>
</span><span class='line'><span class="c1">;;step3 watch the index it on the list of revpre</span>
</span><span class='line'><span class="c1">;;step4 put the index value into the results! ok!</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;The sixth part;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">; Chapter 11 of The Seasoned Schemer:</span>
</span><span class='line'><span class="c1">; Welcome Back to the Show</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">; Code examples assemled by Peteris Krumins (peter@catonmat.net).</span>
</span><span class='line'><span class="c1">; His blog is at http://www.catonmat.net  --  good coders code, great reuse.</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">; Get yourself this wonderful book at Amazon: http://bit.ly/8cyjgw</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Remember member? from The Little Schemer? (http://bit.ly/4GjWdP)</span>
</span><span class='line'><span class="c1">; It finds if an element &#39;a&#39; is in a list of atoms &#39;lat&#39;.</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">member?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nb">eq? </span><span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">member?</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">; member? helper function</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">member1?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">yes?</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>               <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>                 <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>                 <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>                 <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">yes?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">yes?</span> <span class="nv">l</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">; is-first? function finds out whether the next element in lat, if there is</span>
</span><span class='line'><span class="c1">; one, is identical to this element.</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">is-first?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">a</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; two-in-a-row? function determines whether any atom occurs twice in a row.</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">two-in-a-row?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nf">is-first?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">two-in-a-row?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Examples of two-in-a-row?</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">two-in-a-row?</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">Italian</span> <span class="nv">sardines</span> <span class="nv">spaghetti</span> <span class="nv">parsley</span><span class="p">))</span>           <span class="c1">; false</span>
</span><span class='line'><span class="p">(</span><span class="nf">two-in-a-row?</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">Italian</span> <span class="nv">sardines</span> <span class="nv">sardines</span> <span class="nv">spaghetti</span> <span class="nv">parsley</span><span class="p">))</span>  <span class="c1">; true</span>
</span><span class='line'><span class="p">(</span><span class="nf">two-in-a-row?</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">Italian</span> <span class="nv">sardines</span> <span class="nv">more</span> <span class="nv">sardines</span> <span class="nv">spaghetti</span><span class="p">))</span>     <span class="c1">; false</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Another version of two-in-a-row? that leaves decision of what to do to</span>
</span><span class='line'><span class="c1">; is-first-b?</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">two-in-a-row-2?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">is-first-b?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; is-first-b? function for two-in-a-row-2?</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">is-first-b?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">two-in-a-row-2?</span> <span class="nv">lat</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Examples of two-in-a-row-2?</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">two-in-a-row-2?</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">Italian</span> <span class="nv">sardines</span> <span class="nv">spaghetti</span> <span class="nv">parsley</span><span class="p">))</span>           <span class="c1">; false</span>
</span><span class='line'><span class="p">(</span><span class="nf">two-in-a-row-2?</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">Italian</span> <span class="nv">sardines</span> <span class="nv">sardines</span> <span class="nv">spaghetti</span> <span class="nv">parsley</span><span class="p">))</span>  <span class="c1">; true</span>
</span><span class='line'><span class="p">(</span><span class="nf">two-in-a-row-2?</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">Italian</span> <span class="nv">sardines</span> <span class="nv">more</span> <span class="nv">sardines</span> <span class="nv">spaghetti</span><span class="p">))</span>     <span class="c1">; false</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Another version of two-in-a-row? that recurs itself instead of using</span>
</span><span class='line'><span class="c1">; is-first?</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">two-in-a-row-b?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">preceding</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">preceding</span><span class="p">)</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">two-in-a-row-b?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The final version of two-in-a-row?</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">two-in-a-row-final?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">two-in-a-row-b?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">two-in-a-row-final?</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">Italian</span> <span class="nv">sardines</span> <span class="nv">spaghetti</span> <span class="nv">parsley</span><span class="p">))</span>           <span class="c1">; false</span>
</span><span class='line'><span class="p">(</span><span class="nf">two-in-a-row-final?</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">Italian</span> <span class="nv">sardines</span> <span class="nv">sardines</span> <span class="nv">spaghetti</span> <span class="nv">parsley</span><span class="p">))</span>  <span class="c1">; true</span>
</span><span class='line'><span class="p">(</span><span class="nf">two-in-a-row-final?</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">Italian</span> <span class="nv">sardines</span> <span class="nv">more</span> <span class="nv">sardines</span> <span class="nv">spaghetti</span><span class="p">))</span>     <span class="c1">; false</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Helper function for upcoming sum-of-prefixes function</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">sum-of-prefixes-b</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">sonssf</span> <span class="nv">tup</span><span class="p">)</span>     <span class="c1">; sonssf stands for &#39;sum of numbers seen so far&#39;</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">tup</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">+ </span><span class="nv">sonssf</span> <span class="p">(</span><span class="nb">car </span><span class="nv">tup</span><span class="p">))</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">sum-of-prefixes-b</span>
</span><span class='line'>                   <span class="p">(</span><span class="nb">+ </span><span class="nv">sonssf</span> <span class="p">(</span><span class="nb">car </span><span class="nv">tup</span><span class="p">))</span>
</span><span class='line'>                   <span class="p">(</span><span class="nb">cdr </span><span class="nv">tup</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; sum-of-prefixes function finds the running sum of a list of numbers</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">sum-of-prefixes</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">tup</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">sum-of-prefixes-b</span> <span class="mi">0</span> <span class="nv">tup</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Examples of sum-of-prefixes</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">sum-of-prefixes</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">2</span> <span class="mi">1</span> <span class="mi">9</span> <span class="mi">17</span> <span class="mi">0</span><span class="p">))</span>   <span class="c1">; &#39;(2 3 12 29 29)</span>
</span><span class='line'><span class="p">(</span><span class="nf">sum-of-prefixes</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">))</span>    <span class="c1">; &#39;(1 2 3 4 5)</span>
</span><span class='line'><span class="p">(</span><span class="nf">sum-of-prefixes</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">))</span>        <span class="c1">; &#39;(1 2 3)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;                                                                            ;</span>
</span><span class='line'><span class="c1">; The eleventh commandment                                                   ;</span>
</span><span class='line'><span class="c1">;                                                                            ;</span>
</span><span class='line'><span class="c1">; Use additional arguments when a function needs to know what the other      ;</span>
</span><span class='line'><span class="c1">; arguments to the function have been like so far.                           ;</span>
</span><span class='line'><span class="c1">;                                                                            ;</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Remember the pick function from chapter 4 of The Little Schemer?</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">pick</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">one?</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">pick</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; It uses one? and sub1 helper functions</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">one?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">= </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">sub1</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; scramble-b is a helper function for scramble</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">scramble-b</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">tup</span> <span class="nv">rev-pre</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">tup</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">pick</span> <span class="p">(</span><span class="nb">car </span><span class="nv">tup</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">tup</span><span class="p">)</span> <span class="nv">rev-pre</span><span class="p">))</span>
</span><span class='line'>             <span class="p">(</span><span class="nf">scramble-b</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">tup</span><span class="p">)</span>
</span><span class='line'>                         <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">tup</span><span class="p">)</span> <span class="nv">rev-pre</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; scramble</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">scramble</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">tup</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">scramble-b</span> <span class="nv">tup</span> <span class="o">&#39;</span><span class="p">())))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Examples of scramble</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">scramble</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">2</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">9</span> <span class="mi">2</span><span class="p">))</span>       <span class="c1">; &#39;(1 1 1 1 1 4 1 1 1 9)</span>
</span><span class='line'><span class="p">(</span><span class="nf">scramble</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span><span class="p">))</span>         <span class="c1">; &#39;(1 1 1 1 1 1 1 1 1)</span>
</span><span class='line'><span class="p">(</span><span class="nf">scramble</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">1</span> <span class="mi">8</span> <span class="mi">2</span> <span class="mi">10</span><span class="p">))</span>    <span class="c1">; &#39;(1 1 1 1 1 1 1 1 2 8 2)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">; Chapter 12 of The Seasoned Schemer:</span>
</span><span class='line'><span class="c1">; Take Cover</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">; Code examples assemled by Peteris Krumins (peter@catonmat.net).</span>
</span><span class='line'><span class="c1">; His blog is at http://www.catonmat.net  --  good coders code, great reuse.</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">; Get yourself this wonderful book at Amazon: http://bit.ly/8cyjgw</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; add1 primitive</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">add1</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="mi">1</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The Y-combinator</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">Y</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">le</span><span class="p">)</span>
</span><span class='line'>    <span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">f</span><span class="p">)</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">f</span><span class="p">))</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">f</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">le</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">((</span><span class="nf">f</span> <span class="nv">f</span><span class="p">)</span> <span class="nv">x</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; length function written via Y-combinator and applied to &#39;(a b c)</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">((</span><span class="nf">Y</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">length</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>         <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nb">length </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))))</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span><span class="p">))</span>  <span class="c1">; produces output 3</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; No need to pass &#39;a&#39; around in multirember</span>
</span><span class='line'><span class="c1">; Use Y-combinator not to pass it around</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">multirember</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">((</span><span class="nf">Y</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">mr</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>              <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>              <span class="p">((</span><span class="nb">eq? </span><span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span> <span class="p">(</span><span class="nf">mr</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>               <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">mr</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))))))</span>
</span><span class='line'>     <span class="nv">lat</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Example of multirember</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">multirember</span> <span class="ss">&#39;a</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> <span class="nv">a</span> <span class="nv">a</span> <span class="nv">a</span> <span class="nv">x</span><span class="p">))</span>             <span class="c1">; &#39;(b c x)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; multirember via letrec</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">multirember-letrec</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">((</span><span class="nf">letrec</span>
</span><span class='line'>       <span class="p">((</span><span class="nf">mr</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>                <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>                <span class="p">((</span><span class="nb">eq? </span><span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span> <span class="p">(</span><span class="nf">mr</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>                  <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">mr</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))))))</span>
</span><span class='line'>       <span class="nv">mr</span><span class="p">)</span>
</span><span class='line'>     <span class="nv">lat</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Example of multirember-letrec</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">multirember-letrec</span> <span class="ss">&#39;a</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> <span class="nv">a</span> <span class="nv">a</span> <span class="nv">a</span> <span class="nv">x</span><span class="p">))</span>      <span class="c1">; &#39;(b c x) </span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Structure of letrec</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">; ((letrec ((mr ...)) mr) values)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Another way to write multirember via letrec</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">multirember-letrec-2</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">mr</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
</span><span class='line'>             <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>               <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>               <span class="p">((</span><span class="nb">eq? </span><span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span> <span class="p">(</span><span class="nf">mr</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))</span>
</span><span class='line'>               <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>                 <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">mr</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))))))</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">mr</span> <span class="nv">lat</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Another test of applying multirember-letrec-2</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">multirember-letrec-2</span> <span class="ss">&#39;a</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> <span class="nv">a</span> <span class="nv">a</span> <span class="nv">a</span> <span class="nv">x</span><span class="p">))</span>      <span class="c1">; &#39;(b c x) </span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;                                                                            ;</span>
</span><span class='line'><span class="c1">; The twelfth commandment                                                    ;</span>
</span><span class='line'><span class="c1">;                                                                            ;</span>
</span><span class='line'><span class="c1">; Use (letrec ...) to remove arguments that do not change for recursive      ;</span>
</span><span class='line'><span class="c1">; applications.                                                              ;</span>
</span><span class='line'><span class="c1">;                                                                            ;</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Yet another way to write multirember via letrec</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">multirember-letrec-3</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>    <span class="p">((</span><span class="nf">mr</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>           <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>             <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>             <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">mr</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))</span>
</span><span class='line'>             <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>               <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nf">mr</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))))))</span>
</span><span class='line'>    <span class="nv">mr</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Test multirember-letrec-3</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">multirember-letrec-3</span> <span class="ss">&#39;a</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> <span class="nv">a</span> <span class="nv">a</span> <span class="nv">a</span> <span class="nv">x</span><span class="p">))</span>      <span class="c1">; &#39;(b c x) </span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The member? function determines if the given element is in the list</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">member?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">member?</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Test member?</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">member?</span> <span class="ss">&#39;x</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> <span class="nv">x</span> <span class="nv">d</span> <span class="nv">e</span> <span class="nv">f</span><span class="p">))</span>   <span class="c1">; #t</span>
</span><span class='line'><span class="p">(</span><span class="nf">member?</span> <span class="ss">&#39;x</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> <span class="nv">d</span> <span class="nv">e</span> <span class="nv">f</span><span class="p">))</span>     <span class="c1">; #f</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; member? via letrec</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">member-letrec?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">((</span><span class="nf">letrec</span>
</span><span class='line'>       <span class="p">((</span><span class="nf">yes?</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>                  <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>                  <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>                  <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">yes?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>     <span class="nv">yes?</span><span class="p">)</span>
</span><span class='line'>    <span class="nv">l</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Test member-letrec?</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">member-letrec?</span> <span class="ss">&#39;x</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> <span class="nv">x</span> <span class="nv">d</span> <span class="nv">e</span> <span class="nv">f</span><span class="p">))</span>   <span class="c1">; #t</span>
</span><span class='line'><span class="p">(</span><span class="nf">member-letrec?</span> <span class="ss">&#39;x</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> <span class="nv">d</span> <span class="nv">e</span> <span class="nv">f</span><span class="p">))</span>     <span class="c1">; #f</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Another member? via letrec</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">member-letrec-2?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">yes?</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>               <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>                 <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>                 <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>                 <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">yes?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">yes?</span> <span class="nv">l</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Test member-letrec-2?</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">member-letrec-2?</span> <span class="ss">&#39;x</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> <span class="nv">x</span> <span class="nv">d</span> <span class="nv">e</span> <span class="nv">f</span><span class="p">))</span>   <span class="c1">; #t</span>
</span><span class='line'><span class="p">(</span><span class="nf">member-letrec-2?</span> <span class="ss">&#39;x</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">c</span> <span class="nv">d</span> <span class="nv">e</span> <span class="nv">f</span><span class="p">))</span>     <span class="c1">; #f</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The union function takes two sets and merges them</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">union</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set1</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">member?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">union</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">set1</span><span class="p">)</span> <span class="p">(</span><span class="nf">union</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Example of union</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">union</span>
</span><span class='line'>  <span class="o">&#39;</span><span class="p">(</span><span class="nv">tomatoes</span> <span class="k">and </span><span class="nv">macaroni</span> <span class="nv">casserole</span><span class="p">)</span>
</span><span class='line'>  <span class="o">&#39;</span><span class="p">(</span><span class="nv">macaroni</span> <span class="k">and </span><span class="nv">cheese</span><span class="p">))</span> <span class="c1">; &#39;(tomatoes and macaroni casserole cheese)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; union via letrec</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">union-letrec</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set1</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">U</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>              <span class="p">((</span><span class="nb">null? </span><span class="nv">set</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>              <span class="p">((</span><span class="nf">member?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">set</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>               <span class="p">(</span><span class="nf">U</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set</span><span class="p">)))</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>                <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">set</span><span class="p">)</span> <span class="p">(</span><span class="nf">U</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set</span><span class="p">))))))))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">U</span> <span class="nv">set1</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Test of union-letrec</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">union-letrec</span>
</span><span class='line'>  <span class="o">&#39;</span><span class="p">(</span><span class="nv">tomatoes</span> <span class="k">and </span><span class="nv">macaroni</span> <span class="nv">casserole</span><span class="p">)</span>
</span><span class='line'>  <span class="o">&#39;</span><span class="p">(</span><span class="nv">macaroni</span> <span class="k">and </span><span class="nv">cheese</span><span class="p">))</span> <span class="c1">; &#39;(tomatoes and macaroni casserole cheese)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;                                                                            ;</span>
</span><span class='line'><span class="c1">; The thirteenth commandment                                                 ;</span>
</span><span class='line'><span class="c1">;                                                                            ;</span>
</span><span class='line'><span class="c1">; Use (letrec ...) to hide and to protect functions.                         ;</span>
</span><span class='line'><span class="c1">;                                                                            ;</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">union-letrec-protected</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set1</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">U</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>              <span class="p">((</span><span class="nb">null? </span><span class="nv">set</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>              <span class="p">((</span><span class="nf">M?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">set</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>               <span class="p">(</span><span class="nf">U</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set</span><span class="p">)))</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>                <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">set</span><span class="p">)</span> <span class="p">(</span><span class="nf">U</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set</span><span class="p">)))))))</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">M?</span>
</span><span class='line'>         <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>           <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>             <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>             <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>             <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>               <span class="p">(</span><span class="nf">M?</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">U</span> <span class="nv">set1</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Test of union-letrec-protected</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">union-letrec-protected</span>
</span><span class='line'>  <span class="o">&#39;</span><span class="p">(</span><span class="nv">tomatoes</span> <span class="k">and </span><span class="nv">macaroni</span> <span class="nv">casserole</span><span class="p">)</span>
</span><span class='line'>  <span class="o">&#39;</span><span class="p">(</span><span class="nv">macaroni</span> <span class="k">and </span><span class="nv">cheese</span><span class="p">))</span> <span class="c1">; &#39;(tomatoes and macaroni casserole cheese)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Fixing M? to follow 12th commandment</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">union-letrec-protected-12</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set1</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">U</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>              <span class="p">((</span><span class="nb">null? </span><span class="nv">set</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>              <span class="p">((</span><span class="nf">M?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">set</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>               <span class="p">(</span><span class="nf">U</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set</span><span class="p">)))</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>                <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">set</span><span class="p">)</span> <span class="p">(</span><span class="nf">U</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set</span><span class="p">)))))))</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">M?</span>
</span><span class='line'>         <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>           <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>             <span class="p">((</span><span class="nf">N?</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
</span><span class='line'>                    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>                      <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>                      <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>                      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>                        <span class="p">(</span><span class="nf">N?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</span><span class='line'>             <span class="p">(</span><span class="nf">N?</span> <span class="nv">lat</span><span class="p">)))))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">U</span> <span class="nv">set1</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Test of union-letrec-protected-12</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">union-letrec-protected-12</span>
</span><span class='line'>  <span class="o">&#39;</span><span class="p">(</span><span class="nv">tomatoes</span> <span class="k">and </span><span class="nv">macaroni</span> <span class="nv">casserole</span><span class="p">)</span>
</span><span class='line'>  <span class="o">&#39;</span><span class="p">(</span><span class="nv">macaroni</span> <span class="k">and </span><span class="nv">cheese</span><span class="p">))</span> <span class="c1">; &#39;(tomatoes and macaroni casserole cheese)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The two-in-a-row? checks if a lat contains two equal elements</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">two-in-a-row?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">W</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>              <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>              <span class="p">((</span><span class="nb">eq? </span><span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">W</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>        <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">W</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Test two-in-a-row?</span>
</span><span class='line'><span class="c1">; </span>
</span><span class='line'><span class="p">(</span><span class="nf">two-in-a-row?</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">Italian</span> <span class="nv">sardines</span> <span class="nv">spaghetti</span> <span class="nv">parsley</span><span class="p">))</span>           <span class="c1">; #f</span>
</span><span class='line'><span class="p">(</span><span class="nf">two-in-a-row?</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">Italian</span> <span class="nv">sardines</span> <span class="nv">sardines</span> <span class="nv">spaghetti</span> <span class="nv">parsley</span><span class="p">))</span>  <span class="c1">; #t</span>
</span><span class='line'><span class="p">(</span><span class="nf">two-in-a-row?</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">Italian</span> <span class="nv">sardines</span> <span class="nv">more</span> <span class="nv">sardines</span> <span class="nv">spaghetti</span><span class="p">))</span>     <span class="c1">; #f</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Another version of two-in-a-row?</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">two-in-a-row-2?</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>    <span class="p">((</span><span class="nf">W</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>            <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>            <span class="p">((</span><span class="nb">eq? </span><span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">))</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">W</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>        <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">W</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Test two-in-a-row-2?</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">two-in-a-row-2?</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">Italian</span> <span class="nv">sardines</span> <span class="nv">spaghetti</span> <span class="nv">parsley</span><span class="p">))</span>           <span class="c1">; #f</span>
</span><span class='line'><span class="p">(</span><span class="nf">two-in-a-row-2?</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">Italian</span> <span class="nv">sardines</span> <span class="nv">sardines</span> <span class="nv">spaghetti</span> <span class="nv">parsley</span><span class="p">))</span>  <span class="c1">; #t</span>
</span><span class='line'><span class="p">(</span><span class="nf">two-in-a-row-2?</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">Italian</span> <span class="nv">sardines</span> <span class="nv">more</span> <span class="nv">sardines</span> <span class="nv">spaghetti</span><span class="p">))</span>     <span class="c1">; #f</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The sum-of-prefixes finds the running sum of a list of numbers</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">sum-of-prefixes</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">tup</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">S</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">sss</span> <span class="nv">tup</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>              <span class="p">((</span><span class="nb">null? </span><span class="nv">tup</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>                <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">+ </span><span class="nv">sss</span> <span class="p">(</span><span class="nb">car </span><span class="nv">tup</span><span class="p">))</span>
</span><span class='line'>                      <span class="p">(</span><span class="nf">S</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">sss</span> <span class="p">(</span><span class="nb">car </span><span class="nv">tup</span><span class="p">))</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">tup</span><span class="p">))))))))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">S</span> <span class="mi">0</span> <span class="nv">tup</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Examples of sum-of-prefixes</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">sum-of-prefixes</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">2</span> <span class="mi">1</span> <span class="mi">9</span> <span class="mi">17</span> <span class="mi">0</span><span class="p">))</span>   <span class="c1">; &#39;(2 3 12 29 29)</span>
</span><span class='line'><span class="p">(</span><span class="nf">sum-of-prefixes</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">))</span>    <span class="c1">; &#39;(1 2 3 4 5)</span>
</span><span class='line'><span class="p">(</span><span class="nf">sum-of-prefixes</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">))</span>        <span class="c1">; &#39;(1 2 3)</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">intersect</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set1</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">set1</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>  <span class="c1">; don&#39;t forget the 1st commandment</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">member?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">set1</span><span class="p">)</span> <span class="p">(</span><span class="nf">intersect</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">intersect</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set1</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; It needs member? helper function</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">member?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">yes?</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>               <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>                 <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>                 <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>                 <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">yes?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">yes?</span> <span class="nv">l</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Examples of intersect</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">intersect</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">x</span> <span class="nv">c</span> <span class="nv">d</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">q</span> <span class="nv">w</span> <span class="nv">e</span> <span class="nv">x</span> <span class="nv">r</span> <span class="nv">t</span> <span class="nv">y</span> <span class="nv">a</span><span class="p">))</span>     <span class="c1">; &#39;(a x)</span>
</span><span class='line'><span class="p">(</span><span class="nf">intersect</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">x</span> <span class="nv">c</span> <span class="nv">d</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>                    <span class="c1">; &#39;()</span>
</span><span class='line'><span class="p">(</span><span class="nf">intersect</span> <span class="o">&#39;</span><span class="p">()</span> <span class="o">&#39;</span><span class="p">())</span>                             <span class="c1">; &#39;()</span>
</span><span class='line'><span class="p">(</span><span class="nf">intersect</span> <span class="o">&#39;</span><span class="p">()</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">x</span> <span class="nv">c</span> <span class="nv">d</span><span class="p">))</span>                    <span class="c1">; &#39;()</span>
</span><span class='line'><span class="p">(</span><span class="nf">intersect</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">x</span> <span class="nv">c</span> <span class="nv">d</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">x</span> <span class="nv">c</span> <span class="nv">d</span><span class="p">))</span>           <span class="c1">; &#39;(a b x c d)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; We forgot the 12th commandment - use letrec to remove arguments</span>
</span><span class='line'><span class="c1">; that do not change for recursive applications</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">intersect-letrec</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set1</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">I</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">set</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>              <span class="p">((</span><span class="nb">null? </span><span class="nv">set</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>              <span class="p">((</span><span class="nf">member?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">set</span><span class="p">)</span> <span class="nv">set2</span><span class="p">)</span>
</span><span class='line'>               <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">set</span><span class="p">)</span> <span class="p">(</span><span class="nf">I</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set</span><span class="p">))))</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">I</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">set</span><span class="p">)))))))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">I</span> <span class="nv">set1</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Test of intersect-letrec</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">intersect-letrec</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">x</span> <span class="nv">c</span> <span class="nv">d</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">q</span> <span class="nv">w</span> <span class="nv">e</span> <span class="nv">x</span> <span class="nv">r</span> <span class="nv">t</span> <span class="nv">y</span> <span class="nv">a</span><span class="p">))</span>     <span class="c1">; &#39;(a x)</span>
</span><span class='line'><span class="p">(</span><span class="nf">intersect-letrec</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">x</span> <span class="nv">c</span> <span class="nv">d</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>                    <span class="c1">; &#39;()</span>
</span><span class='line'><span class="p">(</span><span class="nf">intersect-letrec</span> <span class="o">&#39;</span><span class="p">()</span> <span class="o">&#39;</span><span class="p">())</span>                             <span class="c1">; &#39;()</span>
</span><span class='line'><span class="p">(</span><span class="nf">intersect-letrec</span> <span class="o">&#39;</span><span class="p">()</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">x</span> <span class="nv">c</span> <span class="nv">d</span><span class="p">))</span>                    <span class="c1">; &#39;()</span>
</span><span class='line'><span class="p">(</span><span class="nf">intersect-letrec</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">x</span> <span class="nv">c</span> <span class="nv">d</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">x</span> <span class="nv">c</span> <span class="nv">d</span><span class="p">))</span>           <span class="c1">; &#39;(a b x c d)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The intersectall function finds intersect of a bunch of sets</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">intersectall</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lset</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">lset</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">lset</span><span class="p">))</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lset</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">intersect</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lset</span><span class="p">)</span>
</span><span class='line'>                   <span class="p">(</span><span class="nf">intersectall</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lset</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Examples of intersectall</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">; Examples of intersectall</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">intersectall</span> <span class="o">&#39;</span><span class="p">((</span><span class="nf">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">a</span><span class="p">)))</span>                   <span class="c1">; &#39;(a)</span>
</span><span class='line'><span class="p">(</span><span class="nf">intersectall</span> <span class="o">&#39;</span><span class="p">((</span><span class="nf">a</span><span class="p">)</span> <span class="p">()</span> <span class="p">(</span><span class="nf">a</span><span class="p">)))</span>                    <span class="c1">; &#39;()</span>
</span><span class='line'><span class="p">(</span><span class="nf">intersectall</span> <span class="o">&#39;</span><span class="p">())</span>                              <span class="c1">; &#39;()</span>
</span><span class='line'><span class="p">(</span><span class="nf">intersectall</span> <span class="o">&#39;</span><span class="p">((</span><span class="nf">a</span> <span class="nv">b</span> <span class="nv">c</span> <span class="nv">d</span><span class="p">)</span> <span class="p">(</span><span class="nf">b</span> <span class="nv">c</span> <span class="nv">d</span> <span class="nv">e</span><span class="p">)</span> <span class="p">(</span><span class="nf">c</span> <span class="nv">d</span> <span class="nv">e</span> <span class="nv">f</span><span class="p">)))</span> <span class="c1">; &#39;(c d)</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">intersectall-letrec</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lset</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">A</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lset</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>              <span class="p">((</span><span class="nb">null? </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">lset</span><span class="p">))</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lset</span><span class="p">))</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">intersect</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lset</span><span class="p">)</span>
</span><span class='line'>                           <span class="p">(</span><span class="nf">A</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lset</span><span class="p">))))))))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>        <span class="p">((</span><span class="nb">null? </span><span class="nv">lset</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">A</span> <span class="nv">lset</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Tests of intersectall-letrec</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">intersectall-letrec</span> <span class="o">&#39;</span><span class="p">((</span><span class="nf">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">a</span><span class="p">)))</span>                   <span class="c1">; &#39;(a)</span>
</span><span class='line'><span class="p">(</span><span class="nf">intersectall-letrec</span> <span class="o">&#39;</span><span class="p">((</span><span class="nf">a</span><span class="p">)</span> <span class="p">()</span> <span class="p">(</span><span class="nf">a</span><span class="p">)))</span>                    <span class="c1">; &#39;()</span>
</span><span class='line'><span class="p">(</span><span class="nf">intersectall-letrec</span> <span class="o">&#39;</span><span class="p">())</span>                              <span class="c1">; &#39;()</span>
</span><span class='line'><span class="p">(</span><span class="nf">intersectall-letrec</span> <span class="o">&#39;</span><span class="p">((</span><span class="nf">a</span> <span class="nv">b</span> <span class="nv">c</span> <span class="nv">d</span><span class="p">)</span> <span class="p">(</span><span class="nf">b</span> <span class="nv">c</span> <span class="nv">d</span> <span class="nv">e</span><span class="p">)</span> <span class="p">(</span><span class="nf">c</span> <span class="nv">d</span> <span class="nv">e</span> <span class="nv">f</span><span class="p">)))</span> <span class="c1">; &#39;(c d)</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">; Introducing letcc</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">intersectall-letcc</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lset</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">call-with-current-continuation</span>
</span><span class='line'>      <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">hop</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>          <span class="p">((</span><span class="nf">A</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lset</span><span class="p">)</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>                  <span class="p">((</span><span class="nb">null? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lset</span><span class="p">))</span> <span class="p">(</span><span class="nf">hop</span> <span class="o">&#39;</span><span class="p">()))</span>
</span><span class='line'>                  <span class="p">((</span><span class="nb">null? </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">lset</span><span class="p">))</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lset</span><span class="p">))</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>                    <span class="p">(</span><span class="nf">intersect</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lset</span><span class="p">)</span>
</span><span class='line'>                               <span class="p">(</span><span class="nf">A</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lset</span><span class="p">))))))))</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>            <span class="p">((</span><span class="nb">null? </span><span class="nv">lset</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>            <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">A</span> <span class="nv">lset</span><span class="p">))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Tests of intersectall-letcc</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">intersectall-letcc</span> <span class="o">&#39;</span><span class="p">((</span><span class="nf">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">a</span><span class="p">)))</span>                   <span class="c1">; &#39;(a)</span>
</span><span class='line'><span class="p">(</span><span class="nf">intersectall-letcc</span> <span class="o">&#39;</span><span class="p">((</span><span class="nf">a</span><span class="p">)</span> <span class="p">()</span> <span class="p">(</span><span class="nf">a</span><span class="p">)))</span>                    <span class="c1">; &#39;()</span>
</span><span class='line'><span class="p">(</span><span class="nf">intersectall-letcc</span> <span class="o">&#39;</span><span class="p">())</span>                              <span class="c1">; &#39;()</span>
</span><span class='line'><span class="p">(</span><span class="nf">intersectall-letcc</span> <span class="o">&#39;</span><span class="p">((</span><span class="nf">a</span> <span class="nv">b</span> <span class="nv">c</span> <span class="nv">d</span><span class="p">)</span> <span class="p">(</span><span class="nf">b</span> <span class="nv">c</span> <span class="nv">d</span> <span class="nv">e</span><span class="p">)</span> <span class="p">(</span><span class="nf">c</span> <span class="nv">d</span> <span class="nv">e</span> <span class="nv">f</span><span class="p">)))</span> <span class="c1">; &#39;(c d)</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">; intersectall that returns abruptly and promptly</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">intersectall-ap</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lset</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">call-with-current-continuation</span>
</span><span class='line'>      <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">hop</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>          <span class="p">((</span><span class="nf">A</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lset</span><span class="p">)</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>                  <span class="c1">;;;hop one</span>
</span><span class='line'>                  <span class="p">((</span><span class="nb">null? </span><span class="p">(</span><span class="nb">car </span><span class="nv">lset</span><span class="p">))</span> <span class="p">(</span><span class="nf">hop</span> <span class="o">&#39;</span><span class="p">()))</span>
</span><span class='line'>                  <span class="p">((</span><span class="nb">null? </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">lset</span><span class="p">))</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lset</span><span class="p">))</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>                    <span class="p">(</span><span class="nf">I</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lset</span><span class="p">)</span>
</span><span class='line'>                       <span class="p">(</span><span class="nf">A</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lset</span><span class="p">)))))))</span>
</span><span class='line'>           <span class="p">(</span><span class="nf">I</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">s1</span> <span class="nv">s2</span><span class="p">)</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>                  <span class="p">((</span><span class="nf">J</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">s1</span><span class="p">)</span>
</span><span class='line'>                        <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>                          <span class="p">((</span><span class="nb">null? </span><span class="nv">s1</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>                          <span class="p">((</span><span class="nf">member?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">s1</span><span class="p">)</span> <span class="nv">s2</span><span class="p">)</span>
</span><span class='line'>                           <span class="c1">;;;get the one you need</span>
</span><span class='line'>                           <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">s1</span><span class="p">)</span> <span class="p">(</span><span class="nf">J</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">s1</span><span class="p">))))</span>
</span><span class='line'>                          <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>                            <span class="p">(</span><span class="nf">J</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">s1</span><span class="p">)))))))</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>                    <span class="c1">;;;hop two</span>
</span><span class='line'>                    <span class="p">((</span><span class="nb">null? </span><span class="nv">s2</span><span class="p">)</span> <span class="p">(</span><span class="nf">hop</span> <span class="o">&#39;</span><span class="p">()))</span>
</span><span class='line'>                    <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">J</span> <span class="nv">s1</span><span class="p">)))))))</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>            <span class="p">((</span><span class="nb">null? </span><span class="nv">lset</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>            <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">A</span> <span class="nv">lset</span><span class="p">))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Tests of intersectall-ap</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">intersectall-ap</span> <span class="o">&#39;</span><span class="p">((</span><span class="nf">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">a</span><span class="p">)))</span>                   <span class="c1">; &#39;(a)</span>
</span><span class='line'><span class="p">(</span><span class="nf">intersectall-ap</span> <span class="o">&#39;</span><span class="p">((</span><span class="nf">a</span><span class="p">)</span> <span class="p">()</span> <span class="p">(</span><span class="nf">a</span><span class="p">)))</span>                    <span class="c1">; &#39;()</span>
</span><span class='line'><span class="p">(</span><span class="nf">intersectall-ap</span> <span class="o">&#39;</span><span class="p">())</span>                              <span class="c1">; &#39;()</span>
</span><span class='line'><span class="p">(</span><span class="nf">intersectall-ap</span> <span class="o">&#39;</span><span class="p">((</span><span class="nf">a</span> <span class="nv">b</span> <span class="nv">c</span> <span class="nv">d</span><span class="p">)</span> <span class="p">(</span><span class="nf">b</span> <span class="nv">c</span> <span class="nv">d</span> <span class="nv">e</span><span class="p">)</span> <span class="p">(</span><span class="nf">c</span> <span class="nv">d</span> <span class="nv">e</span> <span class="nv">f</span><span class="p">)))</span> <span class="c1">; &#39;(c d)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; rember function via letrec</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">; Chapter 14 of The Seasoned Schemer:</span>
</span><span class='line'><span class="c1">; Let There Be Names</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">; Code examples assemled by Peteris Krumins (peter@catonmat.net).</span>
</span><span class='line'><span class="c1">; His blog is at http://www.catonmat.net  --  good coders code, great reuse.</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">; Get yourself this wonderful book at Amazon: http://bit.ly/8cyjgw</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; atom? primitive</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">atom?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">pair? </span><span class="nv">x</span><span class="p">))</span> <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">null? </span><span class="nv">x</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; add1 primitive</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">add1</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">+ </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The leftmost function finds the leftmost atom in a non-empty list of</span>
</span><span class='line'><span class="c1">; s-expressions that does not contain the empty list.</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">leftmost</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">leftmost</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Example of leftmost</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">leftmost</span> <span class="o">&#39;</span><span class="p">(((</span><span class="nf">a</span><span class="p">)</span> <span class="nv">b</span><span class="p">)</span> <span class="p">(</span><span class="nf">c</span> <span class="nv">d</span><span class="p">)))</span>         <span class="c1">; &#39;a</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Example of not-applicable leftmost</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">; (leftmost &#39;((() a) ()))           ; not applicable because leftmost item is an empty list</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Let&#39;s fix this.</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">leftmost-fixed</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>          <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nf">leftmost-fixed</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)))</span>
</span><span class='line'>           <span class="p">(</span><span class="nf">leftmost-fixed</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)))</span>
</span><span class='line'>          <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">leftmost-fixed</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Examples of leftmost-fixed</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">leftmost-fixed</span> <span class="o">&#39;</span><span class="p">(((</span><span class="nf">x</span><span class="p">)</span> <span class="nv">b</span><span class="p">)</span> <span class="p">(</span><span class="nf">c</span> <span class="nv">d</span><span class="p">)))</span>   <span class="c1">; &#39;x</span>
</span><span class='line'><span class="p">(</span><span class="nf">leftmost-fixed</span> <span class="o">&#39;</span><span class="p">(((</span><span class="nf">x</span><span class="p">)</span> <span class="p">())</span> <span class="p">()</span> <span class="p">(</span><span class="nf">e</span><span class="p">)))</span> <span class="c1">; &#39;x</span>
</span><span class='line'><span class="p">(</span><span class="nf">leftmost-fixed</span> <span class="o">&#39;</span><span class="p">(((()</span> <span class="nv">x</span><span class="p">)</span> <span class="p">())))</span>     <span class="c1">; &#39;x</span>
</span><span class='line'><span class="p">(</span><span class="nf">leftmost-fixed</span> <span class="o">&#39;</span><span class="p">(((())</span> <span class="p">())))</span>       <span class="c1">; &#39;()</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">leftmost-let</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">a</span> <span class="p">(</span><span class="nf">leftmost-let</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))))</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>            <span class="p">((</span><span class="nf">atom?</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">leftmost-let</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Tests of leftmost-let</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">leftmost-let</span> <span class="o">&#39;</span><span class="p">(((</span><span class="nf">y</span><span class="p">)</span> <span class="nv">b</span><span class="p">)</span> <span class="p">(</span><span class="nf">c</span> <span class="nv">d</span><span class="p">)))</span>   <span class="c1">; &#39;y</span>
</span><span class='line'><span class="p">(</span><span class="nf">leftmost-let</span> <span class="o">&#39;</span><span class="p">(((</span><span class="nf">y</span><span class="p">)</span> <span class="p">())</span> <span class="p">()</span> <span class="p">(</span><span class="nf">e</span><span class="p">)))</span> <span class="c1">; &#39;y</span>
</span><span class='line'><span class="p">(</span><span class="nf">leftmost-let</span> <span class="o">&#39;</span><span class="p">(((()</span> <span class="nv">y</span><span class="p">)</span> <span class="p">())))</span>     <span class="c1">; &#39;y</span>
</span><span class='line'><span class="p">(</span><span class="nf">leftmost-let</span> <span class="o">&#39;</span><span class="p">(((())</span> <span class="p">())))</span>       <span class="c1">; &#39;()</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The rember1* function removes the leftmost occurrence of a in l</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">rember1*</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>         <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>           <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">rember1*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>          <span class="p">((</span><span class="nb">equal? </span><span class="p">(</span><span class="nf">rember1*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span> <span class="c1">; if the list with &#39;a&#39; removed doesn&#39;t change</span>
</span><span class='line'>           <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">rember1*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))</span>  <span class="c1">; then recurse</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>            <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">rember1*</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))))</span> <span class="c1">; otherwise remove &#39;a&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Examples of rember1*</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">rember1*</span>
</span><span class='line'>  <span class="ss">&#39;salad</span>
</span><span class='line'>  <span class="o">&#39;</span><span class="p">((</span><span class="nf">Swedish</span> <span class="nv">rye</span><span class="p">)</span> <span class="p">(</span><span class="nf">French</span> <span class="p">(</span><span class="nf">mustard</span> <span class="nv">salad</span> <span class="nv">turkey</span><span class="p">))</span> <span class="nv">salad</span><span class="p">))</span>
</span><span class='line'><span class="c1">; ==&gt; &#39;((Swedish rye) (French (mustard turkey)) salad)</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">rember1*</span>
</span><span class='line'>  <span class="ss">&#39;meat</span>
</span><span class='line'>  <span class="o">&#39;</span><span class="p">((</span><span class="nf">pasta</span> <span class="nv">meat</span><span class="p">)</span> <span class="nv">pasta</span> <span class="p">(</span><span class="nf">noodles</span> <span class="nv">meat</span> <span class="nv">sauce</span><span class="p">)</span> <span class="nv">meat</span> <span class="nv">tomatoes</span><span class="p">))</span>
</span><span class='line'><span class="c1">; ==&gt; &#39;((pasta) pasta (noodles meat sauce) meat tomatoes)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; rember1* rewritten using the 12th commandment</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">rember1*-letrec</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">R</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>              <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>              <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>               <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>                 <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>                 <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>                   <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">R</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>                  <span class="p">((</span><span class="nb">equal? </span><span class="p">(</span><span class="nf">R</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span> <span class="c1">; if the list with &#39;a&#39; removed doesn&#39;t change</span>
</span><span class='line'>                   <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">R</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))</span>  <span class="c1">; then recurse</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>                    <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">R</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))))</span> <span class="c1">; otherwise remove &#39;a&#39;</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">R</span> <span class="nv">l</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Tests of rember1*-letrec</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">rember1*-letrec</span>
</span><span class='line'>  <span class="ss">&#39;salad</span>
</span><span class='line'>  <span class="o">&#39;</span><span class="p">((</span><span class="nf">Swedish</span> <span class="nv">rye</span><span class="p">)</span> <span class="p">(</span><span class="nf">French</span> <span class="p">(</span><span class="nf">mustard</span> <span class="nv">salad</span> <span class="nv">turkey</span><span class="p">))</span> <span class="nv">salad</span><span class="p">))</span>
</span><span class='line'><span class="c1">; ==&gt; &#39;((Swedish rye) (French (mustard turkey)) salad)</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">rember1*-letrec</span>
</span><span class='line'>  <span class="ss">&#39;meat</span>
</span><span class='line'>  <span class="o">&#39;</span><span class="p">((</span><span class="nf">pasta</span> <span class="nv">meat</span><span class="p">)</span> <span class="nv">pasta</span> <span class="p">(</span><span class="nf">noodles</span> <span class="nv">meat</span> <span class="nv">sauce</span><span class="p">)</span> <span class="nv">meat</span> <span class="nv">tomatoes</span><span class="p">))</span>
</span><span class='line'><span class="c1">; ==&gt; &#39;((pasta) pasta (noodles meat sauce) meat tomatoes)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; rember* rewritten using the 12th commandment and let</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">rember1*-letrec-let</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">R</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>              <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>              <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>               <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>                 <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>                 <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>                   <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">R</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>                <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">av</span> <span class="p">(</span><span class="nf">R</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))))</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>                    <span class="p">((</span><span class="nb">equal? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">av</span><span class="p">)</span>         <span class="c1">; if the list with &#39;a&#39; removed didn&#39;t change</span>
</span><span class='line'>                     <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">R</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))</span> <span class="c1">; then recurse</span>
</span><span class='line'>                    <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>                      <span class="p">(</span><span class="nb">cons </span><span class="nv">av</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))))))</span>  <span class="c1">; otherwise remove &#39;a&#39;</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">R</span> <span class="nv">l</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Tests of rember1*-letrec-let</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">rember1*-letrec-let</span>
</span><span class='line'>  <span class="ss">&#39;salad</span>
</span><span class='line'>  <span class="o">&#39;</span><span class="p">((</span><span class="nf">Swedish</span> <span class="nv">rye</span><span class="p">)</span> <span class="p">(</span><span class="nf">French</span> <span class="p">(</span><span class="nf">mustard</span> <span class="nv">salad</span> <span class="nv">turkey</span><span class="p">))</span> <span class="nv">salad</span><span class="p">))</span>
</span><span class='line'><span class="c1">; ==&gt; &#39;((Swedish rye) (French (mustard turkey)) salad)</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">rember1*-letrec-let</span>
</span><span class='line'>  <span class="ss">&#39;meat</span>
</span><span class='line'>  <span class="o">&#39;</span><span class="p">((</span><span class="nf">pasta</span> <span class="nv">meat</span><span class="p">)</span> <span class="nv">pasta</span> <span class="p">(</span><span class="nf">noodles</span> <span class="nv">meat</span> <span class="nv">sauce</span><span class="p">)</span> <span class="nv">meat</span> <span class="nv">tomatoes</span><span class="p">))</span>
</span><span class='line'><span class="c1">; ==&gt; &#39;((pasta) pasta (noodles meat sauce) meat tomatoes)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;                                                                            ;</span>
</span><span class='line'><span class="c1">; The fifteenth commandment (preliminary version)                            ;</span>
</span><span class='line'><span class="c1">;                                                                            ;</span>
</span><span class='line'><span class="c1">; Use (let ...) to name the values of repeated expressions.                  ;</span>
</span><span class='line'><span class="c1">;                                                                            ;</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The depth* function finds the max depth of an s-expression</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">depth*</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nf">depth*</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>          <span class="p">((</span><span class="nb">&gt; </span><span class="p">(</span><span class="nf">depth*</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">depth*</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))))</span>
</span><span class='line'>           <span class="p">(</span><span class="nf">depth*</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">depth*</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Examples of depth*</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">depth*</span> <span class="o">&#39;</span><span class="p">((</span><span class="nf">pickled</span><span class="p">)</span> <span class="nv">peppers</span> <span class="p">(</span><span class="nf">peppers</span> <span class="nv">pickled</span><span class="p">)))</span>                          <span class="c1">; 2</span>
</span><span class='line'><span class="p">(</span><span class="nf">depth*</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">margarine</span> <span class="p">((</span><span class="nf">bitter</span> <span class="nv">butter</span><span class="p">)</span> <span class="p">(</span><span class="nf">makes</span><span class="p">)</span> <span class="p">(</span><span class="nf">batter</span> <span class="p">(</span><span class="nf">bitter</span><span class="p">)))</span> <span class="nv">butter</span><span class="p">))</span> <span class="c1">; 4</span>
</span><span class='line'><span class="p">(</span><span class="nf">depth*</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">c</span> <span class="p">(</span><span class="nf">b</span> <span class="p">(</span><span class="nf">a</span> <span class="nv">b</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">a</span><span class="p">))</span>                                              <span class="c1">; 3</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; depth* rewritten using let</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">depth*-let</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nf">depth*-let</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span>
</span><span class='line'>        <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">a</span> <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">depth*-let</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))))</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">d</span> <span class="p">(</span><span class="nf">depth*-let</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>            <span class="p">((</span><span class="nb">&gt; </span><span class="nv">d</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">d</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="k">else </span><span class="nv">a</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Tests of depth*-let</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">depth*-let</span> <span class="o">&#39;</span><span class="p">((</span><span class="nf">pickled</span><span class="p">)</span> <span class="nv">peppers</span> <span class="p">(</span><span class="nf">peppers</span> <span class="nv">pickled</span><span class="p">)))</span>                          <span class="c1">; 2</span>
</span><span class='line'><span class="p">(</span><span class="nf">depth*-let</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">margarine</span> <span class="p">((</span><span class="nf">bitter</span> <span class="nv">butter</span><span class="p">)</span> <span class="p">(</span><span class="nf">makes</span><span class="p">)</span> <span class="p">(</span><span class="nf">batter</span> <span class="p">(</span><span class="nf">bitter</span><span class="p">)))</span> <span class="nv">butter</span><span class="p">))</span> <span class="c1">; 4</span>
</span><span class='line'><span class="p">(</span><span class="nf">depth*-let</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">c</span> <span class="p">(</span><span class="nf">b</span> <span class="p">(</span><span class="nf">a</span> <span class="nv">b</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">a</span><span class="p">))</span>                                              <span class="c1">; 3</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Another version of depth*</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">depth*-let-2</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">d</span> <span class="p">(</span><span class="nf">depth*-let-2</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>            <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span> <span class="nv">d</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>              <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">a</span> <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">depth*-let-2</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)))))</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>                  <span class="p">((</span><span class="nb">&gt; </span><span class="nv">d</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">d</span><span class="p">)</span>
</span><span class='line'>                  <span class="p">(</span><span class="k">else </span><span class="nv">a</span><span class="p">))))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Tests of depth*-let</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">depth*-let-2</span> <span class="o">&#39;</span><span class="p">((</span><span class="nf">pickled</span><span class="p">)</span> <span class="nv">peppers</span> <span class="p">(</span><span class="nf">peppers</span> <span class="nv">pickled</span><span class="p">)))</span>                          <span class="c1">; 2</span>
</span><span class='line'><span class="p">(</span><span class="nf">depth*-let-2</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">margarine</span> <span class="p">((</span><span class="nf">bitter</span> <span class="nv">butter</span><span class="p">)</span> <span class="p">(</span><span class="nf">makes</span><span class="p">)</span> <span class="p">(</span><span class="nf">batter</span> <span class="p">(</span><span class="nf">bitter</span><span class="p">)))</span> <span class="nv">butter</span><span class="p">))</span> <span class="c1">; 4</span>
</span><span class='line'><span class="p">(</span><span class="nf">depth*-let-2</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">c</span> <span class="p">(</span><span class="nf">b</span> <span class="p">(</span><span class="nf">a</span> <span class="nv">b</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">a</span><span class="p">))</span>                                              <span class="c1">; 3</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;                                                                            ;</span>
</span><span class='line'><span class="c1">; The fifteenth commandment (revised version)                                ;</span>
</span><span class='line'><span class="c1">;                                                                            ;</span>
</span><span class='line'><span class="c1">; Use (let ...) to name the values of repeated expressions in a function     ;</span>
</span><span class='line'><span class="c1">; definition if they may be evaluated twice for one and the same use of the  ;</span>
</span><span class='line'><span class="c1">; function.                                                                  ;</span>
</span><span class='line'><span class="c1">;                                                                            ;</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; depth* via if</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">depth*-if</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">depth*-if</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">a</span> <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">depth*</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))))</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">d</span> <span class="p">(</span><span class="nf">depth*</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))</span>
</span><span class='line'>          <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">&gt; </span><span class="nv">d</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">d</span> <span class="nv">a</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Tests of depth*-if</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">depth*-if</span> <span class="o">&#39;</span><span class="p">((</span><span class="nf">pickled</span><span class="p">)</span> <span class="nv">peppers</span> <span class="p">(</span><span class="nf">peppers</span> <span class="nv">pickled</span><span class="p">)))</span>                          <span class="c1">; 2</span>
</span><span class='line'><span class="p">(</span><span class="nf">depth*-if</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">margarine</span> <span class="p">((</span><span class="nf">bitter</span> <span class="nv">butter</span><span class="p">)</span> <span class="p">(</span><span class="nf">makes</span><span class="p">)</span> <span class="p">(</span><span class="nf">batter</span> <span class="p">(</span><span class="nf">bitter</span><span class="p">)))</span> <span class="nv">butter</span><span class="p">))</span> <span class="c1">; 4</span>
</span><span class='line'><span class="p">(</span><span class="nf">depth*-if</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">c</span> <span class="p">(</span><span class="nf">b</span> <span class="p">(</span><span class="nf">a</span> <span class="nv">b</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">a</span><span class="p">))</span>                                              <span class="c1">; 3</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; depth* via max</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">depth*-max</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">depth*-max</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">max</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">depth*-max</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)))</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">depth*-max</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Tests of depth*-max</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">depth*-max</span> <span class="o">&#39;</span><span class="p">((</span><span class="nf">pickled</span><span class="p">)</span> <span class="nv">peppers</span> <span class="p">(</span><span class="nf">peppers</span> <span class="nv">pickled</span><span class="p">)))</span>                          <span class="c1">; 2</span>
</span><span class='line'><span class="p">(</span><span class="nf">depth*-max</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">margarine</span> <span class="p">((</span><span class="nf">bitter</span> <span class="nv">butter</span><span class="p">)</span> <span class="p">(</span><span class="nf">makes</span><span class="p">)</span> <span class="p">(</span><span class="nf">batter</span> <span class="p">(</span><span class="nf">bitter</span><span class="p">)))</span> <span class="nv">butter</span><span class="p">))</span> <span class="c1">; 4</span>
</span><span class='line'><span class="p">(</span><span class="nf">depth*-max</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">c</span> <span class="p">(</span><span class="nf">b</span> <span class="p">(</span><span class="nf">a</span> <span class="nv">b</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="nv">a</span><span class="p">))</span>                                              <span class="c1">; 3</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Not interested in scramble problem, skipping it.</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; leftmost via letcc</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">leftmost-letcc</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">call-with-current-continuation</span>
</span><span class='line'>      <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">skip</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">lm</span> <span class="nv">l</span> <span class="nv">skip</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; lm is leftmost-letcc&#39;s helper function</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">lm</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span> <span class="nv">out</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nf">out</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="k">let </span><span class="p">()</span> <span class="c1">; can also use &#39;begin&#39;</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">lm</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">out</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">lm</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span> <span class="nv">out</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">leftmost-letcc</span> <span class="o">&#39;</span><span class="p">(((</span><span class="nf">x</span><span class="p">)</span> <span class="nv">b</span><span class="p">)</span> <span class="p">(</span><span class="nf">c</span> <span class="nv">d</span><span class="p">)))</span>   <span class="c1">; &#39;x</span>
</span><span class='line'><span class="p">(</span><span class="nf">leftmost-letcc</span> <span class="o">&#39;</span><span class="p">(((</span><span class="nf">x</span><span class="p">)</span> <span class="p">())</span> <span class="p">()</span> <span class="p">(</span><span class="nf">e</span><span class="p">)))</span> <span class="c1">; &#39;x</span>
</span><span class='line'><span class="p">(</span><span class="nf">leftmost-letcc</span> <span class="o">&#39;</span><span class="p">(((()</span> <span class="nv">x</span><span class="p">)</span> <span class="p">())))</span>     <span class="c1">; &#39;x</span>
</span><span class='line'><span class="p">(</span><span class="nf">leftmost-letcc</span> <span class="o">&#39;</span><span class="p">(((())</span> <span class="p">())))</span>       <span class="c1">; &#39;()</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; letfmost following 13th and 14th commandments</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">leftmost-1314</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>    <span class="p">((</span><span class="nf">lm</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span> <span class="nv">out</span><span class="p">)</span>
</span><span class='line'>           <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>             <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>             <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nf">out</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)))</span>
</span><span class='line'>             <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>               <span class="p">(</span><span class="nf">begin</span>
</span><span class='line'>                 <span class="p">(</span><span class="nf">lm</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">out</span><span class="p">)</span>
</span><span class='line'>                 <span class="p">(</span><span class="nf">lm</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span> <span class="nv">out</span><span class="p">)))))))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">call-with-current-continuation</span>
</span><span class='line'>        <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">skip</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">lm</span> <span class="nv">l</span> <span class="nv">skip</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">leftmost-1314</span> <span class="o">&#39;</span><span class="p">(((</span><span class="nf">x</span><span class="p">)</span> <span class="nv">b</span><span class="p">)</span> <span class="p">(</span><span class="nf">c</span> <span class="nv">d</span><span class="p">)))</span>   <span class="c1">; &#39;x</span>
</span><span class='line'><span class="p">(</span><span class="nf">leftmost-1314</span> <span class="o">&#39;</span><span class="p">(((</span><span class="nf">x</span><span class="p">)</span> <span class="p">())</span> <span class="p">()</span> <span class="p">(</span><span class="nf">e</span><span class="p">)))</span> <span class="c1">; &#39;x</span>
</span><span class='line'><span class="p">(</span><span class="nf">leftmost-1314</span> <span class="o">&#39;</span><span class="p">(((()</span> <span class="nv">x</span><span class="p">)</span> <span class="p">())))</span>     <span class="c1">; &#39;x</span>
</span><span class='line'><span class="p">(</span><span class="nf">leftmost-1314</span> <span class="o">&#39;</span><span class="p">(((())</span> <span class="p">())))</span>       <span class="c1">; &#39;()</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; another way to follow 13th and 14th commandments</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">leftmost-13142</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>        <span class="p">((</span><span class="nf">lm</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span> <span class="nv">out</span><span class="p">)</span>
</span><span class='line'>               <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>                 <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>                 <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nf">out</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)))</span>
</span><span class='line'>                 <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>                   <span class="p">(</span><span class="nf">begin</span>
</span><span class='line'>                     <span class="p">(</span><span class="nf">lm</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">out</span><span class="p">)</span>
</span><span class='line'>                     <span class="p">(</span><span class="nf">lm</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span> <span class="nv">out</span><span class="p">)))))))</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">call-with-current-continuation</span>
</span><span class='line'>          <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">skip</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">lm</span> <span class="nv">l</span> <span class="nv">skip</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">leftmost-13142</span> <span class="o">&#39;</span><span class="p">(((</span><span class="nf">x</span><span class="p">)</span> <span class="nv">b</span><span class="p">)</span> <span class="p">(</span><span class="nf">c</span> <span class="nv">d</span><span class="p">)))</span>   <span class="c1">; &#39;x</span>
</span><span class='line'><span class="p">(</span><span class="nf">leftmost-13142</span> <span class="o">&#39;</span><span class="p">(((</span><span class="nf">x</span><span class="p">)</span> <span class="p">())</span> <span class="p">()</span> <span class="p">(</span><span class="nf">e</span><span class="p">)))</span> <span class="c1">; &#39;x</span>
</span><span class='line'><span class="p">(</span><span class="nf">leftmost-13142</span> <span class="o">&#39;</span><span class="p">(((()</span> <span class="nv">x</span><span class="p">)</span> <span class="p">())))</span>     <span class="c1">; &#39;x</span>
</span><span class='line'><span class="p">(</span><span class="nf">leftmost-13142</span> <span class="o">&#39;</span><span class="p">(((())</span> <span class="p">())))</span>       <span class="c1">; &#39;()</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; yet another way</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">leftmost-131422</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">call-with-current-continuation</span>
</span><span class='line'>      <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">skip</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>          <span class="p">((</span><span class="nf">lm</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>                 <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>                   <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>                   <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span> <span class="p">(</span><span class="nf">skip</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)))</span>
</span><span class='line'>                   <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>                     <span class="p">(</span><span class="nf">begin</span>
</span><span class='line'>                       <span class="p">(</span><span class="nf">lm</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>                       <span class="p">(</span><span class="nf">lm</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))))</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">lm</span> <span class="nv">l</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">leftmost-131422</span> <span class="o">&#39;</span><span class="p">(((</span><span class="nf">x</span><span class="p">)</span> <span class="nv">b</span><span class="p">)</span> <span class="p">(</span><span class="nf">c</span> <span class="nv">d</span><span class="p">)))</span>   <span class="c1">; &#39;x</span>
</span><span class='line'><span class="p">(</span><span class="nf">leftmost-131422</span> <span class="o">&#39;</span><span class="p">(((</span><span class="nf">x</span><span class="p">)</span> <span class="p">())</span> <span class="p">()</span> <span class="p">(</span><span class="nf">e</span><span class="p">)))</span> <span class="c1">; &#39;x</span>
</span><span class='line'><span class="p">(</span><span class="nf">leftmost-131422</span> <span class="o">&#39;</span><span class="p">(((()</span> <span class="nv">x</span><span class="p">)</span> <span class="p">())))</span>     <span class="c1">; &#39;x</span>
</span><span class='line'><span class="p">(</span><span class="nf">leftmost-131422</span> <span class="o">&#39;</span><span class="p">(((())</span> <span class="p">())))</span>       <span class="c1">; &#39;()</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; rember1* via letcc</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">rember1*-letcc</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">rm</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">l</span> <span class="nv">oh</span><span class="p">)</span>
</span><span class='line'>             <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>               <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">oh</span> <span class="ss">&#39;no</span><span class="p">))</span>
</span><span class='line'>               <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>                <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span>
</span><span class='line'>                  <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span>
</span><span class='line'>                  <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">rm</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span> <span class="nv">oh</span><span class="p">))))</span>
</span><span class='line'>               <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>                 <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">new-car</span>
</span><span class='line'>                         <span class="p">(</span><span class="nf">call-with-current-continuation</span>
</span><span class='line'>                           <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">oh</span><span class="p">)</span>
</span><span class='line'>                             <span class="p">(</span><span class="nf">rm</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">oh</span><span class="p">)))))</span>
</span><span class='line'>                   <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">atom?</span> <span class="nv">new-car</span><span class="p">)</span>
</span><span class='line'>                     <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">rm</span> <span class="nv">a</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span> <span class="nv">oh</span><span class="p">))</span>
</span><span class='line'>                     <span class="p">(</span><span class="nb">cons </span><span class="nv">new-car</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">new-l</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">call-with-current-continuation</span>
</span><span class='line'>                <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">oh</span><span class="p">)</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">rm</span> <span class="nv">a</span> <span class="nv">l</span> <span class="nv">oh</span><span class="p">)))))</span>
</span><span class='line'>        <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">atom?</span> <span class="nv">new-l</span><span class="p">)</span>
</span><span class='line'>          <span class="nv">l</span>
</span><span class='line'>          <span class="nv">new-l</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Tests of rember1*-letcc</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">rember1*-letcc</span>
</span><span class='line'>  <span class="ss">&#39;salad</span>
</span><span class='line'>  <span class="o">&#39;</span><span class="p">((</span><span class="nf">Swedish</span> <span class="nv">rye</span><span class="p">)</span> <span class="p">(</span><span class="nf">French</span> <span class="p">(</span><span class="nf">mustard</span> <span class="nv">salad</span> <span class="nv">turkey</span><span class="p">))</span> <span class="nv">salad</span><span class="p">))</span>
</span><span class='line'><span class="c1">; ==&gt; &#39;((Swedish rye) (French (mustard turkey)) salad)</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">rember1*-letcc</span>
</span><span class='line'>  <span class="ss">&#39;meat</span>
</span><span class='line'>  <span class="o">&#39;</span><span class="p">((</span><span class="nf">pasta</span> <span class="nv">meat</span><span class="p">)</span> <span class="nv">pasta</span> <span class="p">(</span><span class="nf">noodles</span> <span class="nv">meat</span> <span class="nv">sauce</span><span class="p">)</span> <span class="nv">meat</span> <span class="nv">tomatoes</span><span class="p">))</span>
</span><span class='line'><span class="c1">; ==&gt; &#39;((pasta) pasta (noodles meat sauce) meat tomatoes)</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">rember1*-letcc</span>
</span><span class='line'>  <span class="ss">&#39;a</span>
</span><span class='line'>  <span class="o">&#39;</span><span class="p">((</span><span class="nf">foo</span> <span class="nv">bar</span><span class="p">)</span> <span class="nv">baz</span><span class="p">))</span>
</span><span class='line'><span class="c1">; ==&gt; &#39;((foo bar) baz)</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">; Chapter 16 of The Seasoned Schemer:</span>
</span><span class='line'><span class="c1">; Ready, Set, Bang!</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">; Code examples assemled by Peteris Krumins (peter@catonmat.net).</span>
</span><span class='line'><span class="c1">; His blog is at http://www.catonmat.net  --  good coders code, great reuse.</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">; Get yourself this wonderful book at Amazon: http://bit.ly/8cyjgw</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; sub1 primitive</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">sub1</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; add1 primitive</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">add1</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">+ </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; atom? primitive</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">atom?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">pair? </span><span class="nv">x</span><span class="p">))</span> <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">null? </span><span class="nv">x</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; member? helper function</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">member?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">yes?</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>               <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>                 <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>                 <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">a</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>                 <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">yes?</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">yes?</span> <span class="nv">l</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">; Code examples start here</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">sweet-tooth</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">food</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">cons </span><span class="nv">food</span> <span class="p">(</span><span class="nb">cons </span><span class="ss">&#39;cake</span> <span class="o">&#39;</span><span class="p">()))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">last</span> <span class="ss">&#39;angelfood</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">sweet-tooth</span> <span class="ss">&#39;fruit</span><span class="p">)</span>        <span class="c1">; &#39;(fruit cake)</span>
</span><span class='line'><span class="nv">last</span>                        <span class="c1">; &#39;angelfood</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The sweet-toothL function saves the last food</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">sweet-toothL</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">food</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">set! </span><span class="nv">last</span> <span class="nv">food</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">cons </span><span class="nv">food</span> <span class="p">(</span><span class="nb">cons </span><span class="ss">&#39;cake</span> <span class="o">&#39;</span><span class="p">()))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">sweet-toothL</span> <span class="ss">&#39;chocolate</span><span class="p">)</span>   <span class="c1">; &#39;(chocolate cake)</span>
</span><span class='line'><span class="nv">last</span>                        <span class="c1">; &#39;chocolate</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">sweet-toothL</span> <span class="ss">&#39;fruit</span><span class="p">)</span>       <span class="c1">; &#39;(fruit cake)</span>
</span><span class='line'><span class="nv">last</span>                        <span class="c1">; &#39;fruit</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">ingredients</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The sweet-toothR function builds a list of foods</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">sweet-toothR</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">food</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">set! </span><span class="nv">ingredients</span>
</span><span class='line'>      <span class="p">(</span><span class="nb">cons </span><span class="nv">food</span> <span class="nv">ingredients</span><span class="p">))</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">cons </span><span class="nv">food</span> <span class="p">(</span><span class="nb">cons </span><span class="ss">&#39;cake</span> <span class="o">&#39;</span><span class="p">()))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">sweet-toothR</span> <span class="ss">&#39;chocolate</span><span class="p">)</span>   <span class="c1">; &#39;(chocolate cake)</span>
</span><span class='line'><span class="nv">ingredients</span>                 <span class="c1">; &#39;(chocolate)</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">sweet-toothR</span> <span class="ss">&#39;fruit</span><span class="p">)</span>       <span class="c1">; &#39;(fruit cake)</span>
</span><span class='line'><span class="nv">ingredients</span>                 <span class="c1">; &#39;(fruit chocolate)</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">sweet-toothR</span> <span class="ss">&#39;cheese</span><span class="p">)</span>      <span class="c1">; &#39;(cheese cake)</span>
</span><span class='line'><span class="nv">ingredients</span>                 <span class="c1">; &#39;(cheese fruit chocolate)</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">sweet-toothR</span> <span class="ss">&#39;carrot</span><span class="p">)</span>      <span class="c1">; &#39;(carrot cake)</span>
</span><span class='line'><span class="nv">ingredients</span>                 <span class="c1">; &#39;(carrot cheese fruit chocolate)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The deep function wraps pizza in n parenthesis</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">deep</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">m</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">zero? </span><span class="nv">m</span><span class="p">)</span> <span class="ss">&#39;pizza</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">deep</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">m</span><span class="p">))</span> <span class="o">&#39;</span><span class="p">())))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Example of deep</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">deep</span> <span class="mi">3</span><span class="p">)</span>                    <span class="c1">; &#39;(((pizza)))</span>
</span><span class='line'><span class="p">(</span><span class="nf">deep</span> <span class="mi">0</span><span class="p">)</span>                    <span class="c1">; &#39;pizza</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The deepR1 function remembers the numbers deep has seen so far</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">Ns1</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">deepR1</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">set! </span><span class="nv">Ns1</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">n</span> <span class="nv">Ns1</span><span class="p">))</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">deep</span> <span class="nv">n</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Examples of deepR1</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">deepR1</span> <span class="mi">3</span><span class="p">)</span>                  <span class="c1">; &#39;(((pizza)))</span>
</span><span class='line'><span class="nv">Ns1</span>                         <span class="c1">; (3)</span>
</span><span class='line'><span class="p">(</span><span class="nf">deepR1</span> <span class="mi">0</span><span class="p">)</span>                  <span class="c1">; &#39;pizza</span>
</span><span class='line'><span class="nv">Ns1</span>                         <span class="c1">; (0 3)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The deepR function remembers the numbers and the results</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">Ns</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">Rs</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">deepR</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">result</span> <span class="p">(</span><span class="nf">deep</span> <span class="nv">n</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">set! </span><span class="nv">Ns</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">n</span> <span class="nv">Ns</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">set! </span><span class="nv">Rs</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">result</span> <span class="nv">Rs</span><span class="p">))</span>
</span><span class='line'>      <span class="nv">result</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Examples of deepR</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">deepR</span> <span class="mi">3</span><span class="p">)</span>                   <span class="c1">; &#39;(((pizza)))</span>
</span><span class='line'><span class="nv">Ns</span>                          <span class="c1">; &#39;(3)</span>
</span><span class='line'><span class="nv">Rs</span>                          <span class="c1">; &#39;((((pizza))))</span>
</span><span class='line'><span class="p">(</span><span class="nf">deepR</span> <span class="mi">5</span><span class="p">)</span>                   <span class="c1">; &#39;(((((pizza)))))</span>
</span><span class='line'><span class="nv">Ns</span>                          <span class="c1">; &#39;(5 3)</span>
</span><span class='line'><span class="nv">Rs</span>                          <span class="c1">; &#39;((((((pizza))))) (((pizza))))</span>
</span><span class='line'><span class="p">(</span><span class="nf">deepR</span> <span class="mi">3</span><span class="p">)</span>                   <span class="c1">; &#39;(((pizza)))</span>
</span><span class='line'><span class="nv">Ns</span>                          <span class="c1">; &#39;(3 5 3)</span>
</span><span class='line'><span class="nv">Rs</span>                          <span class="c1">; &#39;((((pizza))) (((((pizza))))) (((pizza))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;                                                                            ;</span>
</span><span class='line'><span class="c1">; The nineteenth commandment                                                 ;</span>
</span><span class='line'><span class="c1">;                                                                            ;</span>
</span><span class='line'><span class="c1">; Use (set! ...) to remember valuable things between two distinct uses of a  ;</span>
</span><span class='line'><span class="c1">; function.                                                                  ;</span>
</span><span class='line'><span class="c1">;                                                                            ;</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The find function finds pizza in Rs</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">find</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">Ns</span> <span class="nv">Rs</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">A</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">ns</span> <span class="nv">rs</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>              <span class="p">((</span><span class="nb">= </span><span class="p">(</span><span class="nb">car </span><span class="nv">ns</span><span class="p">)</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">car </span><span class="nv">rs</span><span class="p">))</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">A</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">ns</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">rs</span><span class="p">)))))))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">A</span> <span class="nv">Ns</span> <span class="nv">Rs</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Examples of find</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">find</span> <span class="mi">3</span> <span class="nv">Ns</span> <span class="nv">Rs</span><span class="p">)</span>              <span class="c1">; &#39;(((pizza)))</span>
</span><span class='line'><span class="p">(</span><span class="nf">find</span> <span class="mi">5</span> <span class="nv">Ns</span> <span class="nv">Rs</span><span class="p">)</span>              <span class="c1">; &#39;(((((pizza)))))</span>
</span><span class='line'><span class="c1">;(find 7 Ns Rs)             ; not applicable at this time</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The deepM function either uses find or computes pizza (temporary version)</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">deepM-tmp</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">member?</span> <span class="nv">n</span> <span class="nv">Ns</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">find</span> <span class="nv">n</span> <span class="nv">Ns</span> <span class="nv">Rs</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">deepR</span> <span class="nv">n</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="nv">Ns</span>                          <span class="c1">; &#39;(3 5 3)</span>
</span><span class='line'><span class="nv">Rs</span>                          <span class="c1">; &#39;((((pizza))) (((((pizza))))) (((pizza))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">set! </span><span class="nv">Ns</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">Ns</span><span class="p">))</span>
</span><span class='line'><span class="p">(</span><span class="k">set! </span><span class="nv">Rs</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">Rs</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="nv">Ns</span>                          <span class="c1">; &#39;(5 3)</span>
</span><span class='line'><span class="nv">Rs</span>                          <span class="c1">; &#39;((((((pizza))))) (((pizza))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The final deepM version</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">deepM</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">member?</span> <span class="nv">n</span> <span class="nv">Ns</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">find</span> <span class="nv">n</span> <span class="nv">Ns</span> <span class="nv">Rs</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">result</span> <span class="p">(</span><span class="nf">deep</span> <span class="nv">n</span><span class="p">)))</span>
</span><span class='line'>        <span class="p">(</span><span class="k">set! </span><span class="nv">Rs</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">result</span> <span class="nv">Rs</span><span class="p">))</span>
</span><span class='line'>        <span class="p">(</span><span class="k">set! </span><span class="nv">Ns</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">n</span> <span class="nv">Ns</span><span class="p">))</span>
</span><span class='line'>        <span class="nv">result</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Examples of deepM</span>
</span><span class='line'><span class="p">(</span><span class="nf">deepM</span> <span class="mi">3</span><span class="p">)</span>                   <span class="c1">; &#39;(((pizza)))</span>
</span><span class='line'><span class="p">(</span><span class="nf">deepM</span> <span class="mi">6</span><span class="p">)</span>                   <span class="c1">; &#39;((((((pizza))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Redefining deep</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">deep</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">m</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">zero? </span><span class="nv">m</span><span class="p">)</span> <span class="ss">&#39;pizza</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">deepM</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">m</span><span class="p">))</span> <span class="o">&#39;</span><span class="p">())))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">deepM</span> <span class="mi">9</span><span class="p">)</span>                   <span class="c1">; &#39;(((((((((pizza)))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="nv">Ns</span>                          <span class="c1">; &#39;(9 8 7 6 5 3)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Redefining deepM to folow 16th commandment</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">deepM</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">Rs</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">Ns</span> <span class="o">&#39;</span><span class="p">()))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">member?</span> <span class="nv">n</span> <span class="nv">Ns</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">find</span> <span class="nv">n</span> <span class="nv">Ns</span> <span class="nv">Rs</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">result</span> <span class="p">(</span><span class="nf">deep</span> <span class="nv">n</span><span class="p">)))</span>
</span><span class='line'>          <span class="p">(</span><span class="k">set! </span><span class="nv">Rs</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">result</span> <span class="nv">Rs</span><span class="p">))</span>
</span><span class='line'>          <span class="p">(</span><span class="k">set! </span><span class="nv">Ns</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">n</span> <span class="nv">Ns</span><span class="p">))</span>
</span><span class='line'>          <span class="nv">result</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Tests of the new deepM</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">deepM</span> <span class="mi">10</span><span class="p">)</span>                  <span class="c1">; &#39;((((((((((pizza))))))))))</span>
</span><span class='line'><span class="p">(</span><span class="nf">deepM</span> <span class="mi">16</span><span class="p">)</span>                  <span class="c1">; &#39;((((((((((((((((pizza))))))))))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Better answer for find on empty lists</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">find</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">Ns</span> <span class="nv">Rs</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">A</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">ns</span> <span class="nv">rs</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>              <span class="p">((</span><span class="nb">null? </span><span class="nv">ns</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>              <span class="p">((</span><span class="nb">= </span><span class="p">(</span><span class="nb">car </span><span class="nv">ns</span><span class="p">)</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">car </span><span class="nv">rs</span><span class="p">))</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">A</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">ns</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">rs</span><span class="p">)))))))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">A</span> <span class="nv">Ns</span> <span class="nv">Rs</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; And a better deepM</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">deepM</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">Rs</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">Ns</span> <span class="o">&#39;</span><span class="p">()))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">exists</span> <span class="p">(</span><span class="nf">find</span> <span class="nv">n</span> <span class="nv">Ns</span> <span class="nv">Rs</span><span class="p">)))</span>
</span><span class='line'>        <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">atom?</span> <span class="nv">exists</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">result</span> <span class="p">(</span><span class="nf">deep</span> <span class="nv">n</span><span class="p">)))</span>
</span><span class='line'>            <span class="p">(</span><span class="k">set! </span><span class="nv">Rs</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">result</span> <span class="nv">Rs</span><span class="p">))</span>
</span><span class='line'>            <span class="p">(</span><span class="k">set! </span><span class="nv">Ns</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">n</span> <span class="nv">Ns</span><span class="p">))</span>
</span><span class='line'>            <span class="nv">result</span><span class="p">)</span>
</span><span class='line'>          <span class="nv">exists</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Example of the new deepM</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">deepM</span> <span class="mi">10</span><span class="p">)</span>                  <span class="c1">; &#39;((((((((((pizza))))))))))</span>
</span><span class='line'><span class="p">(</span><span class="nf">deepM</span> <span class="mi">16</span><span class="p">)</span>                  <span class="c1">; &#39;((((((((((((((((pizza))))))))))))))))</span>
</span><span class='line'><span class="p">(</span><span class="nf">deepM</span> <span class="mi">0</span><span class="p">)</span>                   <span class="c1">; &#39;pizza</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;                                                                            ;</span>
</span><span class='line'><span class="c1">;              Take a deep breath or a deep pizza, now.                      ;</span>
</span><span class='line'><span class="c1">;                                                                            ;</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Our good, old friend length</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">lengthz</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">lengthz</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Test length</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">lengthz</span> <span class="o">&#39;</span><span class="p">())</span>        <span class="c1">; 0</span>
</span><span class='line'><span class="p">(</span><span class="nf">lengthz</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">x</span><span class="p">))</span>   <span class="c1">; 3</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; length via set!</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">lengthz</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">set! </span><span class="nv">lengthz</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">lengthz</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Test length</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">lengthz</span> <span class="o">&#39;</span><span class="p">())</span>        <span class="c1">; 0</span>
</span><span class='line'><span class="p">(</span><span class="nf">lengthz</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">x</span><span class="p">))</span>   <span class="c1">; 3</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; length via set! again</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">lengthz</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">h</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">set! </span><span class="nv">h</span>
</span><span class='line'>      <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>          <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">h</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>    <span class="nv">h</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Test length</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">lengthz</span> <span class="o">&#39;</span><span class="p">())</span>        <span class="c1">; 0</span>
</span><span class='line'><span class="p">(</span><span class="nf">lengthz</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">x</span><span class="p">))</span>   <span class="c1">; 3</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;                                                                            ;</span>
</span><span class='line'><span class="c1">; The seventeenth commandment (final version)                                ;</span>
</span><span class='line'><span class="c1">;                                                                            ;</span>
</span><span class='line'><span class="c1">; Use (set! x ...) for (let ((x ...)) ...) only if there is at least one     ;</span>
</span><span class='line'><span class="c1">; (lambda ... between it and the (let ...), or if the new value for x is a   ;</span>
</span><span class='line'><span class="c1">; function that refers to x                                                  ;</span>
</span><span class='line'><span class="c1">;                                                                            ;</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Another way to write length</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">h1</span>              <span class="c1">; h1 is actually an anonymous name</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">lengthz</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">()</span>
</span><span class='line'>    <span class="p">(</span><span class="k">set! </span><span class="nv">h1</span>
</span><span class='line'>      <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>          <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">h1</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>    <span class="nv">h1</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Test length</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">lengthz</span> <span class="o">&#39;</span><span class="p">())</span>        <span class="c1">; 0</span>
</span><span class='line'><span class="p">(</span><span class="nf">lengthz</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">x</span><span class="p">))</span>   <span class="c1">; 3</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Another way</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">h2</span>              <span class="c1">; h2 is actually an anonymous name</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">h2</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">lengthz</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">()</span> <span class="nv">h2</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Test length</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">lengthz</span> <span class="o">&#39;</span><span class="p">())</span>        <span class="c1">; 0</span>
</span><span class='line'><span class="p">(</span><span class="nf">lengthz</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">x</span><span class="p">))</span>   <span class="c1">; 3</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; length again</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">lengthz</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">h</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">set! </span><span class="nv">h</span>
</span><span class='line'>      <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>          <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">h</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>    <span class="nv">h</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Test length</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">lengthz</span> <span class="o">&#39;</span><span class="p">())</span>        <span class="c1">; 0</span>
</span><span class='line'><span class="p">(</span><span class="nf">lengthz</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">x</span><span class="p">))</span>   <span class="c1">; 3</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Let&#39;s eliminate parts that are specific to length</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">L</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lengthz</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>        <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">lengthz</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">lengthz</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">h</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">set! </span><span class="nv">h</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">L</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">arg</span><span class="p">)</span> <span class="p">(</span><span class="nf">h</span> <span class="nv">arg</span><span class="p">))))</span>
</span><span class='line'>    <span class="nv">h</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Test length</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">lengthz</span> <span class="o">&#39;</span><span class="p">())</span>        <span class="c1">; 0</span>
</span><span class='line'><span class="p">(</span><span class="nf">lengthz</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">x</span><span class="p">))</span>   <span class="c1">; 3</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Y-bang - the applicative-order imperative y-combinator</span>
</span><span class='line'><span class="c1">; (discovered by Peter Landin)</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">Y-bang</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">f</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">h</span> <span class="p">(</span><span class="nf">f</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">arg</span><span class="p">)</span> <span class="p">(</span><span class="nf">h</span> <span class="nv">arg</span><span class="p">)))))</span>
</span><span class='line'>      <span class="nv">h</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">lengthz</span> <span class="p">(</span><span class="nf">Y-bang</span> <span class="nv">L</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Test length</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">lengthz</span> <span class="o">&#39;</span><span class="p">())</span>        <span class="c1">; 0</span>
</span><span class='line'><span class="p">(</span><span class="nf">lengthz</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="nv">b</span> <span class="nv">x</span><span class="p">))</span>   <span class="c1">; 3</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; depth* via Y-bang</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">D</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">depth*</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">s</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>        <span class="p">((</span><span class="nb">null? </span><span class="nv">s</span><span class="p">)</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>        <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">s</span><span class="p">))</span> <span class="p">(</span><span class="nf">depth*</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">s</span><span class="p">)))</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>          <span class="p">(</span><span class="nb">max </span><span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">depth*</span> <span class="p">(</span><span class="nb">car </span><span class="nv">s</span><span class="p">)))</span> <span class="p">(</span><span class="nf">depth*</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">s</span><span class="p">))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">depth*</span> <span class="p">(</span><span class="nf">Y-bang</span> <span class="nv">D</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Test depth*</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">depth*</span> <span class="o">&#39;</span><span class="p">())</span>                <span class="c1">; 1</span>
</span><span class='line'><span class="p">(</span><span class="nf">depth*</span> <span class="o">&#39;</span><span class="p">(((</span><span class="nf">pizza</span><span class="p">))</span> <span class="p">()))</span>    <span class="c1">; 3</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The bizarre function</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">biz</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">x</span> <span class="mi">0</span><span class="p">))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">set! </span><span class="nv">x</span> <span class="p">(</span><span class="nf">add1</span> <span class="nv">x</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">a</span> <span class="nv">x</span><span class="p">)</span>
</span><span class='line'>          <span class="mi">0</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">f</span> <span class="nv">a</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Another way to write bizarre</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">x1</span> <span class="mi">0</span><span class="p">)</span>               <span class="c1">; anonymous var</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">biz</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">f</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">set! </span><span class="nv">x1</span> <span class="p">(</span><span class="nf">add1</span> <span class="nv">x1</span><span class="p">))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">= </span><span class="nv">a</span> <span class="nv">x1</span><span class="p">)</span>
</span><span class='line'>        <span class="mi">0</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">f</span> <span class="nv">a</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The Y-Combinator</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">Y</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">le</span><span class="p">)</span>
</span><span class='line'>    <span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">f</span><span class="p">)</span> <span class="p">(</span><span class="nf">f</span> <span class="nv">f</span><span class="p">))</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">f</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">le</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">((</span><span class="nf">f</span> <span class="nv">f</span><span class="p">)</span> <span class="nv">x</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">((</span><span class="nf">Y</span> <span class="nv">biz</span><span class="p">)</span> <span class="mi">5</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; ((Y-bang biz) 5)          ; doesn&#39;t compute... why?</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">; Chapter 17 of The Seasoned Schemer:</span>
</span><span class='line'><span class="c1">; We Change, Therefore We Are!</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">; Code examples assemled by Peteris Krumins (peter@catonmat.net).</span>
</span><span class='line'><span class="c1">; His blog is at http://www.catonmat.net  --  good coders code, great reuse.</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">; Get yourself this wonderful book at Amazon: http://bit.ly/8cyjgw</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The atom? primitive</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">atom?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">pair? </span><span class="nv">x</span><span class="p">))</span> <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">null? </span><span class="nv">x</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The sub1 primitive</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">sub1</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The add1 primitive</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">add1</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">+ </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The deep function wraps pizza in m parenthesis</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">deep</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">m</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">zero? </span><span class="nv">m</span><span class="p">)</span>
</span><span class='line'>      <span class="ss">&#39;pizza</span>
</span><span class='line'>      <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">deep</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">m</span><span class="p">))</span> <span class="o">&#39;</span><span class="p">()))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Examples of deep</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">deep</span> <span class="mi">3</span><span class="p">)</span>                <span class="c1">; &#39;(((pizza)))</span>
</span><span class='line'><span class="p">(</span><span class="nf">deep</span> <span class="mi">0</span><span class="p">)</span>                <span class="c1">; &#39;pizza</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The deepM function remembers calls to deep</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">; The deepM function uses find function to find n in Ns and return </span>
</span><span class='line'><span class="c1">; the correct value from Rs</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">find</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span> <span class="nv">Ns</span> <span class="nv">Rs</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">A</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">ns</span> <span class="nv">rs</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>              <span class="p">((</span><span class="nb">null? </span><span class="nv">ns</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>              <span class="p">((</span><span class="nb">= </span><span class="p">(</span><span class="nb">car </span><span class="nv">Ns</span><span class="p">)</span> <span class="nv">n</span><span class="p">)</span> <span class="p">(</span><span class="nb">car </span><span class="nv">Rs</span><span class="p">))</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">A</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">ns</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">rs</span><span class="p">)))))))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">A</span> <span class="nv">Ns</span> <span class="nv">Rs</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">deepM</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">Rs</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">Ns</span> <span class="o">&#39;</span><span class="p">()))</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">D</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">m</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">zero? </span><span class="nv">m</span><span class="p">)</span>
</span><span class='line'>              <span class="ss">&#39;pizza</span>
</span><span class='line'>              <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">deepM</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">m</span><span class="p">))</span> <span class="o">&#39;</span><span class="p">())))))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">exists</span> <span class="p">(</span><span class="nf">find</span> <span class="nv">n</span> <span class="nv">Ns</span> <span class="nv">Rs</span><span class="p">)))</span>
</span><span class='line'>          <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">atom?</span> <span class="nv">exists</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">result</span> <span class="p">(</span><span class="nf">D</span> <span class="nv">n</span><span class="p">)))</span>
</span><span class='line'>              <span class="p">(</span><span class="k">set! </span><span class="nv">Rs</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">result</span> <span class="nv">Rs</span><span class="p">))</span>
</span><span class='line'>              <span class="p">(</span><span class="k">set! </span><span class="nv">Ns</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">n</span> <span class="nv">Ns</span><span class="p">))</span>
</span><span class='line'>              <span class="nv">result</span><span class="p">)</span>
</span><span class='line'>            <span class="nv">exists</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Examples of deepM</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">deepM</span> <span class="mi">3</span><span class="p">)</span>               <span class="c1">; &#39;(((pizza)))</span>
</span><span class='line'><span class="p">(</span><span class="nf">deepM</span> <span class="mi">0</span><span class="p">)</span>               <span class="c1">; &#39;pizza</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; No need to use letrec in deepM</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">deepM-letrec</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">Rs</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">Ns</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">D</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">m</span><span class="p">)</span>
</span><span class='line'>              <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">zero? </span><span class="nv">m</span><span class="p">)</span>
</span><span class='line'>                <span class="ss">&#39;pizza</span>
</span><span class='line'>                <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">deepM-letrec</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">m</span><span class="p">))</span> <span class="o">&#39;</span><span class="p">())))))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">exists</span> <span class="p">(</span><span class="nf">find</span> <span class="nv">n</span> <span class="nv">Ns</span> <span class="nv">Rs</span><span class="p">)))</span>
</span><span class='line'>        <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">atom?</span> <span class="nv">exists</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">result</span> <span class="p">(</span><span class="nf">D</span> <span class="nv">n</span><span class="p">)))</span>
</span><span class='line'>            <span class="p">(</span><span class="k">set! </span><span class="nv">Rs</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">result</span> <span class="nv">Rs</span><span class="p">))</span>
</span><span class='line'>            <span class="p">(</span><span class="k">set! </span><span class="nv">Ns</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">n</span> <span class="nv">Ns</span><span class="p">))</span>
</span><span class='line'>            <span class="nv">result</span><span class="p">)</span>
</span><span class='line'>          <span class="nv">exists</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Test of the new deepM</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">deepM-letrec</span> <span class="mi">3</span><span class="p">)</span>               <span class="c1">; &#39;(((pizza)))</span>
</span><span class='line'><span class="p">(</span><span class="nf">deepM-letrec</span> <span class="mi">0</span><span class="p">)</span>               <span class="c1">; &#39;pizza</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; No need for D in deepM</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">deepM-D</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">Rs</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">Ns</span> <span class="o">&#39;</span><span class="p">()))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">exists</span> <span class="p">(</span><span class="nf">find</span> <span class="nv">n</span> <span class="nv">Ns</span> <span class="nv">Rs</span><span class="p">)))</span>
</span><span class='line'>        <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">atom?</span> <span class="nv">exists</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">result</span> <span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">m</span><span class="p">)</span>
</span><span class='line'>                           <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">zero? </span><span class="nv">m</span><span class="p">)</span>
</span><span class='line'>                             <span class="ss">&#39;pizza</span>
</span><span class='line'>                             <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">deepM-D</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">m</span><span class="p">))</span> <span class="o">&#39;</span><span class="p">())))</span> <span class="nv">n</span><span class="p">)))</span>
</span><span class='line'>            <span class="p">(</span><span class="k">set! </span><span class="nv">Rs</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">result</span> <span class="nv">Rs</span><span class="p">))</span>
</span><span class='line'>            <span class="p">(</span><span class="k">set! </span><span class="nv">Ns</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">n</span> <span class="nv">Ns</span><span class="p">))</span>
</span><span class='line'>            <span class="nv">result</span><span class="p">)</span>
</span><span class='line'>          <span class="nv">exists</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Test of the new deepM</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">deepM-D</span> <span class="mi">3</span><span class="p">)</span>               <span class="c1">; &#39;(((pizza)))</span>
</span><span class='line'><span class="p">(</span><span class="nf">deepM-D</span> <span class="mi">0</span><span class="p">)</span>               <span class="c1">; &#39;pizza</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; No need for the 2nd lambda </span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">deepM-2nd</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">Rs</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">Ns</span> <span class="o">&#39;</span><span class="p">()))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">exists</span> <span class="p">(</span><span class="nf">find</span> <span class="nv">n</span> <span class="nv">Ns</span> <span class="nv">Rs</span><span class="p">)))</span>
</span><span class='line'>        <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">atom?</span> <span class="nv">exists</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">result</span> <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">zero? </span><span class="nv">n</span><span class="p">)</span>
</span><span class='line'>                            <span class="ss">&#39;pizza</span>
</span><span class='line'>                            <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">deepM-2nd</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">))</span> <span class="o">&#39;</span><span class="p">()))))</span>
</span><span class='line'>            <span class="p">(</span><span class="k">set! </span><span class="nv">Rs</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">result</span> <span class="nv">Rs</span><span class="p">))</span>
</span><span class='line'>            <span class="p">(</span><span class="k">set! </span><span class="nv">Ns</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">n</span> <span class="nv">Ns</span><span class="p">))</span>
</span><span class='line'>            <span class="nv">result</span><span class="p">)</span>
</span><span class='line'>          <span class="nv">exists</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Test of the new deepM</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">deepM-2nd</span> <span class="mi">3</span><span class="p">)</span>               <span class="c1">; &#39;(((pizza)))</span>
</span><span class='line'><span class="p">(</span><span class="nf">deepM-2nd</span> <span class="mi">0</span><span class="p">)</span>               <span class="c1">; &#39;pizza</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The consC function counts number of conses needed to build</span>
</span><span class='line'><span class="c1">; n-deep pizza</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">consC</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">N</span> <span class="mi">0</span><span class="p">))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span> <span class="nv">y</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">set! </span><span class="nv">N</span> <span class="p">(</span><span class="nf">add1</span> <span class="nv">N</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="nb">cons </span><span class="nv">x</span> <span class="nv">y</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; No way to get N out of this consC, so we need the counter</span>
</span><span class='line'><span class="c1">; function that will hold the count</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">counter</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; And a modification of consC</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">consC</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">N</span> <span class="mi">0</span><span class="p">))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">set! </span><span class="nv">counter</span> <span class="p">(</span><span class="nf">lambda</span><span class="p">()</span> <span class="nv">N</span><span class="p">))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span> <span class="nv">y</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">set! </span><span class="nv">N</span> <span class="p">(</span><span class="nf">add1</span> <span class="nv">N</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="nb">cons </span><span class="nv">x</span> <span class="nv">y</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; And we need to modify deep</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">deep</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">m</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">zero? </span><span class="nv">m</span><span class="p">)</span>
</span><span class='line'>      <span class="ss">&#39;pizza</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">consC</span> <span class="p">(</span><span class="nf">deep</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">m</span><span class="p">))</span> <span class="o">&#39;</span><span class="p">()))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">deep</span> <span class="mi">5</span><span class="p">)</span>            <span class="c1">; &#39;(((((pizza)))))</span>
</span><span class='line'><span class="p">(</span><span class="nf">counter</span><span class="p">)</span>           <span class="c1">; 5</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">deep</span> <span class="mi">7</span><span class="p">)</span>            <span class="c1">; &#39;(((pizza))</span>
</span><span class='line'><span class="p">(</span><span class="nf">counter</span><span class="p">)</span>           <span class="c1">; 12                ;;; (5 + 7) </span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Let&#39;s determine how many cons&#39;es are necessary to find</span>
</span><span class='line'><span class="c1">; values of (deep 0) ... (deep 1000).</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">supercounter</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">f</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">S</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">zero? </span><span class="nv">n</span><span class="p">)</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">f</span> <span class="nv">n</span><span class="p">)</span>
</span><span class='line'>              <span class="p">(</span><span class="k">let </span><span class="p">()</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">f</span> <span class="nv">n</span><span class="p">)</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">S</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">)))))))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">S</span> <span class="mi">1000</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">counter</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Try out supercounter</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">supercounter</span> <span class="nv">deep</span><span class="p">)</span>         <span class="c1">; 500512    ;;; not 500500 as expected</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Need to wipe out counter before using it again</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">set-counter</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">consC</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">N</span> <span class="mi">0</span><span class="p">))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">set! </span><span class="nv">counter</span> <span class="p">(</span><span class="nf">lambda</span><span class="p">()</span> <span class="nv">N</span><span class="p">))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">set! </span><span class="nv">set-counter</span>
</span><span class='line'>      <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="k">set! </span><span class="nv">N</span> <span class="nv">x</span><span class="p">)))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span> <span class="nv">y</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">set! </span><span class="nv">N</span> <span class="p">(</span><span class="nf">add1</span> <span class="nv">N</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="nb">cons </span><span class="nv">x</span> <span class="nv">y</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">set-counter</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Try out supercounter again</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">supercounter</span> <span class="nv">deep</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; How many conses are used by (deepM 5)?</span>
</span><span class='line'><span class="c1">; Need to modify deepM to use consC first.</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">deepM-consC</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">Rs</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">Ns</span> <span class="o">&#39;</span><span class="p">()))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">exists</span> <span class="p">(</span><span class="nf">find</span> <span class="nv">n</span> <span class="nv">Ns</span> <span class="nv">Rs</span><span class="p">)))</span>
</span><span class='line'>        <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">atom?</span> <span class="nv">exists</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">result</span>
</span><span class='line'>                  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">zero? </span><span class="nv">n</span><span class="p">)</span>
</span><span class='line'>                    <span class="ss">&#39;pizza</span>
</span><span class='line'>                    <span class="p">(</span><span class="nf">consC</span> <span class="p">(</span><span class="nf">deepM-consC</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">))</span> <span class="o">&#39;</span><span class="p">()))))</span>
</span><span class='line'>            <span class="p">(</span><span class="k">set! </span><span class="nv">Rs</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">result</span> <span class="nv">Rs</span><span class="p">))</span>
</span><span class='line'>            <span class="p">(</span><span class="k">set! </span><span class="nv">Ns</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">n</span> <span class="nv">Ns</span><span class="p">))</span>
</span><span class='line'>            <span class="nv">result</span><span class="p">)</span>
</span><span class='line'>          <span class="nv">exists</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; How many conses are used by (deepM 5)?</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">deepM</span> <span class="mi">5</span><span class="p">)</span>           <span class="c1">; &#39;(((((pizza)))))</span>
</span><span class='line'><span class="p">(</span><span class="nf">counter</span><span class="p">)</span>           <span class="c1">; 500505    ;;; because we forgot to reset counter</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">set-counter</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="nf">deepM-consC</span> <span class="mi">5</span><span class="p">)</span>     <span class="c1">; &#39;(((((pizza)))))</span>
</span><span class='line'><span class="p">(</span><span class="nf">counter</span><span class="p">)</span>           <span class="c1">; 5</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">deep</span> <span class="mi">7</span><span class="p">)</span>            <span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">counter</span><span class="p">)</span>           <span class="c1">; ??? the book says it should be 0, I get 12, why?</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">supercounter</span> <span class="nv">deepM-consC</span><span class="p">)</span>  <span class="c1">; ??? how did this work? it didn&#39;t take an argument?</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Book has also talks about conses in rember* function but I am not interested</span>
</span><span class='line'><span class="c1">; in it at the moment.</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">; Chapter 18 of The Seasoned Schemer:</span>
</span><span class='line'><span class="c1">; We Change, Therefore We Are the Same!</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">; Code examples assemled by Peteris Krumins (peter@catonmat.net).</span>
</span><span class='line'><span class="c1">; His blog is at http://www.catonmat.net  --  good coders code, great reuse.</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">; Get yourself this wonderful book at Amazon: http://bit.ly/8cyjgw</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The atom? primitive</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">atom?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">pair? </span><span class="nv">x</span><span class="p">))</span> <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">null? </span><span class="nv">x</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The sub1 primitive</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">sub1</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The add1 primitive</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">add1</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">+ </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The lots function creates lots of eggs</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">lots</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">zero? </span><span class="nv">n</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="nb">cons </span><span class="ss">&#39;egg</span> <span class="p">(</span><span class="nf">lots</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The lenkth function counts the eggs</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">lenkth</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">lenkth</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Examples of lots and lenkth</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">lots</span> <span class="mi">3</span><span class="p">)</span>                <span class="c1">; &#39;(egg egg egg)</span>
</span><span class='line'><span class="p">(</span><span class="nf">lots</span> <span class="mi">5</span><span class="p">)</span>                <span class="c1">; &#39;(egg egg egg egg egg)</span>
</span><span class='line'><span class="p">(</span><span class="nf">lots</span> <span class="mi">12</span><span class="p">)</span>               <span class="c1">; &#39;(egg egg egg egg egg egg egg egg egg egg egg egg)</span>
</span><span class='line'><span class="p">(</span><span class="nf">lenkth</span> <span class="p">(</span><span class="nf">lots</span> <span class="mi">3</span><span class="p">))</span>       <span class="c1">; 3</span>
</span><span class='line'><span class="p">(</span><span class="nf">lenkth</span> <span class="p">(</span><span class="nf">lots</span> <span class="mi">5</span><span class="p">))</span>       <span class="c1">; 5</span>
</span><span class='line'><span class="p">(</span><span class="nf">lenkth</span> <span class="p">(</span><span class="nf">lots</span> <span class="mi">15</span><span class="p">))</span>      <span class="c1">; 15</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Create 4 eggs from 3 eggs</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nb">cons </span><span class="ss">&#39;egg</span> <span class="p">(</span><span class="nf">lots</span> <span class="mi">3</span><span class="p">))</span>    <span class="c1">; &#39;(egg egg egg egg)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; consC, counter, set-counter from chapter 17</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">counter</span> <span class="p">(</span><span class="nf">lambda</span><span class="p">()</span> <span class="mi">0</span><span class="p">))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">set-counter</span> <span class="p">(</span><span class="k">lambda </span><span class="p">()</span> <span class="mi">0</span><span class="p">))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">consC</span>
</span><span class='line'>  <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">N</span> <span class="mi">0</span><span class="p">))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">set! </span><span class="nv">counter</span> <span class="p">(</span><span class="nf">lambda</span><span class="p">()</span> <span class="nv">N</span><span class="p">))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">set! </span><span class="nv">set-counter</span>
</span><span class='line'>      <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="k">set! </span><span class="nv">N</span> <span class="nv">x</span><span class="p">)))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span> <span class="nv">y</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">set! </span><span class="nv">N</span> <span class="p">(</span><span class="nf">add1</span> <span class="nv">N</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="nb">cons </span><span class="nv">x</span> <span class="nv">y</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Add an egg at the end</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">add-at-end</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">consC</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nb">cons </span><span class="ss">&#39;egg-end</span> <span class="o">&#39;</span><span class="p">())))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">consC</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="nf">add-at-end</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Example of add-at-end</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">add-at-end</span> <span class="p">(</span><span class="nf">lots</span> <span class="mi">3</span><span class="p">))</span>   <span class="c1">; &#39;(egg egg egg egg-end)</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">counter</span><span class="p">)</span>               <span class="c1">; 3</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Add an egg at the end without making any new conses except for the last one</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">add-at-end-too</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">A</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">ls</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>              <span class="p">((</span><span class="nb">null? </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">ls</span><span class="p">))</span>
</span><span class='line'>               <span class="p">(</span><span class="nb">set-cdr! </span><span class="nv">ls</span> <span class="p">(</span><span class="nb">cons </span><span class="ss">&#39;egg-end2</span> <span class="o">&#39;</span><span class="p">())))</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">A</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">ls</span><span class="p">)))))))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">A</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>      <span class="nv">l</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Example of add-at-end-too</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">set-counter</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="nf">add-at-end-too</span> <span class="p">(</span><span class="nf">lots</span> <span class="mi">3</span><span class="p">))</span>   <span class="c1">; &#39;(egg egg egg egg-end2)</span>
</span><span class='line'><span class="p">(</span><span class="nf">counter</span><span class="p">)</span>                   <span class="c1">; 0</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; kons the magnificent</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">kons</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">kar</span> <span class="nv">kdr</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">selector</span><span class="p">)</span>          <span class="c1">; returns lambda (selector)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">selector</span> <span class="nv">kar</span> <span class="nv">kdr</span><span class="p">))))</span>     <span class="c1">; calls selector with kar and kdr arguments</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; kar</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">kar</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">c</span><span class="p">)</span>                   <span class="c1">; applies selector on (a d) and returns &#39;a (car)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">c</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">d</span><span class="p">)</span> <span class="nv">a</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; kdr</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">kdr</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">c</span><span class="p">)</span>                   <span class="c1">; applies selector on (a d) and returns d (cdr)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">c</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">d</span><span class="p">)</span> <span class="nv">d</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Examples of kons kar kdr</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">kar</span> <span class="p">(</span><span class="nf">kons</span> <span class="ss">&#39;a</span> <span class="o">&#39;</span><span class="p">()))</span>                 <span class="c1">; &#39;a</span>
</span><span class='line'><span class="p">(</span><span class="nf">kdr</span> <span class="p">(</span><span class="nf">kons</span> <span class="ss">&#39;a</span> <span class="o">&#39;</span><span class="p">()))</span>                 <span class="c1">; &#39;()</span>
</span><span class='line'><span class="p">(</span><span class="nf">kar</span> <span class="p">(</span><span class="nf">kdr</span> <span class="p">(</span><span class="nf">kons</span> <span class="ss">&#39;a</span> <span class="p">(</span><span class="nf">kons</span> <span class="ss">&#39;b</span> <span class="o">&#39;</span><span class="p">()))))</span> <span class="c1">; &#39;b</span>
</span><span class='line'><span class="p">(</span><span class="nf">kar</span> <span class="p">(</span><span class="nf">kons</span> <span class="ss">&#39;a</span> <span class="p">(</span><span class="nf">kons</span> <span class="ss">&#39;b</span> <span class="o">&#39;</span><span class="p">())))</span>       <span class="c1">; &#39;a</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Another cons</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">bons</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">kar</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">kdr</span> <span class="o">&#39;</span><span class="p">()))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">selector</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">selector</span>
</span><span class='line'>          <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="k">set! </span><span class="nv">kdr</span> <span class="nv">x</span><span class="p">))</span>
</span><span class='line'>          <span class="nv">kar</span>
</span><span class='line'>          <span class="nv">kdr</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Another kar</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">bar</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">c</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">c</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">s</span> <span class="nv">a</span> <span class="nv">d</span><span class="p">)</span> <span class="nv">a</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Another kdr</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">bdr</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">c</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">c</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">s</span> <span class="nv">a</span> <span class="nv">d</span><span class="p">)</span> <span class="nv">d</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; set-kdr</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">set-kdr</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">c</span> <span class="nv">x</span><span class="p">)</span>
</span><span class='line'>    <span class="p">((</span><span class="nf">c</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">s</span> <span class="nv">a</span> <span class="nv">d</span><span class="p">)</span> <span class="nv">s</span><span class="p">))</span> <span class="nv">x</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; create kons using set-kdr and bons</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">kons2</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">d</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">c</span> <span class="p">(</span><span class="nf">bons</span> <span class="nv">a</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">set-kdr</span> <span class="nv">c</span> <span class="nv">d</span><span class="p">)</span>
</span><span class='line'>      <span class="nv">c</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Example of kons2 bar and bdr</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">bar</span> <span class="p">(</span><span class="nf">kons2</span> <span class="ss">&#39;a</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)))</span>       <span class="c1">; &#39;a</span>
</span><span class='line'><span class="p">(</span><span class="nf">bdr</span> <span class="p">(</span><span class="nf">kons2</span> <span class="ss">&#39;a</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">)))</span>       <span class="c1">; &#39;(1 2 3)</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Now eggs again</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">dozen</span> <span class="p">(</span><span class="nf">lots</span> <span class="mi">12</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="nv">dozen</span>           <span class="c1">; &#39;(egg egg egg egg egg egg egg egg egg egg egg egg)</span>
</span><span class='line'>                <span class="c1">; used 12 conses</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">bakers-dozen</span> <span class="p">(</span><span class="nf">add-at-end</span> <span class="nv">dozen</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="nv">bakers-dozen</span>    <span class="c1">; &#39;(egg egg egg egg egg egg egg egg egg egg egg egg egg-end)</span>
</span><span class='line'>                <span class="c1">; used 13 conses (25 total now)</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">bakers-dozen-too</span> <span class="p">(</span><span class="nf">add-at-end-too</span> <span class="nv">dozen</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="nv">bakers-dozen-too</span>    <span class="c1">; &#39;(egg egg egg egg egg egg egg egg egg egg egg egg egg-end egg-end2)</span>
</span><span class='line'>                    <span class="c1">; used 1 cons (26 total)</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">bakers-dozen-again</span> <span class="p">(</span><span class="nf">add-at-end</span> <span class="nv">dozen</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="nv">bakers-dozen-again</span>  <span class="c1">; &#39;(egg egg egg egg egg egg egg egg egg egg egg egg egg-end egg-end2 egg-end)</span>
</span><span class='line'>                    <span class="c1">; used 14 conses (40 total)</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">same?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">c1</span> <span class="nv">c2</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="k">and </span><span class="p">(</span><span class="nb">null? </span><span class="nv">c1</span><span class="p">)</span> <span class="p">(</span><span class="nb">null? </span><span class="nv">c2</span><span class="p">))</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="k">or </span><span class="p">(</span><span class="nb">null? </span><span class="nv">c1</span><span class="p">)</span> <span class="p">(</span><span class="nb">null? </span><span class="nv">c2</span><span class="p">))</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>       <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">t1</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">c1</span><span class="p">))</span>
</span><span class='line'>             <span class="p">(</span><span class="nf">t2</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">c2</span><span class="p">)))</span>
</span><span class='line'>         <span class="p">(</span><span class="nb">set-cdr! </span><span class="nv">c1</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="nb">set-cdr! </span><span class="nv">c2</span> <span class="mi">2</span><span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">v</span> <span class="p">(</span><span class="nb">= </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">c1</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">c2</span><span class="p">))))</span>
</span><span class='line'>           <span class="p">(</span><span class="nb">set-cdr! </span><span class="nv">c1</span> <span class="nv">t1</span><span class="p">)</span>
</span><span class='line'>           <span class="p">(</span><span class="nb">set-cdr! </span><span class="nv">c2</span> <span class="nv">t2</span><span class="p">)</span>
</span><span class='line'>           <span class="nv">v</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">same?</span> <span class="nv">dozen</span> <span class="nv">dozen</span><span class="p">)</span>                     <span class="c1">; #t</span>
</span><span class='line'><span class="p">(</span><span class="nf">same?</span> <span class="nv">dozen</span> <span class="nv">bakers-dozen</span><span class="p">)</span>              <span class="c1">; #f</span>
</span><span class='line'><span class="p">(</span><span class="nf">same?</span> <span class="nv">dozen</span> <span class="nv">bakers-dozen-too</span><span class="p">)</span>          <span class="c1">; #t</span>
</span><span class='line'><span class="p">(</span><span class="nf">same?</span> <span class="nv">dozen</span> <span class="nv">bakers-dozen-again</span><span class="p">)</span>        <span class="c1">; #f</span>
</span><span class='line'><span class="p">(</span><span class="nf">same?</span> <span class="nv">bakers-dozen</span> <span class="nv">bakers-dozen-too</span><span class="p">)</span>   <span class="c1">; #f   ;;; the book says #t???</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The last-kons function returns the last cons in a non-empty kons-list</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">last-kons</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">ls</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">ls</span><span class="p">))</span> <span class="nv">ls</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">last-kons</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">ls</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">long</span> <span class="p">(</span><span class="nf">lots</span> <span class="mi">12</span><span class="p">))</span>                 <span class="c1">; &#39;(egg egg egg egg egg egg egg egg egg egg egg egg)</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nb">set-cdr! </span><span class="p">(</span><span class="nf">last-kons</span> <span class="nv">long</span><span class="p">)</span> <span class="nv">long</span><span class="p">)</span>        <span class="c1">; #0 = &#39;(egg egg egg egg egg egg egg egg egg egg egg . #0#) </span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The finite-lenkth function returns length of a list</span>
</span><span class='line'><span class="c1">; or #f if it&#39;s an infinite list</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">finite-lenkth</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">p</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">call-with-current-continuation</span>
</span><span class='line'>      <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">infinite</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>          <span class="p">((</span><span class="nf">C</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">p</span> <span class="nv">q</span><span class="p">)</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>                  <span class="p">((</span><span class="nf">same?</span> <span class="nv">p</span> <span class="nv">q</span><span class="p">)</span> <span class="p">(</span><span class="nf">infinite</span> <span class="no">#f</span><span class="p">))</span>
</span><span class='line'>                  <span class="p">((</span><span class="nb">null? </span><span class="nv">q</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>                  <span class="p">((</span><span class="nb">null? </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">q</span><span class="p">))</span> <span class="mi">1</span><span class="p">)</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>                    <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nf">C</span> <span class="p">(</span><span class="nf">sl</span> <span class="nv">p</span><span class="p">)</span> <span class="p">(</span><span class="nf">qk</span> <span class="nv">q</span><span class="p">))</span> <span class="mi">2</span><span class="p">)))))</span>
</span><span class='line'>           <span class="p">(</span><span class="nf">qk</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">x</span><span class="p">))))</span>
</span><span class='line'>           <span class="p">(</span><span class="nf">sl</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">x</span><span class="p">))))</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>            <span class="p">((</span><span class="nb">null? </span><span class="nv">p</span><span class="p">)</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">C</span> <span class="nv">p</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">p</span><span class="p">))))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Examples of finite-lenkth</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">not-so-long</span> <span class="p">(</span><span class="nf">lots</span> <span class="mi">5</span><span class="p">))</span>         <span class="c1">; &#39;(egg egg egg egg egg)</span>
</span><span class='line'><span class="p">(</span><span class="nf">finite-lenkth</span> <span class="nv">not-so-long</span><span class="p">)</span>           <span class="c1">; 5</span>
</span><span class='line'><span class="p">(</span><span class="nf">finite-lenkth</span> <span class="nv">long</span><span class="p">)</span>                  <span class="c1">; #f</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Guy&#39;s Favorite Pie</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">mongo</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">cons </span><span class="ss">&#39;pie</span>
</span><span class='line'>   <span class="p">(</span><span class="nb">cons </span><span class="ss">&#39;a</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">cons </span><span class="ss">&#39;la</span>
</span><span class='line'>     <span class="p">(</span><span class="nb">cons </span><span class="ss">&#39;mode</span> <span class="o">&#39;</span><span class="p">())))))</span>
</span><span class='line'><span class="p">(</span><span class="nb">set-cdr! </span><span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">mongo</span><span class="p">)))</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">mongo</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; mongo</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">; Chapter 19 of The Seasoned Schemer:</span>
</span><span class='line'><span class="c1">; Absconding with the Jewels</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">; Code examples assemled by Peteris Krumins (peter@catonmat.net).</span>
</span><span class='line'><span class="c1">; His blog is at http://www.catonmat.net  --  good coders code, great reuse.</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="c1">; Get yourself this wonderful book at Amazon: http://bit.ly/8cyjgw</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The atom? primitive</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">atom?</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">pair? </span><span class="nv">x</span><span class="p">))</span> <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">null? </span><span class="nv">x</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The sub1 primitive</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">sub1</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">n</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Our friend deep</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">deep</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">m</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">zero? </span><span class="nv">m</span><span class="p">)</span> <span class="ss">&#39;pizza</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">deep</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">m</span><span class="p">))</span> <span class="o">&#39;</span><span class="p">())))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Example of deep</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">deep</span> <span class="mi">6</span><span class="p">)</span>                    <span class="c1">; &#39;((((((pizza))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Six layers creates six layered pizza</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">six-layers</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">p</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">cons</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">cons </span><span class="nv">p</span> <span class="o">&#39;</span><span class="p">())</span> <span class="o">&#39;</span><span class="p">())</span> <span class="o">&#39;</span><span class="p">())</span> <span class="o">&#39;</span><span class="p">())</span> <span class="o">&#39;</span><span class="p">())</span> <span class="o">&#39;</span><span class="p">())))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Example of six-layers</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">six-layers</span> <span class="ss">&#39;pizza</span><span class="p">)</span>         <span class="c1">; &#39;((((((pizza))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Four layers makes a four layered pizza</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">four-layers</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">p</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">cons</span>
</span><span class='line'>    <span class="p">(</span><span class="nb">cons </span><span class="nv">p</span> <span class="o">&#39;</span><span class="p">())</span> <span class="o">&#39;</span><span class="p">())</span> <span class="o">&#39;</span><span class="p">())</span> <span class="o">&#39;</span><span class="p">())))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Example of four-layers</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">four-layers</span> <span class="ss">&#39;pizza</span><span class="p">)</span>        <span class="c1">; &#39;((((pizza))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; The deepB function does layering</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">toppings</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">deepB</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">m</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">zero? </span><span class="nv">m</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">call-with-current-continuation</span>
</span><span class='line'>         <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">jump</span><span class="p">)</span>
</span><span class='line'>           <span class="p">(</span><span class="k">set! </span><span class="nv">toppings</span> <span class="nv">jump</span><span class="p">)</span>
</span><span class='line'>           <span class="ss">&#39;pizza</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">deepB</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">m</span><span class="p">))</span> <span class="o">&#39;</span><span class="p">())))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Example of deepB</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">deepB</span> <span class="mi">6</span><span class="p">)</span>                   <span class="c1">; &#39;((((((pizza)))))), but what does jump do?</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Six layers again</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">six-layers</span> <span class="ss">&#39;mozzarella</span><span class="p">)</span>    <span class="c1">; &#39;((((((mozarella))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Now the toppings</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">toppings</span> <span class="ss">&#39;mozzarella</span><span class="p">)</span>      <span class="c1">; &#39;((((((mozarella))))))</span>
</span><span class='line'><span class="p">(</span><span class="nf">toppings</span> <span class="ss">&#39;cake</span><span class="p">)</span>            <span class="c1">; &#39;((((((cake))))))</span>
</span><span class='line'><span class="p">(</span><span class="nf">toppings</span> <span class="ss">&#39;pizza</span><span class="p">)</span>           <span class="c1">; &#39;((((((pizza))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; What about his</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">toppings</span> <span class="ss">&#39;cake</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span> <span class="c1">; it&#39;s still &#39;((((((cake)))))) and not &#39;(((((((cake)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'><span class="c1">;                                                                            ;</span>
</span><span class='line'><span class="c1">; The twentieth commandment                                                  ;</span>
</span><span class='line'><span class="c1">;                                                                            ;</span>
</span><span class='line'><span class="c1">; When thinking about a value created with (letcc ...), write down the       ;</span>
</span><span class='line'><span class="c1">; function that is equivalent but does not forget. Then, when you use it,    ;</span>
</span><span class='line'><span class="c1">; remember to forget.                                                        ;</span>
</span><span class='line'><span class="c1">;                                                                            ;</span>
</span><span class='line'><span class="c1">;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Deep&amp;co</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">deep&amp;co</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">m</span> <span class="nv">k</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">zero? </span><span class="nv">m</span><span class="p">)</span> <span class="p">(</span><span class="nf">k</span> <span class="ss">&#39;pizza</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">deep&amp;co</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">m</span><span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">k</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">x</span> <span class="o">&#39;</span><span class="p">()))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Examples of deep&amp;co</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">deep&amp;co</span> <span class="mi">0</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="nv">x</span><span class="p">))</span>          <span class="c1">; &#39;pizza</span>
</span><span class='line'><span class="p">(</span><span class="nf">deep&amp;co</span> <span class="mi">6</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="nv">x</span><span class="p">))</span>          <span class="c1">; &#39;((((((pizza))))))</span>
</span><span class='line'><span class="p">(</span><span class="nf">deep&amp;co</span> <span class="mi">2</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="nv">x</span><span class="p">))</span>          <span class="c1">; &#39;((pizza))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Deep&amp;coB</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">deep&amp;coB</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">m</span> <span class="nv">k</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">zero? </span><span class="nv">m</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="k">let </span><span class="p">()</span>
</span><span class='line'>         <span class="p">(</span><span class="k">set! </span><span class="nv">toppings</span> <span class="nv">k</span><span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">k</span> <span class="ss">&#39;pizza</span><span class="p">)))</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">deep&amp;coB</span> <span class="p">(</span><span class="nf">sub1</span> <span class="nv">m</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">k</span> <span class="p">(</span><span class="nb">cons </span><span class="nv">x</span> <span class="o">&#39;</span><span class="p">()))))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Examples of deep&amp;coB</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">deep&amp;coB</span> <span class="mi">6</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="nv">x</span><span class="p">))</span>         <span class="c1">; &#39;((((((pizza))))))</span>
</span><span class='line'><span class="p">(</span><span class="nf">deep&amp;coB</span> <span class="mi">4</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="nv">x</span><span class="p">))</span>         <span class="c1">; &#39;((((pizza))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; toppings is now four-layers</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">toppings</span> <span class="ss">&#39;cake</span><span class="p">)</span>                    <span class="c1">; &#39;((((cake))))</span>
</span><span class='line'><span class="p">(</span><span class="nf">cons</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">toppings</span> <span class="ss">&#39;cake</span><span class="p">)</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">toppings</span> <span class="ss">&#39;cake</span><span class="p">))</span>                 <span class="c1">; &#39;(((((cake)))) (((cake))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Remember two-in-a-row?</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">two-in-a-row?</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>    <span class="p">((</span><span class="nf">W</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span> <span class="nv">lat</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>            <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>              <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">nxt</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)))</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">or</span>
</span><span class='line'>                  <span class="p">(</span><span class="nb">eq? </span><span class="nv">nxt</span> <span class="nv">a</span><span class="p">)</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">W</span> <span class="nv">nxt</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lat</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>        <span class="p">((</span><span class="nb">null? </span><span class="nv">lat</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">W</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lat</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lat</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Examples of two-in-a-row?</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">two-in-a-row?</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">mozzarella</span> <span class="nv">cake</span> <span class="nv">mozzarella</span><span class="p">))</span>      <span class="c1">; #f</span>
</span><span class='line'><span class="p">(</span><span class="nf">two-in-a-row?</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">mozzarella</span> <span class="nv">mozzarella</span> <span class="nv">cake</span><span class="p">))</span>      <span class="c1">; #t</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; walk</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">leave</span> <span class="ss">&#39;0</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">walk</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">leave</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">begin</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">walk</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">walk</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; we need leave</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">start-it</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">call-with-current-continuation</span>
</span><span class='line'>      <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">here</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="k">set! </span><span class="nv">leave</span> <span class="nv">here</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">walk</span> <span class="nv">l</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Example of start-it</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">start-it</span> <span class="o">&#39;</span><span class="p">((</span><span class="nf">potato</span><span class="p">)</span> <span class="p">(</span><span class="nf">chips</span> <span class="p">(</span><span class="nf">chips</span> <span class="p">(</span><span class="nf">with</span><span class="p">)))</span> <span class="nv">fish</span><span class="p">))</span>  <span class="c1">; &#39;potato</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; waddle, just like walk but remembers where it left</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">fill</span> <span class="mi">0</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">waddle</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">begin</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">call-with-current-continuation</span>
</span><span class='line'>           <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">rest</span><span class="p">)</span>
</span><span class='line'>             <span class="p">(</span><span class="k">set! </span><span class="nv">fill</span> <span class="nv">rest</span><span class="p">)</span>
</span><span class='line'>             <span class="p">(</span><span class="nf">leave</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))))</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">waddle</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">begin</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">waddle</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">waddle</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; A new start</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">start-it2</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">call-with-current-continuation</span>
</span><span class='line'>      <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">here</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="k">set! </span><span class="nv">leave</span> <span class="nv">here</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">waddle</span> <span class="nv">l</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Example of start-it2</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">start-it2</span> <span class="o">&#39;</span><span class="p">((</span><span class="nf">donuts</span><span class="p">)</span> <span class="p">(</span><span class="nf">cheerios</span> <span class="p">(</span><span class="nf">cheerios</span> <span class="p">(</span><span class="nf">spaghettios</span><span class="p">)))</span> <span class="nv">donuts</span><span class="p">))</span>
</span><span class='line'><span class="c1">; ===&gt; &#39;donuts</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; get-next gets the next atom</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">get-next</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">call-with-current-continuation</span>
</span><span class='line'>      <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">here-again</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="k">set! </span><span class="nv">leave</span> <span class="nv">here-again</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">fill</span> <span class="ss">&#39;go</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Examples of get-next</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">get-next</span> <span class="ss">&#39;go</span><span class="p">)</span>      <span class="c1">; &#39;cheerios</span>
</span><span class='line'><span class="p">(</span><span class="nf">get-next</span> <span class="ss">&#39;go</span><span class="p">)</span>      <span class="c1">; &#39;cheerios</span>
</span><span class='line'><span class="p">(</span><span class="nf">get-next</span> <span class="ss">&#39;go</span><span class="p">)</span>      <span class="c1">; &#39;paghettios</span>
</span><span class='line'><span class="p">(</span><span class="nf">get-next</span> <span class="ss">&#39;go</span><span class="p">)</span>      <span class="c1">; &#39;donuts</span>
</span><span class='line'><span class="p">(</span><span class="nf">get-next</span> <span class="ss">&#39;go</span><span class="p">)</span>      <span class="c1">; &#39;()</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; get-first</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">get-first</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">call-with-current-continuation</span>
</span><span class='line'>      <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">here</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="k">set! </span><span class="nv">leave</span> <span class="nv">here</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">waddle</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">leave</span> <span class="o">&#39;</span><span class="p">())))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Examples of get-first and get-next</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">get-first</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">fish</span> <span class="p">(</span><span class="nf">chips</span><span class="p">)))</span>     <span class="c1">; &#39;fish</span>
</span><span class='line'><span class="p">(</span><span class="nf">get-next</span> <span class="ss">&#39;go</span><span class="p">)</span>                  <span class="c1">; &#39;chips</span>
</span><span class='line'><span class="p">(</span><span class="nf">get-next</span> <span class="ss">&#39;go</span><span class="p">)</span>                  <span class="c1">; &#39;()</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; And now the two-in-a-row*?</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">two-in-a-row*?</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">letrec</span>
</span><span class='line'>    <span class="p">((</span><span class="nf">T?</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">a</span><span class="p">)</span>
</span><span class='line'>           <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">n</span> <span class="p">(</span><span class="nf">get-next</span> <span class="mi">0</span><span class="p">)))</span>
</span><span class='line'>             <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">atom?</span> <span class="nv">n</span><span class="p">)</span>
</span><span class='line'>               <span class="p">(</span><span class="k">or </span><span class="p">(</span><span class="nb">eq? </span><span class="nv">n</span> <span class="nv">a</span><span class="p">)</span> <span class="p">(</span><span class="nf">T?</span> <span class="nv">n</span><span class="p">))</span>
</span><span class='line'>               <span class="no">#f</span><span class="p">))))</span>
</span><span class='line'>     <span class="p">(</span><span class="nf">get-next</span>
</span><span class='line'>       <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">call-with-current-continuation</span>
</span><span class='line'>           <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">here-again</span><span class="p">)</span>
</span><span class='line'>             <span class="p">(</span><span class="k">set! </span><span class="nv">leave</span> <span class="nv">here-again</span><span class="p">)</span>
</span><span class='line'>             <span class="p">(</span><span class="nf">fill</span> <span class="ss">&#39;go</span><span class="p">)))))</span>
</span><span class='line'>     <span class="p">(</span><span class="nf">fill</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="nv">x</span><span class="p">))</span>
</span><span class='line'>     <span class="p">(</span><span class="nf">waddle</span>
</span><span class='line'>       <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>           <span class="p">((</span><span class="nb">null? </span><span class="nv">l</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>           <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>            <span class="p">(</span><span class="k">begin </span>             <span class="c1">; or (let() ...</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">call-with-current-continuation</span>
</span><span class='line'>                <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">rest</span><span class="p">)</span>
</span><span class='line'>                  <span class="p">(</span><span class="k">set! </span><span class="nv">fill</span> <span class="nv">rest</span><span class="p">)</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">leave</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))))</span>
</span><span class='line'>              <span class="p">(</span><span class="nf">waddle</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">))))</span>
</span><span class='line'>           <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>             <span class="p">(</span><span class="nf">begin</span>
</span><span class='line'>               <span class="p">(</span><span class="nf">waddle</span> <span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">))</span>
</span><span class='line'>               <span class="p">(</span><span class="nf">waddle</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)))))))</span>
</span><span class='line'>     <span class="p">(</span><span class="nf">leave</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="nv">x</span><span class="p">)))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">fst</span> <span class="p">(</span><span class="nf">call-with-current-continuation</span>
</span><span class='line'>                   <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">here</span><span class="p">)</span>
</span><span class='line'>                     <span class="p">(</span><span class="k">set! </span><span class="nv">leave</span> <span class="nv">here</span><span class="p">)</span>
</span><span class='line'>                     <span class="p">(</span><span class="nf">waddle</span> <span class="nv">l</span><span class="p">)</span>
</span><span class='line'>                     <span class="p">(</span><span class="nf">leave</span> <span class="o">&#39;</span><span class="p">())))))</span>
</span><span class='line'>        <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">atom?</span> <span class="nv">fst</span><span class="p">)</span> <span class="p">(</span><span class="nf">T?</span> <span class="nv">fst</span><span class="p">)</span> <span class="no">#f</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">; Examples of two-in-a-row*?</span>
</span><span class='line'><span class="c1">;</span>
</span><span class='line'><span class="p">(</span><span class="nf">two-in-a-row*?</span> <span class="o">&#39;</span><span class="p">(((</span><span class="nf">food</span><span class="p">)</span> <span class="p">())</span> <span class="p">(((</span><span class="nf">food</span><span class="p">)))))</span>      <span class="c1">; #t</span>
</span><span class='line'><span class="p">(</span><span class="nf">two-in-a-row*?</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">a</span> <span class="p">(</span><span class="nf">b</span> <span class="p">(</span><span class="nf">c</span> <span class="p">(</span><span class="nf">d</span><span class="p">)))</span> <span class="p">()</span> <span class="p">()</span> <span class="p">(</span><span class="nf">d</span><span class="p">)))</span>     <span class="c1">; #t</span>
</span><span class='line'><span class="p">(</span><span class="nf">two-in-a-row*?</span> <span class="o">&#39;</span><span class="p">())</span>                            <span class="c1">; #f</span>
</span><span class='line'><span class="p">(</span><span class="nf">two-in-a-row*?</span> <span class="o">&#39;</span><span class="p">(((((</span><span class="nf">a</span><span class="p">))))))</span>                   <span class="c1">; #f</span>
</span></code></pre></td></tr></table></div></figure>


<p class='post-footer'>
                        原始地址:<a href='http://jueqingsizhe66.github.io/blog/2015/05/18/the-little-scheme-and-part-of-tss/'>http://jueqingsizhe66.github.io/blog/2015/05/18/the-little-scheme-and-part-of-tss/</a><br/>&nbsp;written by <a href='http://jueqingsizhe66.github.io'>Ye Zhaoliang</a>&nbsp;posted at <a href='http://jueqingsizhe66.github.io'>http://jueqingsizhe66.github.io</a></p>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Ye Zhaoliang</span></span>

      








  


<time datetime="2015-05-18T09:25:11+08:00" pubdate data-updated="true">May 18<span>th</span>, 2015</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/scheme/'>scheme</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2015/05/17/jia-fa-zhi-hou-ye-xu-jian-fa/" title="Previous Post: 加法之后也需减法">&laquo; 加法之后也需减法</a>
      
      
        <a class="basic-alignment right" href="/blog/2015/05/18/vim-haskell/" title="Next Post: vim-haskell">vim-haskell &raquo;</a>
      
    </p>
  </footer>
</article>



  <section>
    <h1>Comments</h1>
    <div id="comments" aria-live="polite"><div class="ds-thread" > </div>
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"f708708"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
<!-- 多说公共JS代码 end -->
</div>
  </section>


</div>

<aside class="sidebar">
  
    <section>
  <article role="article">  <!--不是他的原因-->
  <p><img class="alignleft" src="/images/xinran.jpg" style="Float:left;MARGIN-BOTTOM: 10px;MARGIN-RIGHT: 40px" weight="100" height="140" border="0" /> <!--不是他的原因-->
 <!--而是yellow的原因-->
 </br> 
    <h4> 叶昭良(Zhaoliang Ye) believe& 肖欣然(Xinran Xiao)</h4>
    <h5> Our Life </h5>
<hr style="color:#990000;border:1px dotted">
    QQ: <a href="977962857@qq.com">977962857@qq.com</a>
        <a href="36559660@qq.com">36559660@qq.com</a>

    </br>
    Weibo: <a href="zhaoturkkey@sina.com">zhaoturkkey@sina.com</a>

    <h5>Our Work</h5>

<hr style="color:#990000;border:1px dotted">
  <p>fortran程序员,Java程序员,HR,CFD</p>

<h5>Some books and links</h5>
<hr style="color:#990000;border:1px dotted">

<p>Scheme:</br>
  <a href="http://www.ccs.neu.edu/home/matthias/BTLS/"><font color="red">《the little scheme》(TLS)</font></a></br>
    <a href=" http://www.ccs.neu.edu/home/matthias/BTSS/">《The Season Scheme》(TSS)</a> </br>
    <a href="http://www.realmofracket.com/ ">《 Realm of Racket》</a> </br>
  <a href="http://scheme.com/tspl4/">《The Scheme Programming Language》(TSPL) </a> </br> 
  <a href=" http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-4.html#%_toc_start">《Structure and Interpretation of Computer Programs》(SICP)</a></br>
  <a href="http://community.schemewiki.org/?SICP-Solutions ">SICP Solution</a></br>
  <a href="https://github.com/DeathKing/Learning-SICP">Learning SICP</a></br>
  <a href="http://www.eopl3.com/ "><font color="red">《Essentials of Programming Language》(EOPL)</font></a></br>
  <a href="http://academic.udayton.edu/SaverioPerugini/courses/cps343/lecture_notes/ ">EOPL Course</a></br>

  <a href="http://www.ccs.neu.edu/home/matthias/HtDP2e/">How to Design programs(程序设计方法 SICP的简化版)</a></br>
  <a href="http://www.cs.berkeley.edu/~bh/ss-toc2.html"> Simply Scheme(中学级别)</a></br>
  <a href="http://songjinghe.github.io/TYS-zh-translation/"> Scheme语言简明教程(汉)</a></br>
  <a href="http://ds26gte.github.io/tyscheme/index.html"> Teach yourself Scheme in fixed days</a></br>
  <a href="http://vdisk.weibo.com/s/uutnsRMnFAbDA ">Scheme in programming(不错的入门书籍)</a></br>


</p>
<p> Lisp: </br>
  <a href=" http://www.landoflisp.com/">《Land of Lisp》</a></br>
  <a href="http://www.lisperati.com/casting.html">[Casting_spels] </a></br>
  <a href=" http://www.gigamonkeys.com/book/"> 《Practical CommonLisp》</a></br>
  <a href="http://www.paulgraham.com/acl.html">《ANSI_Common_lisp》 </a> </br>
  <a href="http://www.norvig.com/paip.html"> 《Paradigms of Artificial Intelligence Programming(PAIP)》</a></br>

</p>
<p> Clojure: </br>
  <a href="http://buhoz.net/public/books/lenguajes/clojure/Practical.Clojure.pdf">《Prcatical_clojure》</a></br>
  <a href=" http://www.joyofclojure.com/">《The joy of Clojure》</a>
  <a href="http://www.clojurebook.com/">《programming Clojure》 </a> </br>
  <a href="http://blog.csdn.net/zh2qiang/article/category/928066"> Programming clojure学习笔记 </a></br>
  <a href="http://xumingming.sinaapp.com/302/">Clojure入门教程: Clojure – Functional Programming for the JVM </a> </br>
  <a href="http://www.oschina.net/translate/the-clojure-philosophy?cmp">Clojure 哲学</a></br> 

</p></br>
<p> Haskell:</br>
  <a href="http://fleurer-lee.com/lyah/introduction.htm#%E5%85%B3%E4%BA%8E%E8%BF%99%E4%B8%AA%E6%95%99%E7%A8%8B ">Haskell趣味指南</a></br>
  <a href="https://www.haskell.org/">Hashell:An advanced purely-functional programming language </a></br>
  <a href="http://www.cs.nott.ac.uk/~gmh/book.html "> Programming in Haskell</a></br>
  <a href=" http://www.scs.stanford.edu/11au-cs240h/">Hashell Mit Course</a></br>

<p> Fortran:</br>
  <a href="http://www.personal.psu.edu/jhm/f90/lectures/quickref.html"> fortran90</a></br>
  <a href="http://people.sc.fsu.edu/~jburkardt/">John Burkardt</a> </br>
  <a href=" http://jblevins.org/mirror/amiller/#pzeros">Alan-Miller</a></br>
  <a href="http://micro.ustc.edu.cn/Fortran/">Fortran收集 </a></br>
  <a href="http://pan.baidu.com/s/1gdCN1T5"><font color="red">工程数值方法</font></a></br>
  <a href=" https://github.com/jueqingsizhe66/gtk-fortran">fortran-gtk</a></br>
  <a href="http://203.195.149.196/ldt9v/ebook/Modern_Fortran_Explained.pdf "> 《Modern Fortran Explained》(高级)</a></br>
  <a href="http://203.195.149.196/ldt9v/ebook/Fortran95_2003_Science_Project_SongYeZhi.zip ">《Fortran95~2003数值计算》(宋叶志)</a></br>
 
   
</p>

<p> Java:</br>
  <a href="http://a-little-java-a-few-patterns.readthedocs.org/zh_CN/latest/index.html"> A little Java (visitor pattern)</a></br>
  <a href="http://www.mkyong.com/"> Mkyong-java8</a></br>
  <a href="http://howtodoinjava.com/ "> how-to-do-in-java</a></br>
  <a href="http://stackoverflow.com/ "> StackOverflow问题堆栈 </a></br>
  <a href="http://www.blogjava.net/ ">BlogJava</a></br>
  <a href="http://www.importnew.com/ "> Java 新闻</a></br>
  <a href="http://ifeve.com/category/java/ "> 并发编程网</a></br>
  <a href="http://www.iteye.com/blogs ">IT 视角 </a></br>
  <a href="http://www.iteye.com/forums/tag_good/Java%E7%BB%BC%E5%90%88 ">IT 视角之java综合(SSH) </a></br>
  <a href="http://rednaxelafx.iteye.com/category/22617 ">IT 视角之rednaxelafx </a></br>
  <a href="http://droidyue.com/ ">技术小黑屋 </a></br>
  <a href="https://mouxuejie.com/ "> 某学姐 </a></br>
  <a href="http://gudong.name/ "> 咕咚-handler  </a></br>
  <a href="http://www.superqq.com/ "> ios-自媒体  </a></br>
  <a href="http://blog.csdn.net/jackfrued/ "><font color="red"> CSDN-骆昊的技术专栏</font> </a></br>
  <a href="http://www.adrop.me/cat/tech/java/ "> Adrop 自留地</a></br>
  <a href="http://www.programcreek.com/ "> Programcreek</a></br>
  <a href="http://java-performance.info/ "> Java-Performance(JP)</a></br>
  <a href="http://www.ibm.com/developerworks/cn/java/ "> IBM Java开发者社区</a></br>
  <a href="http://shipilev.net/ "> Aleksey Shipilëv: One Stop Page </a></br>
  <a href="http://www.pandablog.cn/?cat=9 "> 熊猫大仙</a></br>
  <a href="http://www.pixelstech.net/article.php?type=all "> pixelstech</a></br>
  <a href="http://timyang.net/ "> 后端技术-java</a></br>
  <a href="http://www.adam-bien.com/roller/abien/ "> abian德国Javaee</a></br>
  <a href="https://javax0.wordpress.com/ "> Java纯粹(匈牙利) </a></br>
  <a href="https://antoniogoncalves.org/ ">JAVAEE协议作者 (法国)-图文并茂 </a></br>
  <a href="http://www.importnew.com/7469.html "> 100个小链接 </a></br>

</p>

<p> Java github repos: </br>
  <a href="https://github.com/akullpp/awesome-java "> awesome-java一些常用的库链接</a></br>
  <a href="https://github.com/codefollower/My-Blog ">  codefollowers</a></br>
  </p>

<p> JAVA API: </br>
   <a href="https://docs.oracle.com/javaee/7/api/  "> JAVAEE 7 API</a></br>
  <a href="https://docs.oracle.com/javase/8/docs/api/index.html  ">  JAVASE 8 API</a></br>
  <a href="https://struts.apache.org/maven/struts2-core/apidocs/index.html "> <font color="red">Struts2core 2.5</font> </a></br>
  <a href="http://docs.jboss.org/hibernate/search/5.6/api/ "> <font color="red">Hibernate5.6 </font></a></br>
  <a href="http://spring.io/docs/reference "><font color="red">Spring系列文档</font> </a></br>
  <a href="http://docs.spring.io/spring/docs/4.3.0.RC1/javadoc-api/ "><font color="red">Spring Framework</font> </a></br>

</p>

<p> Bash:</br>
  <a href="http://vbird.dic.ksu.edu.tw/linux_basic/0320bash.php ">鸟哥的私房菜</a></br>
  <a href=" http://www.thegeekstuff.com/bash-101-hacks-ebook/">Bash 101 Hacks</a></br>

  <p>English: </br>
    <a href="http://book.douban.com/subject/1014914/"> 《英语魔法俱乐部》</a>一本相当不错的英语语法书。
    <a href="http://vdisk.weibo.com/search/?type=public&keyword=%E9%A3%8E%E6%A0%BC%E7%9A%84%E8%A6%81%E7%B4%A0">风格的要素(Element of Style)</a> 英语写作的圣经</br>
    <a href="http://www.geraldmweinberg.com/Site/On_Writing.html">WeinBerg On Writing:The fieldstone method </a> 收集WeinBerg Stones</br>
 
  </p>
  <p> 流体力学：</br>
  <a href="http://vdisk.weibo.com/s/uuCAVsYacltnf">计算流体力学入门(安德森)</a></br>
  <a href="http://vdisk.weibo.com/search/?type=public&keyword=%E7%A9%BA%E6%B0%94%E5%8A%A8%E5%8A%9B%E5%AD%A6%E5%9F%BA%E7%A1%80"><font color="red">空气动力学基础(安德森)</font> </a></br>
  <a href="http://vdisk.weibo.com/s/dgA_ls6t1ywY5 ">计算流体力学与传热学(陶文铨)</a></br>
  <a href="http://dyfluid.com/ ">东岳流体</a></br>
  <a href="http://blog.sina.com.cn/openfoamresearch "> 苏军伟-sina</a></br>


  </p>

  <p> 数学:</br>
    <a href="http://ocw.mit.edu/faculty/gilbert-strang/">Gilbert Strang Professor 微积分，线性代数，微分方程</a> </br> 
    <a href="http://math.mit.edu/~rbm/ "> Richard Melrose 泛函分析</a></br> 
    <a href="http://homepage.ntlworld.com/ivan.wilde/notes/ ">Dr Ivan F Wilde 复分析</a></br>
  </p>
  <p> Machine Learning:(降维和优化) Support Vector Machine</br>
    <a href="http://blog.csdn.net/v_july_v/article/details/7624837"><font color="red">July SVM三层境界</font></a> </br> 
    <a href="http://vdisk.weibo.com/u/1580904460 ">July Vdisk</a> </br> 
    <a href="http://www.blogjava.net/zhenandaci/archive/2009/03/15/259786.html "> Jason Java Jacal</a></br> 
    <a href="http://www.csie.ntu.edu.tw/~cjlin/libsvm/ ">LibSvm: </a></br>
    <a href="http://www.svms.org/vc-dimension/ ">Vc-dimension</a></br>
    <a href="http://www.autonlab.org/tutorials/svm15.pdf ">内基梅隆大学carnegie mellon university(CMU) Svm Tutorials</a></br>
    <a href="http://120.52.72.51/www.cmlab.csie.ntu.edu.tw/c3pr90ntcsf0/~cyy/learning/tutorials/SVR.pdf ">SVR :回归分析</a></br>

    <a href="http://blog.csdn.net/zhzhl202/article/details/8197109 ">文本分类和SVM</a></br>
    <a href="http://www.cnblogs.com/jerrylead/tag/Machine%20Learning/ ">斯坦福机器课程学习笔记</a></br>
    <a href="http://www.cnblogs.com/jerrylead/archive/2012/05/08/2489725.html ">斯坦福大学的原始讲义</a></br>
    <a href="http://www.mit.edu/~9.520/spring11/slides/class06-svm.pdf ">MIT SVM讲义</a></br>
    <a href="http://icml2008.cs.helsinki.fi/papers/266.pdf ">SVM优化</a></br>
    <a href="http://blog.csdn.net/qll125596718/article/details/8248249 ">最小二乘法及其实现</a></br>
    <a href="http://vdisk.weibo.com/s/s-XOVNRQc_reY ">《数理统计学简史》陈希孺院士著  </a></br>
    <a href="http://vdisk.weibo.com/s/BZndAHHdASslv ">《最优化理论与算法》(第2版)－陈宝林 </a></br>
    <a href="http://www.52nlp.cn/tag/%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F ">正态分布的前世今生</a></br>

  </p>
  <p>Climing and Take a tourist</p>
    <h5>Contact Us</h5>
<hr style="color:#990000;border:1px dotted">
    Email:<a href="zhaoturkkey@163.com">zhaoturkkey@163.com</a></br>
         <a href="36559660@qq.com">36559660@qq.com</a>

  </article>
  <p><img src="/images/wood.jpg"  alt="zhaoturkkey@gmail.com" /></p></section>
</section>

<section>
  <h1>分类目录</h1>
  <ul id="categories">
    <li class='category'><a href='/blog/categories/fast/'>Fast (3)</a></li>
<li class='category'><a href='/blog/categories/html/'>HTML (1)</a></li>
<li class='category'><a href='/blog/categories/haskell/'>Haskell (21)</a></li>
<li class='category'><a href='/blog/categories/jsdom/'>JSDom (3)</a></li>
<li class='category'><a href='/blog/categories/javabasic/'>JavaBasic (22)</a></li>
<li class='category'><a href='/blog/categories/javascript/'>JavaScript (3)</a></li>
<li class='category'><a href='/blog/categories/linux/'>Linux (20)</a></li>
<li class='category'><a href='/blog/categories/lisp/'>Lisp (1)</a></li>
<li class='category'><a href='/blog/categories/mysql/'>Mysql (2)</a></li>
<li class='category'><a href='/blog/categories/tecplot/'>Tecplot (1)</a></li>
<li class='category'><a href='/blog/categories/error/'>error (1)</a></li>
<li class='category'><a href='/blog/categories/fortran/'>fortran (3)</a></li>
<li class='category'><a href='/blog/categories/git/'>git (3)</a></li>
<li class='category'><a href='/blog/categories/gnuplot/'>gnuplot (1)</a></li>
<li class='category'><a href='/blog/categories/graphviz/'>graphviz (1)</a></li>
<li class='category'><a href='/blog/categories/humor/'>humor (1)</a></li>
<li class='category'><a href='/blog/categories/incompact3d/'>incompact3d (4)</a></li>
<li class='category'><a href='/blog/categories/jquery/'>jQuery (2)</a></li>
<li class='category'><a href='/blog/categories/life/'>life (18)</a></li>
<li class='category'><a href='/blog/categories/makefile/'>makefile (2)</a></li>
<li class='category'><a href='/blog/categories/markdown/'>markdown (4)</a></li>
<li class='category'><a href='/blog/categories/matlab/'>matlab (2)</a></li>
<li class='category'><a href='/blog/categories/openfoam/'>openfoam (1)</a></li>
<li class='category'><a href='/blog/categories/physics/'>physics (1)</a></li>
<li class='category'><a href='/blog/categories/prolog/'>prolog (4)</a></li>
<li class='category'><a href='/blog/categories/python/'>python (1)</a></li>
<li class='category'><a href='/blog/categories/scheme/'>scheme (35)</a></li>
<li class='category'><a href='/blog/categories/vim/'>vim (2)</a></li>
<li class='category'><a href='/blog/categories/xml/'>xml (1)</a></li>

  </ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2016/10/09/a-little-java-note/">A Little Java Note</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/09/29/physics-and-maths/">Physics and Maths</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/09/28/jump-out-of-ontology/">Jump Out of Ontology</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/09/28/machine-learning-some-search-record/">Machine Learning Some Search Record</a>
      </li>
    
      <li class="post">
        <a href="/blog/2016/09/28/graphviz-notebook/">Graphviz Notebook</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/jueqingsizhe66">@jueqingsizhe66</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'jueqingsizhe66',
            count: 2,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>



<section class="googleplus googleplus-hidden">
  <h1>
    <a href="https://plus.google.com/zhaoturkkey@gmail.com?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>


<section>
<h1>Zhao's Douban</h1>
<div>
 <script type="text/javascript" src="http://www.douban.com/service/badge/50717256/?selection=latest&amp;picsize=small&amp;hideself=on&amp;show=collection&amp;n=8&amp;cat=drama%7Cmovie%7Cbook%7Cmusic&amp;columns=2"></script>
</div>
</section>
<section>
<h1>Recent Comments</h1>
<ul class="ds-recent-comments" data-num-items="10" data-show-avatars="0" data-show-time="1" data-show-title="0" data-show-admin="0" data-excerpt-length="18"></ul>

</section>
<section>
  <h1>盟友</h1>
  <ul>
    <li><a href="http://www.cfd-online.com/">CFD1</a></li>
    <li><a href="https://nwtc.nrel.gov/">NREL-NWTC </a></li>
    <li>
      <a href="http://mindhacks.cn/">刘未鹏MIND HACKS</a>
    </li>
    <li>
      <a href="http://www.cnblogs.com/Solstice/">陈硕</a>
    </li>
    <li>
      <a href="http://tianchunbinghe.blog.163.com/">冰河-网易</a></br>
      <a href="http://weibo.com/tianchunbinghe?from=myfollow_all&is_all=1#_rnd1455615502647">冰河-新浪</a>
    </li>
    <li>
      <a href="http://yinwang.org/">王垠</a></br>
      <a href="http://www.jianshu.com/users/b1dd2b2c87a8/latest_articles">王垠-简书</a>
    </li>
    <li>
      <a href="http://www.huzheng.org/ ">胡正</a>
      </li>
    <li>
      <a href="http://xahlee.org/ ">李杀</a>
      </li>
    <li>
      <a href="http://www.is.pku.edu.cn/~qzy/ "> 裘宗燕</a>
      </li>
    <li>
      <a href=" http://blog.csdn.net/v_july_v"> July</a>
      </li>
    <li>
      <a href="http://deathking.github.io/ "> deathKing: Learning-in-SICP</a>
      </li>



    <li>
      <a href=" https://en.wikipedia.org/wiki/Scheme_%28programming_language%29"> scheme wikipedia(history of scheme)</a>
    </li>
    <li>
      <a href="https://inst.eecs.berkeley.edu/~cs61a/fa14/proj/scheme/ ">CS61a:a scheme interpreter </a>
      <a href="https://github.com/dhrushilbadani/Scheme "> interpreter with python implementation </a>
    </li>
    <li>
      <a href="https://cgi.soic.indiana.edu/~c311/doku.php "> C311/B521/B621 </a>
    </li>
    <li>
      <a href="http://minikanren.org/ "> MiniKanren</a>
    </li>
    <li>
      <a href=" http://lambda-the-ultimate.org/"> Lambda the ultimate</a>
    </li>
    <li>
      <a href="http://people.csail.mit.edu/jaffer/SLIB "> The SLIB Portable Scheme library</a>
    </li>

    <li>
      <a href="http://v.qq.com/cover/p/pd51cjco90d1rc1.html?vid=o0015dvd155 "> 北平无战事43:承受</a>
    </li>


  </ul>
</section>
<section>
<h1>My website link<abbr title="The word 'QR Code' is a registered trademark of DENSO WAVE INCORPORATED. It applies only for the word 'QR Code', not for image.">&trade;</abbr></h1>
<a href="http://jueqingsizhe66.github.io/blog/2015/05/18/the-little-scheme-and-part-of-tss/"><img src="http://chart.apis.google.com/chart?chs=150x150&cht=qr&chld=|0&chco=165B94&chl=http://jueqingsizhe66.github.io/blog/2015/05/18/the-little-scheme-and-part-of-tss/" alt="post-qrcode"></a></section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2017 - Ye Zhaoliang -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>







</body>
</html>
