
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>It's a Dead program.How to Let It Alive? - 网络书屋(Web Reading Room)</title>
  <meta name="author" content="Ye Zhaoliang">

  
  <meta name="description" content="All programs are data.
All intepreters are program.
All Handware and software,or type checkers etc are interpreter. I think data conceives the soul, &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://jueqingsizhe66.github.io/blog/2016/02/09/its-a-dead-program-dot-how-to-let-it-alive">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="网络书屋(Web Reading Room)" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">网络书屋(Web Reading Room)</a></h1>
  
    <h2>A blogging framework for hackers.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss email">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
    <li><a href="zhaoturkey@163.com" rel="subscribe-email" title="subscribe via email">Email</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:jueqingsizhe66.github.io" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">It's a Dead program.How to Let It Alive?</h1>
    
    
      <p class="meta">
        








  


<time datetime="2016-02-09T23:20:18+08:00" pubdate data-updated="true">Feb 9<span>th</span>, 2016</time>
        

         
          | <a href="#comments">Comments</a>
         
      </p>
    
  </header>


<div class="entry-content"><p>All programs are data.
All intepreters are program.
All Handware and software,or type checkers etc are interpreter.</p>

<p>I think data conceives the soul,not only the fixed process,but changing vari-language.</p>

<!--more-->


<ul>
<li><a href="#1">1.The Little Scheme interpreter</a></li>
<li><a href="#2">2.The Season Scheme interpreter</a></li>
<li><a href="#3">3.The CPS control struture</a>

<ul>
<li><a href="#3.1">3.1 how to add arguments?</a></li>
<li><a href="#3.2">3.2 what is the small stuff?</a></li>
</ul>
</li>
<li><a href="#4">4. how to evaluate or interpreter  a procedre?</a>

<ul>
<li><a href="#4.1">4.1 ordinary tracing</a></li>
<li><a href="#4.2">4.2 cps tracing</a></li>
</ul>
</li>
<li><a href="#5">5. It is not the end</a></li>
</ul>


<h2 id="1">The Little Scheme</h2>


<p>Here below is the interpreter from TLS</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
<span class='line-number'>180</span>
<span class='line-number'>181</span>
<span class='line-number'>182</span>
<span class='line-number'>183</span>
<span class='line-number'>184</span>
<span class='line-number'>185</span>
<span class='line-number'>186</span>
<span class='line-number'>187</span>
<span class='line-number'>188</span>
<span class='line-number'>189</span>
<span class='line-number'>190</span>
<span class='line-number'>191</span>
<span class='line-number'>192</span>
<span class='line-number'>193</span>
<span class='line-number'>194</span>
<span class='line-number'>195</span>
<span class='line-number'>196</span>
<span class='line-number'>197</span>
<span class='line-number'>198</span>
<span class='line-number'>199</span>
<span class='line-number'>200</span>
<span class='line-number'>201</span>
<span class='line-number'>202</span>
<span class='line-number'>203</span>
<span class='line-number'>204</span>
<span class='line-number'>205</span>
<span class='line-number'>206</span>
<span class='line-number'>207</span>
<span class='line-number'>208</span>
<span class='line-number'>209</span>
<span class='line-number'>210</span>
<span class='line-number'>211</span>
<span class='line-number'>212</span>
<span class='line-number'>213</span>
<span class='line-number'>214</span>
<span class='line-number'>215</span>
<span class='line-number'>216</span>
<span class='line-number'>217</span>
<span class='line-number'>218</span>
<span class='line-number'>219</span>
<span class='line-number'>220</span>
<span class='line-number'>221</span>
<span class='line-number'>222</span>
<span class='line-number'>223</span>
<span class='line-number'>224</span>
<span class='line-number'>225</span>
<span class='line-number'>226</span>
<span class='line-number'>227</span>
<span class='line-number'>228</span>
<span class='line-number'>229</span>
<span class='line-number'>230</span>
<span class='line-number'>231</span>
<span class='line-number'>232</span>
<span class='line-number'>233</span>
<span class='line-number'>234</span>
<span class='line-number'>235</span>
<span class='line-number'>236</span>
<span class='line-number'>237</span>
<span class='line-number'>238</span>
<span class='line-number'>239</span>
<span class='line-number'>240</span>
<span class='line-number'>241</span>
<span class='line-number'>242</span>
<span class='line-number'>243</span>
<span class='line-number'>244</span>
<span class='line-number'>245</span>
<span class='line-number'>246</span>
<span class='line-number'>247</span>
<span class='line-number'>248</span>
<span class='line-number'>249</span>
<span class='line-number'>250</span>
</pre></td><td class='code'><pre><code class='scheme'><span class='line'><span class="o">#</span><span class="nv">lang</span> <span class="nv">racket</span>
</span><span class='line'><span class="c1">;;简单环境配置</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">atom?</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">pair? </span><span class="nv">x</span><span class="p">))</span> <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">null? </span><span class="nv">x</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="c1">;第一大部分 定义好整体框架</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">value</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">e</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">meaning</span> <span class="nv">e</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">meaning</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">e</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>      <span class="p">((</span><span class="nf">expression-to-action</span> <span class="nv">e</span><span class="p">)</span> <span class="nv">e</span> <span class="nv">table</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">;;第二大部分 解析atom and list action</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">expression-to-action</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">e</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>       <span class="p">((</span><span class="nf">atom?</span> <span class="nv">e</span><span class="p">)</span> <span class="p">(</span><span class="nf">atom-to-action</span> <span class="nv">e</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">list-to-action</span> <span class="nv">e</span><span class="p">)))))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">atom-to-action</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">e</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">number? </span><span class="nv">e</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="no">#t</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="no">#f</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="p">(</span><span class="k">quote </span><span class="nv">cons</span><span class="p">))</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="p">(</span><span class="k">quote </span><span class="nv">car</span><span class="p">))</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="p">(</span><span class="k">quote </span><span class="nv">cdr</span><span class="p">))</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="p">(</span><span class="k">quote </span><span class="nv">null?</span><span class="p">))</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="p">(</span><span class="k">quote </span><span class="nv">eq?</span><span class="p">))</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="p">(</span><span class="k">quote </span><span class="nv">atom?</span><span class="p">))</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="p">(</span><span class="k">quote </span><span class="nv">zero?</span><span class="p">))</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="p">(</span><span class="k">quote </span><span class="nv">add1</span><span class="p">))</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="p">(</span><span class="k">quote </span><span class="nv">sub1</span><span class="p">))</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="p">(</span><span class="k">quote </span><span class="nv">number?</span><span class="p">))</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="k">else </span><span class="nv">*identifier</span><span class="p">))))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">list-to-action</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">e</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>       <span class="p">((</span><span class="nf">atom?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">e</span><span class="p">))</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>         <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">e</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="nv">quote</span><span class="p">))</span>
</span><span class='line'>          <span class="nv">*quote</span><span class="p">)</span>
</span><span class='line'>         <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">e</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="nv">lambda</span><span class="p">))</span>
</span><span class='line'>          <span class="nv">*lambda</span><span class="p">)</span>
</span><span class='line'>         <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">e</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="nv">cond</span><span class="p">))</span>
</span><span class='line'>          <span class="nv">*cond</span><span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="k">else </span><span class="nv">*application</span><span class="p">)))</span>
</span><span class='line'>       <span class="p">(</span><span class="k">else </span><span class="nv">*application</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">;; 第三大部分 定义 6星==5个special forms 和一个general forms（*application)</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">;;;环境额外配置 这些配置仅仅是为了增加可读性 无任何编程技巧</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">first</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">p</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>       <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">car </span><span class="nv">p</span><span class="p">)))))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">second</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">p</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>       <span class="p">(</span><span class="k">else </span><span class="nv">car</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">p</span><span class="p">)))))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">third</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">p</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>       <span class="p">(</span><span class="k">else </span><span class="nv">car</span> <span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">p</span><span class="p">))))))</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">text-of</span> <span class="nv">second</span><span class="p">)</span>
</span><span class='line'>    <span class="c1">;; *identifier</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">table-of</span> <span class="nv">first</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">formals-of</span> <span class="nv">second</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">body-of</span> <span class="nv">third</span><span class="p">)</span>
</span><span class='line'>    <span class="c1">;;*cond</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">question-of</span> <span class="nv">first</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">answer-of</span> <span class="nv">second</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">cond-lines-of</span> <span class="nv">cdr</span><span class="p">)</span>
</span><span class='line'>    <span class="c1">;;*application</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">function-of</span> <span class="nv">car</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">arguments-of</span> <span class="nv">cdr</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">build</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">s1</span> <span class="nv">s2</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>       <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="nv">s1</span>
</span><span class='line'>              <span class="p">(</span><span class="nb">cons </span><span class="nv">s2</span> <span class="p">(</span><span class="k">quote </span><span class="p">())))))))</span>
</span><span class='line'>    <span class="c1">;;1st star</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">*const</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">e</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">number? </span><span class="nv">e</span><span class="p">)</span> <span class="nv">e</span><span class="p">)</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="no">#t</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="no">#f</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">build</span> <span class="p">(</span><span class="k">quote </span><span class="nv">primitive</span><span class="p">)</span> <span class="nv">e</span><span class="p">)))))</span>
</span><span class='line'>    <span class="c1">;;2nd star</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">*quote</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">e</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">text-of</span> <span class="nv">e</span><span class="p">)))</span>
</span><span class='line'>    <span class="c1">;;3rd star</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">*lambda</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">e</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">build</span> <span class="p">(</span><span class="k">quote </span><span class="nv">non-primitive</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">cons </span><span class="nv">table</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">e</span><span class="p">)))))</span>
</span><span class='line'>    <span class="c1">;;4th star</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">*identifier</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">e</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">lookup-in-table</span> <span class="nv">e</span> <span class="nv">table</span> <span class="nv">initial-table</span><span class="p">)))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">initial-table</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">name</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="k">quote </span><span class="p">()))))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">lookup-in-table</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">name</span> <span class="nv">table</span> <span class="nv">table-f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">null? </span><span class="nv">table</span><span class="p">)</span> <span class="p">(</span><span class="nf">table-f</span> <span class="nv">name</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">lookup-in-entry</span> <span class="nv">name</span>
</span><span class='line'>              <span class="p">(</span><span class="nb">car </span><span class="nv">table</span><span class="p">)</span>
</span><span class='line'>              <span class="c1">; (lambda (name)</span>
</span><span class='line'>                  <span class="c1">; (cdr table)</span>
</span><span class='line'>                  <span class="c1">; (table-f)))))))</span>
</span><span class='line'><span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">name</span><span class="p">)</span>
</span><span class='line'> <span class="p">(</span><span class="nf">lookup-in-table</span> <span class="nv">name</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">cdr </span><span class="nv">table</span><span class="p">)</span>
</span><span class='line'>  <span class="nv">table-f</span><span class="p">)))))))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">lookup-in-entry</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">name</span> <span class="nv">entry</span> <span class="nv">entry-f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">lookup-in-entry-help</span> <span class="nv">name</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">first</span> <span class="nv">entry</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">second</span> <span class="nv">entry</span><span class="p">)</span>
</span><span class='line'>       <span class="nv">entry-f</span><span class="p">)))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">lookup-in-entry-help</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">name</span> <span class="nv">names</span> <span class="nv">values</span> <span class="nv">entry-f</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">null? </span><span class="nv">names</span><span class="p">)</span> <span class="p">(</span><span class="nf">entry-f</span> <span class="nv">name</span><span class="p">))</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">names</span><span class="p">)</span> <span class="nv">name</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="nb">car </span><span class="nv">values</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">lookup-in-entry-help</span> <span class="nv">name</span>
</span><span class='line'>              <span class="p">(</span><span class="nb">cdr </span><span class="nv">names</span><span class="p">)</span>
</span><span class='line'>              <span class="p">(</span><span class="nb">cdr </span><span class="nv">values</span><span class="p">)</span>
</span><span class='line'>              <span class="nv">entry-f</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">;; 5th star</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">*cond</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">e</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">evcon</span> <span class="p">(</span><span class="nf">cond-lines-of</span> <span class="nv">e</span><span class="p">)</span> <span class="nv">table</span><span class="p">)))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">evcon</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">lines</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>       <span class="p">((</span><span class="nf">else?</span> <span class="p">(</span><span class="nf">question-of</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lines</span><span class="p">)))</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">meaning</span> <span class="p">(</span><span class="nf">answer-of</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lines</span><span class="p">))</span>
</span><span class='line'>         <span class="nv">table</span><span class="p">))</span>
</span><span class='line'>       <span class="p">((</span><span class="nf">meaning</span> <span class="p">(</span><span class="nf">question-of</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lines</span><span class="p">))</span>
</span><span class='line'>         <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">meaning</span> <span class="p">(</span><span class="nf">answer-of</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lines</span><span class="p">))</span>
</span><span class='line'>         <span class="nv">table</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">evcon</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lines</span><span class="p">)</span> <span class="nv">table</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">else?</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>       <span class="p">((</span><span class="nf">atom?</span> <span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">eq? </span><span class="nv">x</span> <span class="p">(</span><span class="k">quote </span><span class="nv">else</span><span class="p">)))</span>
</span><span class='line'>       <span class="p">(</span><span class="k">else </span><span class="no">#f</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="c1">;;6th star 你需要解析arguments的各个部分这是evlis的工作</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">*application</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">e</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">apply</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">meaning</span> <span class="p">(</span><span class="nf">function-of</span> <span class="nv">e</span><span class="p">)</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">evlis</span> <span class="p">(</span><span class="nf">arguments-of</span> <span class="nv">e</span><span class="p">)</span> <span class="nv">table</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">evlis</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">args</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">null? </span><span class="nv">args</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="p">()))</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">meaning</span> <span class="p">(</span><span class="nb">car </span><span class="nv">args</span><span class="p">)</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">evlis</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">args</span><span class="p">)</span> <span class="nv">table</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="c1">;;第四大部分 进行 apply的定义 反向运用primitive和non-primitive 去除核心的primitive和non-primitive前缀，并升级环境</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">apply</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">fun</span> <span class="nv">vals</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>       <span class="p">((</span><span class="nf">primitive?</span> <span class="nv">fun</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">apply-primitive</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">second</span> <span class="nv">fun</span><span class="p">)</span> <span class="nv">vals</span><span class="p">))</span>
</span><span class='line'>       <span class="p">((</span><span class="nf">non-primitive?</span> <span class="nv">fun</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">apply-closure</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">second</span> <span class="nv">fun</span><span class="p">)</span> <span class="nv">vals</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">primitive?</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nb">eq? </span><span class="p">(</span><span class="nf">first</span> <span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="nv">primitive</span><span class="p">))))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">non-primitive?</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nb">eq? </span><span class="p">(</span><span class="nf">first</span> <span class="nv">l</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="nv">non-primitive</span><span class="p">))))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">apply-primitive</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">name</span> <span class="nv">vals</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">eq? </span><span class="nv">name</span> <span class="p">(</span><span class="k">quote </span><span class="nv">cons</span><span class="p">))</span>
</span><span class='line'>        <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">)</span> <span class="p">(</span><span class="nf">second</span> <span class="nv">vals</span><span class="p">)))</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">eq? </span><span class="nv">name</span> <span class="p">(</span><span class="k">quote </span><span class="nv">car</span><span class="p">))</span>
</span><span class='line'>        <span class="p">(</span><span class="nb">car </span><span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">)))</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">eq? </span><span class="nv">name</span> <span class="p">(</span><span class="k">quote </span><span class="nv">cdr</span><span class="p">))</span>
</span><span class='line'>        <span class="p">((</span><span class="nb">eq? </span><span class="nv">name</span> <span class="p">(</span><span class="k">quote </span><span class="nv">cdr</span><span class="p">))</span>
</span><span class='line'>         <span class="p">(</span><span class="nb">cdr </span><span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">)))</span>
</span><span class='line'>        <span class="p">((</span><span class="nb">eq? </span><span class="nv">name</span> <span class="p">(</span><span class="k">quote </span><span class="nv">null?</span><span class="p">))</span>
</span><span class='line'>         <span class="p">(</span><span class="nb">null? </span><span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">)))</span>
</span><span class='line'>        <span class="p">((</span><span class="nb">eq? </span><span class="nv">name</span> <span class="p">(</span><span class="k">quote </span><span class="nv">eq?</span><span class="p">))</span>
</span><span class='line'>         <span class="p">(</span><span class="nb">eq? </span><span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">)</span> <span class="p">(</span><span class="nf">second</span> <span class="nv">vals</span><span class="p">)))</span>
</span><span class='line'>        <span class="p">((</span><span class="nb">eq? </span><span class="nv">name</span> <span class="p">(</span><span class="k">quote </span><span class="nv">atom?</span><span class="p">))</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">:atom?</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">)))</span>
</span><span class='line'>        <span class="p">((</span><span class="nb">eq? </span><span class="nv">name</span> <span class="p">(</span><span class="k">quote </span><span class="nv">zero?</span><span class="p">))</span>
</span><span class='line'>         <span class="p">(</span><span class="nb">zero? </span><span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">)))</span>
</span><span class='line'>        <span class="p">((</span><span class="nb">eq? </span><span class="nv">name</span> <span class="p">(</span><span class="k">quote </span><span class="nv">add1</span><span class="p">))</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">add1</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">)))</span>
</span><span class='line'>        <span class="p">((</span><span class="nb">eq? </span><span class="nv">name</span> <span class="p">(</span><span class="k">quote </span><span class="nv">sub1</span><span class="p">))</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">sub1</span> <span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">)))</span>
</span><span class='line'>        <span class="p">((</span><span class="nb">eq? </span><span class="nv">name</span> <span class="p">(</span><span class="k">quote </span><span class="nv">number?</span><span class="p">))</span>
</span><span class='line'>         <span class="p">(</span><span class="nb">number? </span><span class="p">(</span><span class="nf">first</span> <span class="nv">vals</span><span class="p">)))))))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">:atom?</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>       <span class="p">((</span><span class="nf">atom?</span> <span class="nv">x</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">null? </span><span class="nv">x</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="nv">primitive</span><span class="p">))</span>
</span><span class='line'><span class="no">#t</span><span class="p">)</span>
</span><span class='line'>       <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">x</span><span class="p">)</span> <span class="p">(</span><span class="k">quote </span><span class="nv">non-primitive</span><span class="p">))</span>
</span><span class='line'><span class="no">#t</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="k">else </span><span class="no">#f</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">;;closure=table+arguments+body ;;arguments 通过formals-of获取 body-of获取body</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">apply-closure</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">closure</span> <span class="nv">vals</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">meaning</span> <span class="p">(</span><span class="nf">body-of</span> <span class="nv">closure</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">extend-table</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">new-entry</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">formals-of</span> <span class="nv">closure</span><span class="p">)</span>
</span><span class='line'>         <span class="nv">vals</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">table-of</span> <span class="nv">closure</span><span class="p">)))))</span>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="nv">new-entry</span> <span class="nv">build</span><span class="p">)</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">extend-table</span> <span class="nv">cons</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>    <span class="c1">;;测试这个解释器</span>
</span><span class='line'>    <span class="c1">;(value (cons (* (+ 1 3) 4) &#39;hello)) ;;不通过</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">2</span> <span class="mi">4</span><span class="p">))</span>
</span><span class='line'><span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">* </span><span class="mi">15</span> <span class="p">(</span><span class="nb">+ </span><span class="mi">2</span> <span class="mi">4</span><span class="p">)))</span>
</span><span class='line'>    <span class="c1">;;(value (cons (quote (* (+ 1 3) 4)) (cons &#39;h &#39;()))) ;;测试不通过</span>
</span></code></pre></td></tr></table></div></figure>




<h2 id="2"> The Season scheme</h2>


<p>Here below is the interpreter from TLS</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
<span class='line-number'>173</span>
<span class='line-number'>174</span>
<span class='line-number'>175</span>
<span class='line-number'>176</span>
<span class='line-number'>177</span>
<span class='line-number'>178</span>
<span class='line-number'>179</span>
<span class='line-number'>180</span>
<span class='line-number'>181</span>
<span class='line-number'>182</span>
<span class='line-number'>183</span>
<span class='line-number'>184</span>
<span class='line-number'>185</span>
<span class='line-number'>186</span>
<span class='line-number'>187</span>
<span class='line-number'>188</span>
<span class='line-number'>189</span>
<span class='line-number'>190</span>
<span class='line-number'>191</span>
<span class='line-number'>192</span>
<span class='line-number'>193</span>
<span class='line-number'>194</span>
<span class='line-number'>195</span>
<span class='line-number'>196</span>
<span class='line-number'>197</span>
<span class='line-number'>198</span>
<span class='line-number'>199</span>
<span class='line-number'>200</span>
<span class='line-number'>201</span>
<span class='line-number'>202</span>
<span class='line-number'>203</span>
<span class='line-number'>204</span>
<span class='line-number'>205</span>
<span class='line-number'>206</span>
<span class='line-number'>207</span>
<span class='line-number'>208</span>
<span class='line-number'>209</span>
<span class='line-number'>210</span>
<span class='line-number'>211</span>
<span class='line-number'>212</span>
<span class='line-number'>213</span>
<span class='line-number'>214</span>
<span class='line-number'>215</span>
<span class='line-number'>216</span>
<span class='line-number'>217</span>
<span class='line-number'>218</span>
<span class='line-number'>219</span>
<span class='line-number'>220</span>
<span class='line-number'>221</span>
<span class='line-number'>222</span>
<span class='line-number'>223</span>
<span class='line-number'>224</span>
<span class='line-number'>225</span>
<span class='line-number'>226</span>
<span class='line-number'>227</span>
<span class='line-number'>228</span>
<span class='line-number'>229</span>
<span class='line-number'>230</span>
<span class='line-number'>231</span>
<span class='line-number'>232</span>
<span class='line-number'>233</span>
<span class='line-number'>234</span>
<span class='line-number'>235</span>
<span class='line-number'>236</span>
<span class='line-number'>237</span>
<span class='line-number'>238</span>
<span class='line-number'>239</span>
<span class='line-number'>240</span>
<span class='line-number'>241</span>
<span class='line-number'>242</span>
<span class='line-number'>243</span>
<span class='line-number'>244</span>
<span class='line-number'>245</span>
<span class='line-number'>246</span>
<span class='line-number'>247</span>
<span class='line-number'>248</span>
<span class='line-number'>249</span>
<span class='line-number'>250</span>
<span class='line-number'>251</span>
<span class='line-number'>252</span>
<span class='line-number'>253</span>
<span class='line-number'>254</span>
<span class='line-number'>255</span>
<span class='line-number'>256</span>
<span class='line-number'>257</span>
<span class='line-number'>258</span>
<span class='line-number'>259</span>
<span class='line-number'>260</span>
<span class='line-number'>261</span>
<span class='line-number'>262</span>
<span class='line-number'>263</span>
<span class='line-number'>264</span>
<span class='line-number'>265</span>
<span class='line-number'>266</span>
<span class='line-number'>267</span>
<span class='line-number'>268</span>
<span class='line-number'>269</span>
<span class='line-number'>270</span>
<span class='line-number'>271</span>
<span class='line-number'>272</span>
<span class='line-number'>273</span>
<span class='line-number'>274</span>
<span class='line-number'>275</span>
<span class='line-number'>276</span>
<span class='line-number'>277</span>
<span class='line-number'>278</span>
<span class='line-number'>279</span>
<span class='line-number'>280</span>
<span class='line-number'>281</span>
<span class='line-number'>282</span>
<span class='line-number'>283</span>
<span class='line-number'>284</span>
<span class='line-number'>285</span>
<span class='line-number'>286</span>
<span class='line-number'>287</span>
<span class='line-number'>288</span>
<span class='line-number'>289</span>
<span class='line-number'>290</span>
<span class='line-number'>291</span>
<span class='line-number'>292</span>
<span class='line-number'>293</span>
<span class='line-number'>294</span>
<span class='line-number'>295</span>
<span class='line-number'>296</span>
<span class='line-number'>297</span>
<span class='line-number'>298</span>
<span class='line-number'>299</span>
<span class='line-number'>300</span>
<span class='line-number'>301</span>
<span class='line-number'>302</span>
<span class='line-number'>303</span>
<span class='line-number'>304</span>
<span class='line-number'>305</span>
<span class='line-number'>306</span>
<span class='line-number'>307</span>
<span class='line-number'>308</span>
<span class='line-number'>309</span>
<span class='line-number'>310</span>
<span class='line-number'>311</span>
<span class='line-number'>312</span>
<span class='line-number'>313</span>
</pre></td><td class='code'><pre><code class='scheme'><span class='line'><span class="o">#</span><span class="nv">lang</span> <span class="nv">racket</span>
</span><span class='line'><span class="c1">;; The Seasoned Schemer</span>
</span><span class='line'><span class="c1">;; chapter 20</span>
</span><span class='line'><span class="c1">;; What&#39;s in Store ?</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">abort</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">global-table</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">add1</span> <span class="nv">n</span><span class="p">)</span>
</span><span class='line'> <span class="p">(</span><span class="nb">+ </span><span class="nv">n</span> <span class="mi">1</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">sub1</span> <span class="nv">n</span><span class="p">)</span>
</span><span class='line'> <span class="p">(</span><span class="nb">- </span><span class="nv">n</span> <span class="mi">1</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">atom?</span> <span class="nv">a</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">pair? </span><span class="nv">a</span><span class="p">))</span>
</span><span class='line'>      <span class="p">(</span><span class="nb">not </span><span class="p">(</span><span class="nb">null? </span><span class="nv">a</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">text-of</span> <span class="nv">x</span><span class="p">)</span>
</span><span class='line'> <span class="p">(</span><span class="nb">cadr </span><span class="nv">x</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">formals-of</span> <span class="nv">x</span><span class="p">)</span>
</span><span class='line'> <span class="p">(</span><span class="nb">cadr </span><span class="nv">x</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">body-of</span> <span class="nv">x</span><span class="p">)</span>
</span><span class='line'> <span class="p">(</span><span class="nb">cddr </span><span class="nv">x</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">ccbody-of</span> <span class="nv">x</span><span class="p">)</span>
</span><span class='line'> <span class="p">(</span><span class="nb">cddr </span><span class="nv">x</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">name-of</span> <span class="nv">x</span><span class="p">)</span>
</span><span class='line'> <span class="p">(</span><span class="nb">cadr </span><span class="nv">x</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">right-side-of</span> <span class="nv">x</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">null? </span><span class="p">(</span><span class="nb">cddr </span><span class="nv">x</span><span class="p">))</span>
</span><span class='line'>      <span class="mi">0</span>
</span><span class='line'>      <span class="p">(</span><span class="nb">caddr </span><span class="nv">x</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">cond-lines-of</span> <span class="nv">x</span><span class="p">)</span>
</span><span class='line'> <span class="p">(</span><span class="nb">cdr </span><span class="nv">x</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">else?</span> <span class="nv">x</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">atom?</span> <span class="nv">x</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nb">eq? </span><span class="nv">x</span> <span class="ss">&#39;else</span><span class="p">)</span>
</span><span class='line'><span class="no">#f</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">question-of</span> <span class="nv">x</span><span class="p">)</span>
</span><span class='line'> <span class="p">(</span><span class="nb">car </span><span class="nv">x</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">answer-of</span> <span class="nv">x</span><span class="p">)</span>
</span><span class='line'> <span class="p">(</span><span class="nb">cadr </span><span class="nv">x</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">function-of</span> <span class="nv">x</span><span class="p">)</span>
</span><span class='line'> <span class="p">(</span><span class="nb">car </span><span class="nv">x</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">arguments-of</span> <span class="nv">x</span><span class="p">)</span>
</span><span class='line'> <span class="p">(</span><span class="nb">cdr </span><span class="nv">x</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">lookup</span> <span class="nv">table</span> <span class="nv">name</span><span class="p">)</span>
</span><span class='line'> <span class="p">(</span><span class="nf">table</span> <span class="nv">name</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">extend</span> <span class="nv">name1</span> <span class="nv">val</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">name2</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">eq? </span><span class="nv">name1</span> <span class="nv">name2</span><span class="p">)</span>
</span><span class='line'>       <span class="nv">val</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">table</span> <span class="nv">name2</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">define?</span> <span class="nv">e</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="nb">eq? </span><span class="p">(</span><span class="k">and </span><span class="p">(</span><span class="nb">pair? </span><span class="nv">e</span><span class="p">)</span>
</span><span class='line'>           <span class="p">(</span><span class="nb">car </span><span class="nv">e</span><span class="p">))</span> <span class="ss">&#39;def</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">*define</span> <span class="nv">e</span><span class="p">)</span>
</span><span class='line'> <span class="p">(</span><span class="k">set! </span><span class="nv">global-table</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">extend</span> <span class="p">(</span><span class="nf">name-of</span> <span class="nv">e</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">box</span> <span class="p">(</span><span class="nf">the-meaning</span> <span class="p">(</span><span class="nf">right-side-of</span> <span class="nv">e</span><span class="p">)))</span>
</span><span class='line'>   <span class="nv">global-table</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">box</span> <span class="nv">it</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">sel</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">sel</span> <span class="nv">it</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">new</span><span class="p">)</span>
</span><span class='line'>               <span class="p">(</span><span class="k">set! </span><span class="nv">it</span> <span class="nv">new</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">setbox</span> <span class="nv">box</span> <span class="nv">new</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="nf">box</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">it</span> <span class="nv">set</span><span class="p">)</span>
</span><span class='line'>           <span class="p">(</span><span class="nf">set</span> <span class="nv">new</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">unbox</span> <span class="nv">box</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="nf">box</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">it</span> <span class="nv">set</span><span class="p">)</span>
</span><span class='line'>           <span class="nv">it</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">the-meaning</span> <span class="nv">e</span><span class="p">)</span>
</span><span class='line'> <span class="p">(</span><span class="nf">meaning</span> <span class="nv">e</span> <span class="nv">lookup-in-global-table</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">lookup-in-global-table</span> <span class="nv">name</span><span class="p">)</span>
</span><span class='line'> <span class="p">(</span><span class="nf">lookup</span> <span class="nv">global-table</span> <span class="nv">name</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">meaning</span> <span class="nv">e</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'> <span class="p">((</span><span class="nf">expression-to-action</span> <span class="nv">e</span><span class="p">)</span> <span class="nv">e</span> <span class="nv">table</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">*quote</span> <span class="nv">e</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'> <span class="p">(</span><span class="nf">text-of</span> <span class="nv">e</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">*identifier</span> <span class="nv">e</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'> <span class="p">(</span><span class="nf">unbox</span> <span class="p">(</span><span class="nf">lookup</span> <span class="nv">table</span> <span class="nv">e</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">*set</span> <span class="nv">e</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'> <span class="p">(</span><span class="nf">setbox</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">lookup</span> <span class="nv">table</span> <span class="p">(</span><span class="nf">name-of</span> <span class="nv">e</span><span class="p">))</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">meaning</span> <span class="p">(</span><span class="nf">right-side-of</span> <span class="nv">e</span><span class="p">)</span> <span class="nv">table</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">*lambda</span> <span class="nv">e</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">args</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">beglis</span> <span class="p">(</span><span class="nf">body-of</span> <span class="nv">e</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">multi-extend</span> <span class="p">(</span><span class="nf">formals-of</span> <span class="nv">e</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">box-all</span> <span class="nv">args</span><span class="p">)</span>
</span><span class='line'>        <span class="nv">table</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">;; (define (beglis es table)</span>
</span><span class='line'>            <span class="c1">;; (cond</span>
</span><span class='line'>                <span class="c1">;; ((null? (cdr es))</span>
</span><span class='line'>                    <span class="c1">;; (meaning (car es) table))</span>
</span><span class='line'>                <span class="c1">;; (else ((lambda (val)</span>
</span><span class='line'>                            <span class="c1">;; (beglis (cdr es) table))</span>
</span><span class='line'>                        <span class="c1">;; (meaning (car es) table)))))</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">;; (define (beglis es table)</span>
</span><span class='line'>            <span class="c1">;; (let ((m (meaning (car es) table)))</span>
</span><span class='line'>                <span class="c1">;; (if (null? (cdr es))</span>
</span><span class='line'>                    <span class="c1">;; m</span>
</span><span class='line'>                    <span class="c1">;; ((lambda (val)</span>
</span><span class='line'>                            <span class="c1">;; (beglis (cdr es) table)) m))))</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">;; (define (beglis es table)</span>
</span><span class='line'>            <span class="c1">;; (let ((m (meaning (car es) table)))</span>
</span><span class='line'>                <span class="c1">;; (if (null? (cdr es))</span>
</span><span class='line'>                    <span class="c1">;; m</span>
</span><span class='line'>                    <span class="c1">;; (let ((val m))</span>
</span><span class='line'>                        <span class="c1">;; (beglis (cdr es) table)))))</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">beglis</span> <span class="nv">es</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">m</span> <span class="p">(</span><span class="nf">meaning</span> <span class="p">(</span><span class="nb">car </span><span class="nv">es</span><span class="p">)</span> <span class="nv">table</span><span class="p">))</span>
</span><span class='line'>           <span class="p">(</span><span class="nf">d</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">es</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">null? </span><span class="nv">d</span><span class="p">)</span>
</span><span class='line'>       <span class="nv">m</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">beglis</span> <span class="nv">d</span> <span class="nv">table</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">;; (define (box-all vals)</span>
</span><span class='line'>            <span class="c1">;; (if (null? vals)</span>
</span><span class='line'>                <span class="c1">;; &#39;()</span>
</span><span class='line'>                <span class="c1">;; (cons (box (car vals))</span>
</span><span class='line'>                    <span class="c1">;; (box-all (cdr vals)))))</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">;; (define (box-all vals)</span>
</span><span class='line'>            <span class="c1">;; (letrec</span>
</span><span class='line'>                <span class="c1">;; ((rec</span>
</span><span class='line'>                        <span class="c1">;; (lambda (vals acc)</span>
</span><span class='line'>                            <span class="c1">;; (if (null? vals)</span>
</span><span class='line'>                                <span class="c1">;; acc</span>
</span><span class='line'>                                <span class="c1">;; (rec (cdr vals)</span>
</span><span class='line'>                                    <span class="c1">;; (cons (box (car vals)) acc))))))</span>
</span><span class='line'>                <span class="c1">;; (rec (reverse vals) &#39;())))</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">box-all</span> <span class="nv">vals</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="k">let </span><span class="nv">loop</span> <span class="p">((</span><span class="nf">vals</span> <span class="p">(</span><span class="nb">reverse </span><span class="nv">vals</span><span class="p">))</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">acc</span> <span class="o">&#39;</span><span class="p">()))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">null? </span><span class="nv">vals</span><span class="p">)</span>
</span><span class='line'>       <span class="nv">acc</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">loop</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">vals</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">box</span> <span class="p">(</span><span class="nb">car </span><span class="nv">vals</span><span class="p">))</span> <span class="nv">acc</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">multi-extend</span> <span class="nv">names</span> <span class="nv">vals</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">null? </span><span class="nv">names</span><span class="p">)</span>
</span><span class='line'>      <span class="nv">table</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">extend</span> <span class="p">(</span><span class="nb">car </span><span class="nv">names</span><span class="p">)(</span><span class="nb">car </span><span class="nv">vals</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">multi-extend</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">names</span><span class="p">)(</span><span class="nb">cdr </span><span class="nv">vals</span><span class="p">)</span>
</span><span class='line'>        <span class="nv">table</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">*application</span> <span class="nv">e</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>     <span class="p">((</span><span class="nf">meaning</span> <span class="p">(</span><span class="nf">function-of</span> <span class="nv">e</span><span class="p">)</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">evlis</span> <span class="p">(</span><span class="nf">arguments-of</span> <span class="nv">e</span><span class="p">)</span> <span class="nv">table</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">;; (define (evlis args table)</span>
</span><span class='line'>            <span class="c1">;; (if (null? args)</span>
</span><span class='line'>                <span class="c1">;; &#39;()</span>
</span><span class='line'>                <span class="c1">;; ((lambda (val)</span>
</span><span class='line'>                        <span class="c1">;; (cons val</span>
</span><span class='line'>                            <span class="c1">;; (evlis (cdr args) table)))</span>
</span><span class='line'>                    <span class="c1">;; (meaning (car args) table))))</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">;; (define (evlis args table)</span>
</span><span class='line'>            <span class="c1">;; (if (null? args)</span>
</span><span class='line'>                <span class="c1">;; &#39;()</span>
</span><span class='line'>                <span class="c1">;; (cons (meaning (car args) table)</span>
</span><span class='line'>                    <span class="c1">;; (evlis (cdr args) table))))</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">;; (define (evlis args table)</span>
</span><span class='line'>            <span class="c1">;; (letrec</span>
</span><span class='line'>                <span class="c1">;; ((rec</span>
</span><span class='line'>                        <span class="c1">;; (lambda (args table acc)</span>
</span><span class='line'>                            <span class="c1">;; (if (null? args)</span>
</span><span class='line'>                                <span class="c1">;; acc</span>
</span><span class='line'>                                <span class="c1">;; (rec (cdr args)</span>
</span><span class='line'>                                    <span class="c1">;; table</span>
</span><span class='line'>                                    <span class="c1">;; (cons (meaning (car args) table)</span>
</span><span class='line'>                                        <span class="c1">;; acc))))))</span>
</span><span class='line'>                <span class="c1">;; (rec (reverse args) table &#39;())))</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">evlis</span> <span class="nv">args</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="k">let </span><span class="nv">loop</span> <span class="p">((</span><span class="nf">args</span> <span class="p">(</span><span class="nb">reverse </span><span class="nv">args</span><span class="p">))</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">table</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>                <span class="p">(</span><span class="nf">acc</span> <span class="o">&#39;</span><span class="p">()))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nb">null? </span><span class="nv">args</span><span class="p">)</span>
</span><span class='line'>       <span class="nv">acc</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">loop</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">args</span><span class="p">)</span> <span class="nv">table</span>
</span><span class='line'>        <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">meaning</span> <span class="p">(</span><span class="nb">car </span><span class="nv">args</span><span class="p">)</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>         <span class="nv">acc</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">a-prim</span> <span class="nv">p</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">args-in-a-list</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">p</span> <span class="p">(</span><span class="nb">car </span><span class="nv">args-in-a-list</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">b-prim</span> <span class="nv">p</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">args-in-a-list</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">p</span> <span class="p">(</span><span class="nb">car </span><span class="nv">args-in-a-list</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nb">cadr </span><span class="nv">args-in-a-list</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">*const</span> <span class="nv">e</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'> <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>  <span class="p">((</span><span class="nb">number? </span><span class="nv">e</span><span class="p">)</span> <span class="nv">e</span><span class="p">)</span>
</span><span class='line'>  <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="no">#t</span><span class="p">)</span> <span class="no">#t</span><span class="p">)</span>
</span><span class='line'>  <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="no">#f</span><span class="p">)</span> <span class="no">#f</span><span class="p">)</span>
</span><span class='line'>  <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="ss">&#39;cons</span><span class="p">)(</span><span class="nf">b-prim</span> <span class="nv">cons</span><span class="p">))</span>
</span><span class='line'>  <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="ss">&#39;car</span> <span class="p">)(</span><span class="nf">a-prim</span> <span class="nv">car</span><span class="p">))</span>
</span><span class='line'>  <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="ss">&#39;cdr</span><span class="p">)(</span><span class="nf">a-prim</span> <span class="nv">cdr</span><span class="p">))</span>
</span><span class='line'>  <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="ss">&#39;eq?</span><span class="p">)(</span><span class="nf">b-prim</span> <span class="nv">eq?</span><span class="p">))</span>
</span><span class='line'>  <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="ss">&#39;atom?</span><span class="p">)(</span><span class="nf">a-prim</span> <span class="nv">atom?</span><span class="p">))</span>
</span><span class='line'>  <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="ss">&#39;null?</span><span class="p">)(</span><span class="nf">a-prim</span> <span class="nv">null?</span><span class="p">))</span>
</span><span class='line'>  <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="ss">&#39;zero?</span><span class="p">)(</span><span class="nf">a-prim</span> <span class="nv">zero?</span><span class="p">))</span>
</span><span class='line'>  <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="ss">&#39;add1</span><span class="p">)(</span><span class="nf">a-prim</span> <span class="nv">add1</span><span class="p">))</span>
</span><span class='line'>  <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="ss">&#39;sub1</span><span class="p">)(</span><span class="nf">a-prim</span> <span class="nv">sub1</span><span class="p">))</span>
</span><span class='line'>  <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="ss">&#39;number</span><span class="p">)(</span><span class="nf">a-prim</span> <span class="nv">number?</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">*cond</span> <span class="nv">e</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'> <span class="p">(</span><span class="nf">evcon</span> <span class="p">(</span><span class="nf">cond-lines-of</span> <span class="nv">e</span><span class="p">)</span> <span class="nv">table</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">evcon</span> <span class="nv">lines</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'> <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>  <span class="p">((</span><span class="nf">else?</span> <span class="p">(</span><span class="nf">question-of</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lines</span><span class="p">)))</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">meaning</span> <span class="p">(</span><span class="nf">answer-of</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lines</span><span class="p">))</span> <span class="nv">table</span><span class="p">))</span>
</span><span class='line'>  <span class="p">((</span><span class="nf">meaning</span> <span class="p">(</span><span class="nf">question-of</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lines</span><span class="p">))</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">meaning</span> <span class="p">(</span><span class="nf">answer-of</span> <span class="p">(</span><span class="nb">car </span><span class="nv">lines</span><span class="p">))</span> <span class="nv">table</span><span class="p">))</span>
</span><span class='line'>  <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">evcon</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">lines</span><span class="p">)</span> <span class="nv">table</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">*letcc</span> <span class="nv">e</span> <span class="nv">table</span><span class="p">)</span>
</span><span class='line'> <span class="p">(</span><span class="nf">let/cc</span> <span class="nv">skip</span>
</span><span class='line'>  <span class="p">(</span><span class="nf">beglis</span> <span class="p">(</span><span class="nf">ccbody-of</span> <span class="nv">e</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">extend</span> <span class="p">(</span><span class="nf">name-of</span> <span class="nv">e</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">box</span> <span class="p">(</span><span class="nf">a-prim</span> <span class="nv">skip</span><span class="p">)</span> <span class="nv">table</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">value</span> <span class="nv">e</span><span class="p">)</span>
</span><span class='line'> <span class="p">(</span><span class="nf">let/cc</span> <span class="nv">the-end</span>
</span><span class='line'>  <span class="p">(</span><span class="k">set! </span><span class="nv">abort</span> <span class="nv">the-end</span><span class="p">)</span>
</span><span class='line'>  <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">define?</span> <span class="nv">e</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">*define</span> <span class="nv">e</span><span class="p">)</span>
</span><span class='line'>   <span class="p">(</span><span class="nf">the-meaning</span> <span class="nv">e</span><span class="p">))))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">the-empty-table</span> <span class="nv">name</span><span class="p">)</span>
</span><span class='line'> <span class="p">(</span><span class="nf">abort</span>
</span><span class='line'>  <span class="p">(</span><span class="nb">cons </span><span class="ss">&#39;no-answer</span>
</span><span class='line'>   <span class="p">(</span><span class="nb">cons </span><span class="nv">name</span> <span class="o">&#39;</span><span class="p">()))))</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">expression-to-action</span> <span class="nv">e</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">atom?</span> <span class="nv">e</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">atom-to-action</span> <span class="nv">e</span><span class="p">)</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">list-to-action</span> <span class="nv">e</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">atom-to-action</span> <span class="nv">e</span><span class="p">)</span>
</span><span class='line'> <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>  <span class="p">((</span><span class="nb">number? </span><span class="nv">e</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>  <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="no">#t</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>  <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="no">#f</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>  <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="ss">&#39;cons</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>  <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="ss">&#39;car</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>  <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="ss">&#39;cdr</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>  <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="ss">&#39;null?</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>  <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="ss">&#39;eq?</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>  <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="ss">&#39;atom?</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>  <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="ss">&#39;zero?</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>  <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="ss">&#39;add1</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>  <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="ss">&#39;sub1</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>  <span class="p">((</span><span class="nb">eq? </span><span class="nv">e</span> <span class="ss">&#39;number?</span><span class="p">)</span> <span class="nv">*const</span><span class="p">)</span>
</span><span class='line'>  <span class="p">(</span><span class="k">else </span><span class="nv">*identifier</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'>    <span class="p">(</span><span class="k">define </span><span class="p">(</span><span class="nf">list-to-action</span> <span class="nv">e</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">a</span> <span class="p">(</span><span class="nb">car </span><span class="nv">e</span><span class="p">)))</span>
</span><span class='line'>      <span class="p">(</span><span class="k">if </span><span class="p">(</span><span class="nf">atom?</span> <span class="nv">a</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="k">let </span><span class="p">((</span><span class="nf">prim-of?</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nb">eq? </span><span class="nv">x</span> <span class="nv">a</span> <span class="p">))))</span>
</span><span class='line'>        <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>         <span class="p">((</span><span class="nf">prim-of?</span> <span class="ss">&#39;quote</span><span class="p">)</span> <span class="nv">*quote</span><span class="p">)</span>
</span><span class='line'>         <span class="p">((</span><span class="nf">prim-of?</span> <span class="ss">&#39;lambda</span><span class="p">)</span> <span class="nv">*lambda</span><span class="p">)</span>
</span><span class='line'>         <span class="p">((</span><span class="nf">prim-of?</span> <span class="ss">&#39;letcc</span><span class="p">)</span> <span class="nv">*letcc</span><span class="p">)</span>
</span><span class='line'>         <span class="p">((</span><span class="nf">prim-of?</span> <span class="ss">&#39;set!</span><span class="p">)</span> <span class="nv">*set</span><span class="p">)</span>
</span><span class='line'>         <span class="p">((</span><span class="nf">prim-of?</span> <span class="ss">&#39;cond</span><span class="p">)</span> <span class="nv">*cond</span><span class="p">)</span>
</span><span class='line'>         <span class="p">(</span><span class="k">else </span><span class="nv">*application</span><span class="p">)))</span>
</span><span class='line'>       <span class="nv">*application</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="k">set! </span><span class="nv">global-table</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">name</span><span class="p">)</span>
</span><span class='line'>                    <span class="p">(</span><span class="nf">the-empty-table</span> <span class="nv">name</span><span class="p">)))</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">cons </span><span class="ss">&#39;a</span> <span class="ss">&#39;b</span><span class="p">))</span>
</span><span class='line'><span class="p">(</span><span class="nf">value</span> <span class="p">(</span><span class="nb">+ </span><span class="p">(</span><span class="nb">- </span><span class="mi">3</span> <span class="mi">2</span><span class="p">)</span> <span class="mi">6</span><span class="p">))</span>
</span></code></pre></td></tr></table></div></figure>




<h2 id="3">The CPS control struture</h2>


<p>Here below is the method how to change the ordinary subroutine to the continuation passing style <a href="https://cgi.soic.indiana.edu/~c311/lib/exe/fetch.php?media=cps-notes.scm">Ref.</a>.</p>

<ul>
<li>First rule: whenever we see a lambda in the code we want to CPS, we have to add an argument, and then process the body</li>
<li>Second rule: &ldquo;Don&rsquo;t sweat the small stuff!&rdquo;</li>
</ul>


<h3 id="3.1">how to add argument?</h3>


<ul>
<li>orignial style:</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='scheme'><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">rember8</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">ls</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">[(</span><span class="nb">null? </span><span class="nv">ls</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">()]</span>
</span><span class='line'>      <span class="p">[(</span><span class="nb">= </span><span class="p">(</span><span class="nb">car </span><span class="nv">ls</span><span class="p">)</span> <span class="mi">8</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">ls</span><span class="p">)]</span>
</span><span class='line'>      <span class="p">[</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">ls</span><span class="p">)</span> <span class="p">(</span><span class="nf">rember8</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">ls</span><span class="p">)))])))</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li>incompleted cps style:</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='scheme'><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">rember8</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">ls</span> <span class="nv">k</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">[(</span><span class="nb">null? </span><span class="nv">ls</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">()]</span>
</span><span class='line'>      <span class="p">[(</span><span class="nb">= </span><span class="p">(</span><span class="nb">car </span><span class="nv">ls</span><span class="p">)</span> <span class="mi">8</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">ls</span><span class="p">)]</span>
</span><span class='line'>      <span class="p">[</span><span class="k">else </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">ls</span><span class="p">)</span> <span class="p">(</span><span class="nf">rember8</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">ls</span><span class="p">)))])))</span>
</span></code></pre></td></tr></table></div></figure>




<h3 id="3.2">what is the small stuff?</h3>


<p>Small stuff is stuff we know will terminate right away.
Don&rsquo;t sweat the small stuff if we know it will be evaluated.
Don&rsquo;t sweat the small stuff if it <em>might</em> be evaluated, but instead
pass it to k.</p>

<p>为了更好辨别，我们改为如下形式</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='scheme'><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">rember8</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">ls</span> <span class="nv">k</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">[(</span><span class="nb">null? </span><span class="nv">ls</span><span class="p">)</span> <span class="p">(</span><span class="nf">*k*</span> <span class="o">&#39;</span><span class="p">())]</span>
</span><span class='line'>      <span class="p">[(</span><span class="nb">= </span><span class="p">(</span><span class="nb">car </span><span class="nv">ls</span><span class="p">)</span> <span class="mi">8</span><span class="p">)</span> <span class="p">(</span><span class="nf">*k*</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">ls</span><span class="p">))]</span>
</span><span class='line'>      <span class="p">[</span><span class="k">else </span><span class="p">(</span><span class="nf">*rember8*</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">ls</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">*k*</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">ls</span><span class="p">)</span> <span class="nv">x</span><span class="p">))))])))</span>
</span></code></pre></td></tr></table></div></figure>


<p>凡是加上*号的，都代表者continuation的过程。</p>

<pre><code>Why don't null?, =, car, cdr, and cons count? Because they're just
small stuff, and when we combine small stuff together in small ways,
the combination remains small.

Second, all arguments are small stuff. Yep, even the lambda in the
else line, because lambda is *always* small stuff.
</code></pre>

<ul>
<li>complete cps style:</li>
</ul>


<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='scheme'><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">rember8</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">ls</span> <span class="nv">k</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>      <span class="p">[(</span><span class="nb">null? </span><span class="nv">ls</span><span class="p">)</span> <span class="p">(</span><span class="nf">k</span> <span class="o">&#39;</span><span class="p">())]</span>
</span><span class='line'>      <span class="p">[(</span><span class="nb">= </span><span class="p">(</span><span class="nb">car </span><span class="nv">ls</span><span class="p">)</span> <span class="mi">8</span><span class="p">)</span> <span class="p">(</span><span class="nf">k</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">ls</span><span class="p">))]</span>
</span><span class='line'>      <span class="p">[</span><span class="k">else </span><span class="p">(</span><span class="nf">rember8</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">ls</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">k</span> <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">ls</span><span class="p">)</span> <span class="nv">x</span><span class="p">)))])))</span>
</span></code></pre></td></tr></table></div></figure>




<h2 id="4">how to evaluate or interpreter  a procedre?</h2>




<h3 id="4.1">ordinary tracing</h3>


<p>  we will develop a unimplemented language to do give an explanation to it.</p>

<p>  Here below is the main language(we can change it ,but now it is not the main cause.)</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
</pre></td><td class='code'><pre><code class='scheme'><span class='line'><span class="c1">;1 eval</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">eval</span>
</span><span class='line'>   <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">Exp</span> <span class="nv">Env</span> <span class="p">)</span>
</span><span class='line'> <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>    <span class="p">((</span><span class="nb">number? </span><span class="nv">Exp</span><span class="p">)</span>  <span class="nv">Exp</span><span class="p">)</span>
</span><span class='line'>    <span class="p">((</span><span class="nb">symbol? </span><span class="nv">Exp</span><span class="p">)</span> <span class="p">(</span><span class="nf">looking</span> <span class="nv">Exp</span> <span class="nv">Env</span><span class="p">))</span>
</span><span class='line'>    <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">Exp</span><span class="p">)</span> <span class="ss">&#39;QUADE</span><span class="p">)</span> <span class="p">(</span><span class="nb">cadr </span><span class="nv">Exp</span><span class="p">))</span>
</span><span class='line'>    <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">Exp</span><span class="p">)</span> <span class="ss">&#39;lambda</span><span class="p">)</span>
</span><span class='line'>        <span class="p">(</span><span class="nb">list </span><span class="ss">&#39;Closure</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">Exp</span><span class="p">)</span> <span class="nv">Env</span><span class="p">))</span>
</span><span class='line'>    <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">Exp</span><span class="p">)</span> <span class="ss">&#39;Cond</span><span class="p">)</span>
</span><span class='line'>        <span class="err">（</span><span class="nv">Evcond</span> <span class="p">(</span><span class="nb">cadr </span><span class="nv">Exp</span><span class="err">）</span> <span class="nv">Env</span><span class="p">))</span>
</span><span class='line'>    <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>        <span class="p">(</span><span class="nb">apply </span>
</span><span class='line'>           <span class="p">(</span><span class="nb">eval </span><span class="p">(</span><span class="nb">car </span><span class="nv">Exp</span><span class="p">)</span> <span class="nv">Env</span><span class="p">)</span>
</span><span class='line'>           <span class="p">(</span><span class="nf">Evlist</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">Exp</span><span class="p">)</span> <span class="nv">Env</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;2 apply</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">apply</span>
</span><span class='line'>   <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">PROC</span> <span class="nv">ARGS</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>        <span class="p">((</span><span class="nf">primitive?</span> <span class="nv">PROC</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">Apply-primitive</span> <span class="nv">Proc</span> <span class="nv">ARGS</span><span class="p">))</span>
</span><span class='line'>        <span class="p">((</span><span class="nf">EQ?</span> <span class="p">(</span><span class="nb">car </span><span class="nv">proc</span><span class="p">)</span> <span class="ss">&#39;closure</span><span class="p">)</span>
</span><span class='line'>          <span class="p">(</span><span class="nf">EVAL</span>  <span class="p">(</span><span class="nb">cadadr </span><span class="nv">proc</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">Bind</span> <span class="p">(</span><span class="nb">caadr </span><span class="nv">proc</span><span class="p">)</span>
</span><span class='line'>                <span class="nv">ARGS</span>
</span><span class='line'>               <span class="p">(</span><span class="nf">Caddr</span> <span class="nv">proc</span><span class="p">))))</span>
</span><span class='line'>         <span class="p">(</span><span class="k">else </span><span class="nv">error</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;Attention, primitvie?  apply-primitive  is not finished</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;3 Evlist</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">Evlist</span>
</span><span class='line'>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">l</span> <span class="nv">Env</span><span class="p">)</span>
</span><span class='line'>    <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>      <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="o">&#39;</span><span class="p">())</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>      <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>         <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">eval </span><span class="p">(</span><span class="nb">car </span><span class="nv">l</span><span class="p">)</span> <span class="nv">Env</span><span class="p">)</span>
</span><span class='line'>               <span class="p">(</span><span class="nb">eval </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">l</span><span class="p">)</span> <span class="nv">Env</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;4 Evcond</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">Evcond</span>
</span><span class='line'>   <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">clauses</span> <span class="nv">Env</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>        <span class="p">((</span><span class="nb">eq? </span><span class="nv">clauses</span> <span class="o">&#39;</span><span class="p">())</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>        <span class="p">((</span><span class="nb">eq? </span><span class="p">(</span><span class="nb">caar </span><span class="nv">clauses</span><span class="p">)</span> <span class="ss">&#39;else</span><span class="p">)</span>
</span><span class='line'>            <span class="p">(</span><span class="nb">eval </span><span class="p">(</span><span class="nb">cadar </span><span class="nv">clauses</span><span class="p">)</span> <span class="nv">Env</span><span class="p">))</span>
</span><span class='line'>         <span class="p">((</span><span class="nf">false?</span> <span class="p">(</span><span class="nf">Eval</span> <span class="p">(</span><span class="nb">caar </span><span class="nv">clauses</span><span class="p">)</span> <span class="nv">Env</span><span class="p">))</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">Evcond</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">clauses</span><span class="p">)</span> <span class="nv">Env</span><span class="p">))</span>
</span><span class='line'>         <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>            <span class="p">(</span><span class="nf">Eval</span> <span class="p">(</span><span class="nb">cadar </span><span class="nv">clauses</span><span class="p">)</span> <span class="nv">Env</span><span class="p">)))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;;;Attention false? is not finished.</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;5 looking</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">looking</span>
</span><span class='line'>   <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">sym</span> <span class="nv">env</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>       <span class="p">((</span><span class="nb">eq? </span><span class="nv">env</span> <span class="o">&#39;</span><span class="p">())</span> <span class="p">(</span><span class="nf">error</span> <span class="ss">&#39;unbound-value</span><span class="p">))</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">else</span>
</span><span class='line'>         <span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">vcell</span><span class="p">)</span>
</span><span class='line'>             <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>               <span class="p">((</span><span class="nb">eq? </span><span class="nv">vcell</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">looking</span> <span class="nv">sym</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">env</span><span class="p">)))</span>
</span><span class='line'>               <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">cdr </span><span class="nv">vcell</span><span class="p">))))</span>
</span><span class='line'>           <span class="p">(</span><span class="nb">assq </span><span class="nv">sym</span> <span class="p">(</span><span class="nb">car </span><span class="nv">env</span><span class="p">)))))))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;6 assq</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">assq</span>
</span><span class='line'>    <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">syms</span> <span class="nv">alist</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">cond</span>
</span><span class='line'>         <span class="p">((</span><span class="nb">eq? </span><span class="nv">alist</span> <span class="o">&#39;</span><span class="p">())</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>         <span class="p">((</span><span class="nb">eq? </span><span class="nv">syms</span> <span class="p">(</span><span class="nb">caar </span><span class="nv">alist</span><span class="p">))</span> <span class="p">(</span><span class="nb">car </span><span class="nv">alist</span><span class="p">))</span>
</span><span class='line'>         <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nb">assq </span><span class="nv">syms</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">alist</span><span class="p">))))))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1">;7 Bind</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">Bind</span>
</span><span class='line'>   <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">vars</span> <span class="nv">vals</span> <span class="nv">Env</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nf">pair-up</span>  <span class="nv">vars</span> <span class="nv">vals</span><span class="p">)</span> <span class="nv">env</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="c1">;8 Pair-up</span>
</span><span class='line'><span class="p">(</span><span class="k">define </span><span class="nv">Pair-up</span>
</span><span class='line'>   <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">vars</span> <span class="nv">vals</span><span class="p">)</span>
</span><span class='line'>     <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>        <span class="p">((</span><span class="nb">eq? </span><span class="nv">vars</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>            <span class="p">(</span><span class="k">cond </span>
</span><span class='line'>               <span class="p">((</span><span class="nb">eq? </span><span class="nv">vals?</span> <span class="o">&#39;</span><span class="p">())</span> <span class="o">&#39;</span><span class="p">())</span>
</span><span class='line'>               <span class="p">(</span><span class="k">else </span><span class="p">(</span><span class="nf">error</span> <span class="ss">&#39;Too-much-arguments</span><span class="p">))))</span>
</span><span class='line'>         <span class="p">((</span><span class="nb">eq? </span><span class="nv">vals</span> <span class="o">&#39;</span><span class="p">())</span> <span class="p">(</span><span class="nf">error</span> <span class="ss">&#39;Too-few-arguments</span><span class="p">))</span>
</span><span class='line'>         <span class="p">(</span><span class="k">else </span>
</span><span class='line'>           <span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">cons </span><span class="p">(</span><span class="nb">car </span><span class="nv">vars</span><span class="p">)</span>  <span class="p">(</span><span class="nb">car </span><span class="nv">vals</span><span class="p">))</span>
</span><span class='line'>                  <span class="p">(</span><span class="nf">pair-up</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">vars</span><span class="p">)</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">vals</span><span class="p">))))))</span>
</span></code></pre></td></tr></table></div></figure>


<p>So now we can use the language below to interpret the form</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='scheme'><span class='line'><span class="p">(</span><span class="nb">eval </span><span class="o">&#39;</span><span class="p">(((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="err">）（</span><span class="k">lambda </span><span class="p">(</span><span class="nf">y</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)))</span> <span class="mi">3</span><span class="p">)</span> <span class="mi">4</span><span class="p">)</span> <span class="nv">e0</span><span class="p">)</span>
</span></code></pre></td></tr></table></div></figure>


<p>Good explanation begin(kernal part)：</p>

<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class='scheme'><span class='line'><span class="p">(</span><span class="nb">apply </span><span class="p">(</span><span class="nb">eval </span><span class="o">&#39;</span><span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">y</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="nv">y</span><span class="p">))</span><span class="err">）</span> <span class="mi">3</span><span class="err">）</span>  <span class="nv">e0</span><span class="p">)</span>
</span><span class='line'>       <span class="p">(</span><span class="nf">Evlist</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="nv">e0</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nb">apply </span><span class="p">(</span><span class="nb">eval </span><span class="o">&#39;</span><span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">y</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="nv">y</span><span class="p">))</span><span class="err">）</span> <span class="mi">3</span><span class="err">）</span>  <span class="nv">e0</span><span class="p">)</span>
</span><span class='line'>       <span class="err">（</span><span class="nv">cons</span> <span class="p">(</span><span class="nb">eval </span><span class="o">&#39;</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="nv">e0</span><span class="p">)</span> <span class="p">(</span><span class="nf">evlist</span> <span class="o">&#39;</span><span class="p">()</span> <span class="nv">e0</span><span class="p">)))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nb">apply </span><span class="p">(</span><span class="nb">eval </span><span class="o">&#39;</span><span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">y</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="nv">y</span><span class="p">))</span><span class="err">）</span> <span class="mi">3</span><span class="err">）</span>  <span class="nv">e0</span><span class="p">)</span>
</span><span class='line'>       <span class="err">（</span><span class="nv">cons</span> <span class="mi">4</span> <span class="o">&#39;</span><span class="p">()))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nb">apply </span><span class="p">(</span><span class="nb">eval </span><span class="o">&#39;</span><span class="p">((</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">y</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="nv">y</span><span class="p">))</span><span class="err">）</span> <span class="mi">3</span><span class="err">）</span>  <span class="nv">e0</span><span class="p">)</span>
</span><span class='line'>       <span class="o">&#39;</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nb">apply </span><span class="p">(</span><span class="nb">apply </span><span class="p">(</span><span class="nb">eval </span><span class="o">&#39;</span><span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">y</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="nv">y</span><span class="p">))</span>  <span class="nv">e0</span><span class="p">)</span>
</span><span class='line'>       <span class="o">&#39;</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span>
</span><span class='line'>      <span class="o">&#39;</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nb">apply </span><span class="p">(</span><span class="nb">apply </span><span class="o">&#39;</span><span class="p">(</span><span class="nv">closure</span> <span class="p">((</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">lambad</span> <span class="p">(</span><span class="nf">y</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="nv">y</span><span class="p">)))</span> <span class="nv">e0</span><span class="p">)</span>
</span><span class='line'>       <span class="o">&#39;</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span>
</span><span class='line'>      <span class="o">&#39;</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nb">apply </span><span class="p">(</span><span class="nb">eval </span><span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">y</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="nv">y</span><span class="p">))</span> <span class="nv">e1</span><span class="p">)</span>
</span><span class='line'>      <span class="o">&#39;</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nb">apply </span><span class="o">&#39;</span><span class="p">(</span><span class="nv">closure</span> <span class="p">((</span><span class="nf">y</span><span class="p">)</span> <span class="p">(</span><span class="nb">+ </span><span class="nv">x</span> <span class="nv">y</span><span class="p">))</span> <span class="nv">e1</span><span class="p">)</span>
</span><span class='line'>      <span class="o">&#39;</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nb">eval </span><span class="o">&#39;</span><span class="p">(</span><span class="nv">+</span> <span class="nv">x</span> <span class="nv">y</span><span class="p">)</span> <span class="nv">e2</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nb">apply </span><span class="p">(</span><span class="nf">Eval</span> <span class="ss">&#39;+</span> <span class="nv">e2</span><span class="p">)</span>  <span class="p">(</span><span class="nf">Evlist</span> <span class="o">&#39;</span><span class="p">(</span><span class="nv">x</span> <span class="nv">y</span><span class="p">)</span> <span class="nv">e2</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nb">apply </span><span class="o">&#39;</span><span class="p">(</span><span class="nv">add0101</span><span class="p">)</span>  <span class="o">&#39;</span><span class="p">(</span><span class="mi">3</span> <span class="mi">4</span><span class="p">))</span>   <span class="c1">;add0101 is the assemble executable binary code(speed fast)</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="err">（</span><span class="nv">+</span> <span class="mi">3</span> <span class="mi">4</span><span class="err">）</span> <span class="nv">=</span> <span class="mi">7</span>
</span></code></pre></td></tr></table></div></figure>


<p>Finished~  Good ~  Well done.</p>

<h3 id="4.2">cps tracing</h3>




<figure class='code'><figcaption><span></span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='scheme'><span class='line'><span class="nv">Let</span><span class="ss">&#39;s</span> <span class="nv">trace</span> <span class="p">(</span><span class="nf">rember8</span>  <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="nv">x</span><span class="p">))</span>
</span><span class='line'>
</span><span class='line'><span class="nv">ls</span> <span class="nv">|</span> <span class="nv">k</span>
</span><span class='line'>
</span><span class='line'><span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">8</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">5</span><span class="p">)</span> <span class="nv">|</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="nv">x</span><span class="p">)</span> <span class="nv">=</span> <span class="nv">id</span>
</span><span class='line'><span class="o">&#39;</span><span class="p">(</span><span class="mi">2</span> <span class="mi">8</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">5</span><span class="p">)</span>   <span class="nv">|</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">id</span> <span class="p">(</span><span class="nb">cons </span><span class="mi">1</span> <span class="nv">x</span><span class="p">)))</span> <span class="nv">=</span> <span class="nv">k2</span>
</span><span class='line'><span class="o">&#39;</span><span class="p">(</span><span class="mi">8</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">5</span><span class="p">)</span>     <span class="nv">|</span> <span class="p">(</span><span class="k">lambda </span><span class="p">(</span><span class="nf">x</span><span class="p">)</span> <span class="p">(</span><span class="nf">k2</span> <span class="p">(</span><span class="nb">cons </span><span class="mi">2</span> <span class="nv">x</span><span class="p">)))</span> <span class="nv">=</span> <span class="nv">k3</span>
</span><span class='line'>
</span><span class='line'><span class="nv">Once</span> <span class="nv">we</span> <span class="nv">hit</span> <span class="nv">the</span> <span class="mi">8</span><span class="o">,</span> <span class="nv">we</span> <span class="nv">apply</span> <span class="p">(</span><span class="nf">k</span> <span class="p">(</span><span class="nb">cdr </span><span class="nv">ls</span><span class="p">))</span> <span class="nv">where</span> <span class="nv">k</span> <span class="nv">is</span> <span class="nv">k3</span> <span class="k">and </span><span class="nv">ls</span> <span class="nv">is</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">8</span> <span class="mi">3</span>
</span><span class='line'><span class="mi">4</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">5</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="p">(</span><span class="nf">k3</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">3</span> <span class="mi">4</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">5</span><span class="p">))</span> <span class="nv">=</span> <span class="p">(</span><span class="nf">k2</span> <span class="p">(</span><span class="nb">cons </span><span class="mi">2</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">3</span> <span class="mi">4</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">5</span><span class="p">)))</span>
</span><span class='line'><span class="p">(</span><span class="nf">k2</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">5</span><span class="p">))</span> <span class="nv">=</span> <span class="p">(</span><span class="nf">id</span> <span class="p">(</span><span class="nb">cons </span><span class="mi">1</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">5</span><span class="p">)))</span>
</span><span class='line'><span class="p">(</span><span class="nf">id</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">5</span><span class="p">))</span> <span class="nv">=</span> <span class="o">&#39;</span><span class="p">(</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">5</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="nv">And</span> <span class="nv">we</span><span class="ss">&#39;re</span> <span class="nv">done</span><span class="o">.</span>
</span></code></pre></td></tr></table></div></figure>




<h2 id="5"> It is not the end</h2>


<p>how to change the procedure above? Leave to you.</p>

<p class='post-footer'>
                        原始地址:<a href='http://jueqingsizhe66.github.io/blog/2016/02/09/its-a-dead-program-dot-how-to-let-it-alive/'>http://jueqingsizhe66.github.io/blog/2016/02/09/its-a-dead-program-dot-how-to-let-it-alive/</a><br/>&nbsp;written by <a href='http://jueqingsizhe66.github.io'>Ye Zhaoliang</a>&nbsp;posted at <a href='http://jueqingsizhe66.github.io'>http://jueqingsizhe66.github.io</a></p>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Ye Zhaoliang</span></span>

      








  


<time datetime="2016-02-09T23:20:18+08:00" pubdate data-updated="true">Feb 9<span>th</span>, 2016</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/scheme/'>scheme</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2015/11/01/think-in-the-variable-and-macro-in-the-common-lisp/" title="Previous Post: Think in the variable and macro in the common lisp">&laquo; Think in the variable and macro in the common lisp</a>
      
      
        <a class="basic-alignment right" href="/blog/2016/02/13/different-data-types-decide-the-different-operations/" title="Next Post: Different data types decide the different operations">Different data types decide the different operations &raquo;</a>
      
    </p>
  </footer>
</article>



  <section>
    <h1>Comments</h1>
    <div id="comments" aria-live="polite"><div class="ds-thread" > </div>
<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
var duoshuoQuery = {short_name:"f708708"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		 || document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
<!-- 多说公共JS代码 end -->
</div>
  </section>


</div>

<aside class="sidebar">
  
    <section>
  <article role="article">  <!--不是他的原因-->
    <p>
      <!--<img class="alignleft" src="/images/xinran.jpg" style="Float:left;MARGIN-BOTTOM: 10px;MARGIN-RIGHT: 40px" weight="100" height="140" border="0" /> -->
      <img class="alignleft" src="/images/lvxing/gulangyu.jpg" style="Float:left;MARGIN-BOTTOM: 10px;MARGIN-RIGHT: 10px" weight="100" height="140" border="0" /> 
 <!--而是yellow的原因-->
<!--不是他的原因-->
 </br> 
    <h4> 叶昭良(Zhaoliang Ye) believe& 肖欣然(Xinran Xiao)</h4>
    <h5> Our Life </h5>
<hr style="color:#990000;border:1px dotted">
    QQ: <a href="977962857@qq.com">977962857@qq.com</a>
        <a href="36559660@qq.com">36559660@qq.com</a>

    </br>
    Weibo: <a href="zhaoturkkey@sina.com">zhaoturkkey@sina.com</a>

    <h5>Our Work</h5>

<hr style="color:#990000;border:1px dotted">
  <p>fortran程序员,Java程序员,HR,CFD</p>

<h5>Some books and links</h5>
<hr style="color:#990000;border:1px dotted">

<p>Scheme:</br>
  <a href="http://www.ccs.neu.edu/home/matthias/BTLS/"><font color="red">《the little scheme》(TLS)</font></a></br>
    <a href=" http://www.ccs.neu.edu/home/matthias/BTSS/">《The Season Scheme》(TSS)</a> </br>
    <a href="http://www.realmofracket.com/ ">《 Realm of Racket》</a> </br>
  <a href="http://scheme.com/tspl4/">《The Scheme Programming Language》(TSPL) </a> </br> 
  <a href=" http://mitpress.mit.edu/sicp/full-text/book/book-Z-H-4.html#%_toc_start">《Structure and Interpretation of Computer Programs》(SICP)</a></br>
  <a href="http://community.schemewiki.org/?SICP-Solutions ">SICP Solution</a></br>
  <a href="https://github.com/DeathKing/Learning-SICP">Learning SICP</a></br>
  <a href="http://www.eopl3.com/ "><font color="red">《Essentials of Programming Language》(EOPL)</font></a></br>
  <a href="http://academic.udayton.edu/SaverioPerugini/courses/cps343/lecture_notes/ ">EOPL Course</a></br>

  <a href="http://www.ccs.neu.edu/home/matthias/HtDP2e/">How to Design programs(程序设计方法 SICP的简化版)</a></br>
  <a href="http://www.cs.berkeley.edu/~bh/ss-toc2.html"> Simply Scheme(中学级别)</a></br>
  <a href="http://songjinghe.github.io/TYS-zh-translation/"> Scheme语言简明教程(汉)</a></br>
  <a href="http://ds26gte.github.io/tyscheme/index.html"> Teach yourself Scheme in fixed days</a></br>
  <a href="http://vdisk.weibo.com/s/uutnsRMnFAbDA ">Scheme in programming(不错的入门书籍)</a></br>


</p>
<p> Lisp: </br>
  <a href=" http://www.landoflisp.com/">《Land of Lisp》</a></br>
  <a href="http://www.lisperati.com/casting.html">[Casting_spels] </a></br>
  <a href=" http://www.gigamonkeys.com/book/"> 《Practical CommonLisp》</a></br>
  <a href="http://www.paulgraham.com/acl.html">《ANSI_Common_lisp》 </a> </br>
  <a href="http://www.norvig.com/paip.html"> 《Paradigms of Artificial Intelligence Programming(PAIP)》</a></br>

</p>
<p> Clojure: </br>
  <a href="http://buhoz.net/public/books/lenguajes/clojure/Practical.Clojure.pdf">《Prcatical_clojure》</a></br>
  <a href=" http://www.joyofclojure.com/">《The joy of Clojure》</a>
  <a href="http://www.clojurebook.com/">《programming Clojure》 </a> </br>
  <a href="http://blog.csdn.net/zh2qiang/article/category/928066"> Programming clojure学习笔记 </a></br>
  <a href="http://xumingming.sinaapp.com/302/">Clojure入门教程: Clojure – Functional Programming for the JVM </a> </br>
  <a href="http://www.oschina.net/translate/the-clojure-philosophy?cmp">Clojure 哲学</a></br> 

</p></br>
<p> Haskell:</br>
  <a href="http://fleurer-lee.com/lyah/introduction.htm#%E5%85%B3%E4%BA%8E%E8%BF%99%E4%B8%AA%E6%95%99%E7%A8%8B ">Haskell趣味指南</a></br>
  <a href="https://www.haskell.org/">Hashell:An advanced purely-functional programming language </a></br>
  <a href="http://www.cs.nott.ac.uk/~gmh/book.html "> Programming in Haskell</a></br>
  <a href=" http://www.scs.stanford.edu/11au-cs240h/">Hashell Mit Course</a></br>

<p> Fortran:</br>
  <a href="http://www.personal.psu.edu/jhm/f90/lectures/quickref.html"> fortran90</a></br>
  <a href="http://people.sc.fsu.edu/~jburkardt/">John Burkardt</a> </br>
  <a href=" http://jblevins.org/mirror/amiller/#pzeros">Alan-Miller</a></br>
  <a href="http://micro.ustc.edu.cn/Fortran/">Fortran收集 </a></br>
  <a href="http://pan.baidu.com/s/1gdCN1T5"><font color="red">工程数值方法</font></a></br>
  <a href=" https://github.com/jueqingsizhe66/gtk-fortran">fortran-gtk</a></br>
  <a href="http://203.195.149.196/ldt9v/ebook/Modern_Fortran_Explained.pdf "> 《Modern Fortran Explained》(高级)</a></br>
  <a href="http://203.195.149.196/ldt9v/ebook/Fortran95_2003_Science_Project_SongYeZhi.zip ">《Fortran95~2003数值计算》(宋叶志)</a></br>
 
   
</p>

<p> Java:</br>
  <a href="http://a-little-java-a-few-patterns.readthedocs.org/zh_CN/latest/index.html"> A little Java (visitor pattern)</a></br>
  <a href="http://www.mkyong.com/"> Mkyong-java8</a></br>
  <a href="http://howtodoinjava.com/ "> how-to-do-in-java</a></br>
  <a href="http://stackoverflow.com/ "> StackOverflow问题堆栈 </a></br>
  <a href="http://www.blogjava.net/ ">BlogJava</a></br>
  <a href="http://www.importnew.com/ "> Java 新闻</a></br>
  <a href="http://ifeve.com/category/java/ "> 并发编程网</a></br>
  <a href="http://www.iteye.com/blogs ">IT 视角 </a></br>
  <a href="http://www.iteye.com/forums/tag_good/Java%E7%BB%BC%E5%90%88 ">IT 视角之java综合(SSH) </a></br>
  <a href="http://rednaxelafx.iteye.com/category/22617 ">IT 视角之rednaxelafx </a></br>
  <a href="http://droidyue.com/ ">技术小黑屋 </a></br>
  <a href="https://mouxuejie.com/ "> 某学姐 </a></br>
  <a href="http://gudong.name/ "> 咕咚-handler  </a></br>
  <a href="http://www.superqq.com/ "> ios-自媒体  </a></br>
  <a href="http://blog.csdn.net/jackfrued/ "><font color="red"> CSDN-骆昊的技术专栏</font> </a></br>
  <a href="http://www.adrop.me/cat/tech/java/ "> Adrop 自留地</a></br>
  <a href="http://www.programcreek.com/ "> Programcreek</a></br>
  <a href="http://java-performance.info/ "> Java-Performance(JP)</a></br>
  <a href="http://www.ibm.com/developerworks/cn/java/ "> IBM Java开发者社区</a></br>
  <a href="http://shipilev.net/ "> Aleksey Shipilëv: One Stop Page </a></br>
  <a href="http://www.pandablog.cn/?cat=9 "> 熊猫大仙</a></br>
  <a href="http://www.pixelstech.net/article.php?type=all "> pixelstech</a></br>
  <a href="http://timyang.net/ "> 后端技术-java</a></br>
  <a href="http://www.adam-bien.com/roller/abien/ "> abian德国Javaee</a></br>
  <a href="https://javax0.wordpress.com/ "> Java纯粹(匈牙利) </a></br>
  <a href="https://antoniogoncalves.org/ ">JAVAEE协议作者 (法国)-图文并茂 </a></br>
  <a href="http://www.importnew.com/7469.html "> 100个小链接 </a></br>

</p>

<p> Java github repos: </br>
  <a href="https://github.com/akullpp/awesome-java "> awesome-java一些常用的库链接</a></br>
  <a href="https://github.com/codefollower/My-Blog ">  codefollowers</a></br>
  </p>

<p> JAVA API: </br>
   <a href="https://docs.oracle.com/javaee/7/api/  "> JAVAEE 7 API</a></br>
  <a href="https://docs.oracle.com/javase/8/docs/api/index.html  ">  JAVASE 8 API</a></br>
  <a href="https://struts.apache.org/maven/struts2-core/apidocs/index.html "> <font color="red">Struts2core 2.5</font> </a></br>
  <a href="http://docs.jboss.org/hibernate/search/5.6/api/ "> <font color="red">Hibernate5.6 </font></a></br>
  <a href="http://spring.io/docs/reference "><font color="red">Spring系列文档</font> </a></br>
  <a href="http://docs.spring.io/spring/docs/4.3.0.RC1/javadoc-api/ "><font color="red">Spring Framework</font> </a></br>

</p>

<p> Bash:</br>
  <a href="http://vbird.dic.ksu.edu.tw/linux_basic/0320bash.php ">鸟哥的私房菜</a></br>
  <a href=" http://www.thegeekstuff.com/bash-101-hacks-ebook/">Bash 101 Hacks</a></br>
</p>

<p> Perl:</br>
  <a href="http://bbs.pinggu.org/thread-4890642-1-1.html">Learning Perl(7th) 2016 入门 </a></br>
  <a href="https://zhidao.baidu.com/share/2e40aed238e8a3f0fdb8d8148aa88565.html">The Immediate Perl(2th) 2006 中级 </a></br>
  <a href="http://www.jb51.net/books/24569.html"> Mastering Perl 高级</a></br>
  <a href="http://download.csdn.net/detail/blkf/4131770">Perl Programming (4th) (Larry Wall) </a></br>
  <a href="http://www.tutorialspoint.com/perl/perl_oo_perl.htm ">Perl Object Orient Programming(perl oop) </a></br>
  <a href="http://vdisk.weibo.com/s/zcetMufbD44U0">Perl Best Practice(Domian Conway) 2006 终极</a></br>
  <a href="http://wwwacs.gantep.edu.tr/docs/perl-ebook/ch19.htm">Perl Object Orient Programming(by Kamran Husain) </a></br>
  <a href="http://www.ibm.com/developerworks/cn/linux/sdk/perl/perl-1/index.html ">一篇写得不错的perl intro</a></br>
  <a href="http://dbi.perl.org/docs/">Perl DBI </a></br> 
  <a href="http://www.tutorialspoint.com/perl/perl_database.htm">Perl DataBase Management </a></br>
  <a href="http://www.tutorialspoint.com/perl/perl_cgi.htm ">Perl CGI script </a></br>
  <a href="http://www.tutorialspoint.com/perl/perl_modules.htm">Writing Perl Module</a></br>
</p>


  <p>English: </br>
    <a href="http://book.douban.com/subject/1014914/"> 《英语魔法俱乐部》</a>一本相当不错的英语语法书。
    <a href="http://vdisk.weibo.com/search/?type=public&keyword=%E9%A3%8E%E6%A0%BC%E7%9A%84%E8%A6%81%E7%B4%A0">风格的要素(Element of Style)</a> 英语写作的圣经</br>
    <a href="http://www.geraldmweinberg.com/Site/On_Writing.html">WeinBerg On Writing:The fieldstone method </a> 收集WeinBerg Stones</br>
 
  </p>
  <p> 流体力学：</br>
  <a href="http://vdisk.weibo.com/s/uuCAVsYacltnf">计算流体力学入门(安德森)</a></br>
  <a href="http://vdisk.weibo.com/search/?type=public&keyword=%E7%A9%BA%E6%B0%94%E5%8A%A8%E5%8A%9B%E5%AD%A6%E5%9F%BA%E7%A1%80"><font color="red">空气动力学基础(安德森)</font> </a></br>
  <a href="http://vdisk.weibo.com/s/dgA_ls6t1ywY5 ">计算流体力学与传热学(陶文铨)</a></br>
  <a href="http://dyfluid.com/ ">东岳流体</a></br>
  <a href="http://blog.sina.com.cn/openfoamresearch "> 苏军伟-sina</a></br>


  </p>

  <p> 数学:</br>
    <a href="http://ocw.mit.edu/faculty/gilbert-strang/">Gilbert Strang Professor 微积分，线性代数，微分方程</a> </br> 
    <a href="http://math.mit.edu/~rbm/ "> Richard Melrose 泛函分析</a></br> 
    <a href="http://homepage.ntlworld.com/ivan.wilde/notes/ ">Dr Ivan F Wilde 复分析</a></br>
  </p>
  <p> Machine Learning:(降维和优化) Support Vector Machine</br>
    <a href="http://blog.csdn.net/v_july_v/article/details/7624837"><font color="red">July SVM三层境界</font></a> </br> 
    <a href="http://vdisk.weibo.com/u/1580904460 ">July Vdisk</a> </br> 
    <a href="http://www.blogjava.net/zhenandaci/archive/2009/03/15/259786.html "> Jason Java Jacal</a></br> 
    <a href="http://www.csie.ntu.edu.tw/~cjlin/libsvm/ ">LibSvm: </a></br>
    <a href="http://www.svms.org/vc-dimension/ ">Vc-dimension</a></br>
    <a href="http://www.autonlab.org/tutorials/svm15.pdf ">内基梅隆大学carnegie mellon university(CMU) Svm Tutorials</a></br>
    <a href="http://120.52.72.51/www.cmlab.csie.ntu.edu.tw/c3pr90ntcsf0/~cyy/learning/tutorials/SVR.pdf ">SVR :回归分析</a></br>

    <a href="http://blog.csdn.net/zhzhl202/article/details/8197109 ">文本分类和SVM</a></br>
    <a href="http://www.cnblogs.com/jerrylead/tag/Machine%20Learning/ ">斯坦福机器课程学习笔记</a></br>
    <a href="http://www.cnblogs.com/jerrylead/archive/2012/05/08/2489725.html ">斯坦福大学的原始讲义</a></br>
    <a href="http://www.mit.edu/~9.520/spring11/slides/class06-svm.pdf ">MIT SVM讲义</a></br>
    <a href="http://icml2008.cs.helsinki.fi/papers/266.pdf ">SVM优化</a></br>
    <a href="http://blog.csdn.net/qll125596718/article/details/8248249 ">最小二乘法及其实现</a></br>
    <a href="http://vdisk.weibo.com/s/s-XOVNRQc_reY ">《数理统计学简史》陈希孺院士著  </a></br>
    <a href="http://vdisk.weibo.com/s/BZndAHHdASslv ">《最优化理论与算法》(第2版)－陈宝林 </a></br>
    <a href="http://www.52nlp.cn/tag/%E6%AD%A3%E6%80%81%E5%88%86%E5%B8%83%E7%9A%84%E5%89%8D%E4%B8%96%E4%BB%8A%E7%94%9F ">正态分布的前世今生</a></br>

  </p>
  <p>Climing and Take a tourist</p>
    <h5>Contact Us</h5>
<hr style="color:#990000;border:1px dotted">
    Email:<a href="zhaoturkkey@163.com">zhaoturkkey@163.com</a></br>
         <a href="36559660@qq.com">36559660@qq.com</a>

  </article>
  <p><img src="/images/wood.jpg"  alt="zhaoturkkey@gmail.com" /></p></section>
</section>

<section>
  <h1>分类目录</h1>
  <ul id="categories">
    <li class='category'><a href='/blog/categories/fast/'>Fast (4)</a></li>
<li class='category'><a href='/blog/categories/html/'>HTML (1)</a></li>
<li class='category'><a href='/blog/categories/haskell/'>Haskell (21)</a></li>
<li class='category'><a href='/blog/categories/jsdom/'>JSDom (3)</a></li>
<li class='category'><a href='/blog/categories/javabasic/'>JavaBasic (23)</a></li>
<li class='category'><a href='/blog/categories/javascript/'>JavaScript (3)</a></li>
<li class='category'><a href='/blog/categories/linux/'>Linux (20)</a></li>
<li class='category'><a href='/blog/categories/lisp/'>Lisp (1)</a></li>
<li class='category'><a href='/blog/categories/mysql/'>Mysql (2)</a></li>
<li class='category'><a href='/blog/categories/tecplot/'>Tecplot (1)</a></li>
<li class='category'><a href='/blog/categories/error/'>error (1)</a></li>
<li class='category'><a href='/blog/categories/fortran/'>fortran (5)</a></li>
<li class='category'><a href='/blog/categories/git/'>git (3)</a></li>
<li class='category'><a href='/blog/categories/gnuplot/'>gnuplot (1)</a></li>
<li class='category'><a href='/blog/categories/graphviz/'>graphviz (1)</a></li>
<li class='category'><a href='/blog/categories/humor/'>humor (1)</a></li>
<li class='category'><a href='/blog/categories/incompact3d/'>incompact3d (4)</a></li>
<li class='category'><a href='/blog/categories/jquery/'>jQuery (2)</a></li>
<li class='category'><a href='/blog/categories/life/'>life (19)</a></li>
<li class='category'><a href='/blog/categories/makefile/'>makefile (2)</a></li>
<li class='category'><a href='/blog/categories/markdown/'>markdown (4)</a></li>
<li class='category'><a href='/blog/categories/matlab/'>matlab (2)</a></li>
<li class='category'><a href='/blog/categories/openfoam/'>openfoam (1)</a></li>
<li class='category'><a href='/blog/categories/perl/'>perl (3)</a></li>
<li class='category'><a href='/blog/categories/physics/'>physics (1)</a></li>
<li class='category'><a href='/blog/categories/prolog/'>prolog (4)</a></li>
<li class='category'><a href='/blog/categories/python/'>python (1)</a></li>
<li class='category'><a href='/blog/categories/scheme/'>scheme (35)</a></li>
<li class='category'><a href='/blog/categories/vim/'>vim (2)</a></li>
<li class='category'><a href='/blog/categories/xml/'>xml (1)</a></li>

  </ul>
</section>
<section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2017/02/10/javakai-fa-nexussi-fu-da-jian/">Java开发nexus私服搭建</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/02/08/fortrandu-qu-csvwen-jian/">Fortran读取csv文件</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/02/08/perldu-qu-mysqlshu-ju-ku/">Perl读取mysql数据库</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/02/08/perlzhong-wen-luan-ma-wen-ti/">Perl中文乱码问题</a>
      </li>
    
      <li class="post">
        <a href="/blog/2017/02/07/%5B%3F%5D-fen-you-qu-de-fortrandong-tai-jing-tai-lian-jie-wen/">一份有趣的fortran动态静态链接文</a>
      </li>
    
  </ul>
</section>

<section>
  <h1>GitHub Repos</h1>
  <ul id="gh_repos">
    <li class="loading">Status updating...</li>
  </ul>
  
  <a href="https://github.com/jueqingsizhe66">@jueqingsizhe66</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'jueqingsizhe66',
            count: 2,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>



<section class="googleplus googleplus-hidden">
  <h1>
    <a href="https://plus.google.com/zhaoturkkey@gmail.com?rel=author">
      <img src="http://www.google.com/images/icons/ui/gprofile_button-32.png" width="32" height="32">
      Google+
    </a>
  </h1>
</section>


<section>
<h1>Zhao's Douban</h1>
<div>
 <script type="text/javascript" src="http://www.douban.com/service/badge/50717256/?selection=latest&amp;picsize=small&amp;hideself=on&amp;show=collection&amp;n=8&amp;cat=drama%7Cmovie%7Cbook%7Cmusic&amp;columns=2"></script>
</div>
</section>
<section>
<h1>Recent Comments</h1>
<ul class="ds-recent-comments" data-num-items="10" data-show-avatars="0" data-show-time="1" data-show-title="0" data-show-admin="0" data-excerpt-length="18"></ul>

</section>
<section>
  <h1>盟友</h1>
  <ul>
    <li><a href="http://www.cfd-online.com/">CFD1</a></li>
    <li><a href="http://www.sci-hub.cc">sci文章破解下载</a></li>
    <li><a href="https://nwtc.nrel.gov/">NREL-NWTC </a></li>
    <li>
      <a href="http://mindhacks.cn/">刘未鹏MIND HACKS</a>
    </li>
    <li>
      <a href="http://www.cnblogs.com/Solstice/">陈硕</a>
    </li>
    <li>
      <a href="http://tianchunbinghe.blog.163.com/">冰河-网易</a></br>
      <a href="http://weibo.com/tianchunbinghe?from=myfollow_all&is_all=1#_rnd1455615502647">冰河-新浪</a>
    </li>
    <li>
      <a href="http://yinwang.org/">王垠</a></br>
      <a href="http://www.jianshu.com/users/b1dd2b2c87a8/latest_articles">王垠-简书</a>
    </li>
    <li>
      <a href="http://www.huzheng.org/ ">胡正</a>
      </li>
    <li>
      <a href="http://xahlee.org/ ">李杀</a>
      </li>
    <li>
      <a href="http://www.is.pku.edu.cn/~qzy/ "> 裘宗燕</a>
      </li>
    <li>
      <a href=" http://blog.csdn.net/v_july_v"> July</a>
      </li>
    <li>
      <a href="http://deathking.github.io/ "> deathKing: Learning-in-SICP</a>
      </li>



    <li>
      <a href=" https://en.wikipedia.org/wiki/Scheme_%28programming_language%29"> scheme wikipedia(history of scheme)</a>
    </li>
    <li>
      <a href="https://inst.eecs.berkeley.edu/~cs61a/fa14/proj/scheme/ ">CS61a:a scheme interpreter </a>
      <a href="https://github.com/dhrushilbadani/Scheme "> interpreter with python implementation </a>
    </li>
    <li>
      <a href="https://cgi.soic.indiana.edu/~c311/doku.php "> C311/B521/B621 </a>
    </li>
    <li>
      <a href="http://minikanren.org/ "> MiniKanren</a>
    </li>
    <li>
      <a href=" http://lambda-the-ultimate.org/"> Lambda the ultimate</a>
    </li>
    <li>
      <a href="http://people.csail.mit.edu/jaffer/SLIB "> The SLIB Portable Scheme library</a>
    </li>

    <li>
      <a href="http://v.qq.com/cover/p/pd51cjco90d1rc1.html?vid=o0015dvd155 "> 北平无战事43:承受</a>
    </li>


  </ul>
</section>
<section>
<h1>My website link<abbr title="The word 'QR Code' is a registered trademark of DENSO WAVE INCORPORATED. It applies only for the word 'QR Code', not for image.">&trade;</abbr></h1>
<a href="http://jueqingsizhe66.github.io/blog/2016/02/09/its-a-dead-program-dot-how-to-let-it-alive/"><img src="http://chart.apis.google.com/chart?chs=150x150&cht=qr&chld=|0&chco=165B94&chl=http://jueqingsizhe66.github.io/blog/2016/02/09/its-a-dead-program-dot-how-to-let-it-alive/" alt="post-qrcode"></a></section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2017 - Ye Zhaoliang -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  





  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>







</body>
</html>
